{"ast":null,"code":"/*!\n * FilePond 4.13.6\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = global || self, factory(global.FilePond = {}));\n})(this, function (exports) {\n  'use strict';\n\n  var isNode = function isNode(value) {\n    return value instanceof HTMLElement;\n  };\n\n  var createStore = function createStore(initialState) {\n    var queries = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var actions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : []; // internal state\n\n    var state = Object.assign({}, initialState); // contains all actions for next frame, is clear when actions are requested\n\n    var actionQueue = [];\n    var dispatchQueue = []; // returns a duplicate of the current state\n\n    var getState = function getState() {\n      return Object.assign({}, state);\n    }; // returns a duplicate of the actions array and clears the actions array\n\n\n    var processActionQueue = function processActionQueue() {\n      // create copy of actions queue\n      var queue = [].concat(actionQueue); // clear actions queue (we don't want no double actions)\n\n      actionQueue.length = 0;\n      return queue;\n    }; // processes actions that might block the main UI thread\n\n\n    var processDispatchQueue = function processDispatchQueue() {\n      // create copy of actions queue\n      var queue = [].concat(dispatchQueue); // clear actions queue (we don't want no double actions)\n\n      dispatchQueue.length = 0; // now dispatch these actions\n\n      queue.forEach(function (_ref) {\n        var type = _ref.type,\n            data = _ref.data;\n        dispatch(type, data);\n      });\n    }; // adds a new action, calls its handler and\n\n\n    var dispatch = function dispatch(type, data, isBlocking) {\n      // is blocking action (should never block if document is hidden)\n      if (isBlocking && !document.hidden) {\n        dispatchQueue.push({\n          type: type,\n          data: data\n        });\n        return;\n      } // if this action has a handler, handle the action\n\n\n      if (actionHandlers[type]) {\n        actionHandlers[type](data);\n      } // now add action\n\n\n      actionQueue.push({\n        type: type,\n        data: data\n      });\n    };\n\n    var query = function query(str) {\n      var _queryHandles;\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return queryHandles[str] ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args) : null;\n    };\n\n    var api = {\n      getState: getState,\n      processActionQueue: processActionQueue,\n      processDispatchQueue: processDispatchQueue,\n      dispatch: dispatch,\n      query: query\n    };\n    var queryHandles = {};\n    queries.forEach(function (query) {\n      queryHandles = Object.assign({}, query(state), {}, queryHandles);\n    });\n    var actionHandlers = {};\n    actions.forEach(function (action) {\n      actionHandlers = Object.assign({}, action(dispatch, query, state), {}, actionHandlers);\n    });\n    return api;\n  };\n\n  var defineProperty = function defineProperty(obj, property, definition) {\n    if (typeof definition === 'function') {\n      obj[property] = definition;\n      return;\n    }\n\n    Object.defineProperty(obj, property, Object.assign({}, definition));\n  };\n\n  var forin = function forin(obj, cb) {\n    for (var key in obj) {\n      if (!obj.hasOwnProperty(key)) {\n        continue;\n      }\n\n      cb(key, obj[key]);\n    }\n  };\n\n  var createObject = function createObject(definition) {\n    var obj = {};\n    forin(definition, function (property) {\n      defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n  };\n\n  var attr = function attr(node, name) {\n    var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n    if (value === null) {\n      return node.getAttribute(name) || node.hasAttribute(name);\n    }\n\n    node.setAttribute(name, value);\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svgElements = ['svg', 'path']; // only svg elements used\n\n  var isSVGElement = function isSVGElement(tag) {\n    return svgElements.includes(tag);\n  };\n\n  var createElement = function createElement(tag, className) {\n    var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (typeof className === 'object') {\n      attributes = className;\n      className = null;\n    }\n\n    var element = isSVGElement(tag) ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n    if (className) {\n      if (isSVGElement(tag)) {\n        attr(element, 'class', className);\n      } else {\n        element.className = className;\n      }\n    }\n\n    forin(attributes, function (name, value) {\n      attr(element, name, value);\n    });\n    return element;\n  };\n\n  var appendChild = function appendChild(parent) {\n    return function (child, index) {\n      if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n      } else {\n        parent.appendChild(child);\n      }\n    };\n  };\n\n  var appendChildView = function appendChildView(parent, childViews) {\n    return function (view, index) {\n      if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n      } else {\n        childViews.push(view);\n      }\n\n      return view;\n    };\n  };\n\n  var removeChildView = function removeChildView(parent, childViews) {\n    return function (view) {\n      // remove from child views\n      childViews.splice(childViews.indexOf(view), 1); // remove the element\n\n      if (view.element.parentNode) {\n        parent.removeChild(view.element);\n      }\n\n      return view;\n    };\n  };\n\n  var IS_BROWSER = function () {\n    return typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  }();\n\n  var isBrowser = function isBrowser() {\n    return IS_BROWSER;\n  };\n\n  var testElement = isBrowser() ? createElement('svg') : {};\n  var getChildCount = 'children' in testElement ? function (el) {\n    return el.children.length;\n  } : function (el) {\n    return el.childNodes.length;\n  };\n\n  var getViewRect = function getViewRect(elementRect, childViews, offset, scale) {\n    var left = offset[0] || elementRect.left;\n    var top = offset[1] || elementRect.top;\n    var right = left + elementRect.width;\n    var bottom = top + elementRect.height * (scale[1] || 1);\n    var rect = {\n      // the rectangle of the element itself\n      element: Object.assign({}, elementRect),\n      // the rectangle of the element expanded to contain its children, does not include any margins\n      inner: {\n        left: elementRect.left,\n        top: elementRect.top,\n        right: elementRect.right,\n        bottom: elementRect.bottom\n      },\n      // the rectangle of the element expanded to contain its children including own margin and child margins\n      // margins will be added after we've recalculated the size\n      outer: {\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      }\n    }; // expand rect to fit all child rectangles\n\n    childViews.filter(function (childView) {\n      return !childView.isRectIgnored();\n    }).map(function (childView) {\n      return childView.rect;\n    }).forEach(function (childViewRect) {\n      expandRect(rect.inner, Object.assign({}, childViewRect.inner));\n      expandRect(rect.outer, Object.assign({}, childViewRect.outer));\n    }); // calculate inner width and height\n\n    calculateRectSize(rect.inner); // append additional margin (top and left margins are included in top and left automatically)\n\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight; // calculate outer width and height\n\n    calculateRectSize(rect.outer);\n    return rect;\n  };\n\n  var expandRect = function expandRect(parent, child) {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n\n    if (child.bottom > parent.bottom) {\n      parent.bottom = child.bottom;\n    }\n\n    if (child.right > parent.right) {\n      parent.right = child.right;\n    }\n  };\n\n  var calculateRectSize = function calculateRectSize(rect) {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n  };\n\n  var isNumber = function isNumber(value) {\n    return typeof value === 'number';\n  };\n  /**\n   * Determines if position is at destination\n   * @param position\n   * @param destination\n   * @param velocity\n   * @param errorMargin\n   * @returns {boolean}\n   */\n\n\n  var thereYet = function thereYet(position, destination, velocity) {\n    var errorMargin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;\n    return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;\n  };\n  /**\n   * Spring animation\n   */\n\n\n  var spring = // default options\n  function spring() // method definition\n  {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$stiffness = _ref.stiffness,\n        stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,\n        _ref$damping = _ref.damping,\n        damping = _ref$damping === void 0 ? 0.75 : _ref$damping,\n        _ref$mass = _ref.mass,\n        mass = _ref$mass === void 0 ? 10 : _ref$mass;\n\n    var target = null;\n    var position = null;\n    var velocity = 0;\n    var resting = false; // updates spring state\n\n    var interpolate = function interpolate(ts, skipToEndState) {\n      // in rest, don't animate\n      if (resting) return; // need at least a target or position to do springy things\n\n      if (!(isNumber(target) && isNumber(position))) {\n        resting = true;\n        velocity = 0;\n        return;\n      } // calculate spring force\n\n\n      var f = -(position - target) * stiffness; // update velocity by adding force based on mass\n\n      velocity += f / mass; // update position by adding velocity\n\n      position += velocity; // slow down based on amount of damping\n\n      velocity *= damping; // we've arrived if we're near target and our velocity is near zero\n\n      if (thereYet(position, target, velocity) || skipToEndState) {\n        position = target;\n        velocity = 0;\n        resting = true; // we done\n\n        api.onupdate(position);\n        api.oncomplete(position);\n      } else {\n        // progress update\n        api.onupdate(position);\n      }\n    };\n    /**\n     * Set new target value\n     * @param value\n     */\n\n\n    var setTarget = function setTarget(value) {\n      // if currently has no position, set target and position to this value\n      if (isNumber(value) && !isNumber(position)) {\n        position = value;\n      } // next target value will not be animated to\n\n\n      if (target === null) {\n        target = value;\n        position = value;\n      } // let start moving to target\n\n\n      target = value; // already at target\n\n      if (position === target || typeof target === 'undefined') {\n        // now resting as target is current position, stop moving\n        resting = true;\n        velocity = 0; // done!\n\n        api.onupdate(position);\n        api.oncomplete(position);\n        return;\n      }\n\n      resting = false;\n    }; // need 'api' to call onupdate callback\n\n\n    var api = createObject({\n      interpolate: interpolate,\n      target: {\n        set: setTarget,\n        get: function get() {\n          return target;\n        }\n      },\n      resting: {\n        get: function get() {\n          return resting;\n        }\n      },\n      onupdate: function onupdate(value) {},\n      oncomplete: function oncomplete(value) {}\n    });\n    return api;\n  };\n\n  var easeLinear = function easeLinear(t) {\n    return t;\n  };\n\n  var easeInOutQuad = function easeInOutQuad(t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n  };\n\n  var tween = // default values\n  function tween() // method definition\n  {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$duration = _ref.duration,\n        duration = _ref$duration === void 0 ? 500 : _ref$duration,\n        _ref$easing = _ref.easing,\n        easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,\n        _ref$delay = _ref.delay,\n        delay = _ref$delay === void 0 ? 0 : _ref$delay;\n\n    var start = null;\n    var t;\n    var p;\n    var resting = true;\n    var reverse = false;\n    var target = null;\n\n    var interpolate = function interpolate(ts, skipToEndState) {\n      if (resting || target === null) return;\n\n      if (start === null) {\n        start = ts;\n      }\n\n      if (ts - start < delay) return;\n      t = ts - start - delay;\n\n      if (t >= duration || skipToEndState) {\n        t = 1;\n        p = reverse ? 0 : 1;\n        api.onupdate(p * target);\n        api.oncomplete(p * target);\n        resting = true;\n      } else {\n        p = t / duration;\n        api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n      }\n    }; // need 'api' to call onupdate callback\n\n\n    var api = createObject({\n      interpolate: interpolate,\n      target: {\n        get: function get() {\n          return reverse ? 0 : target;\n        },\n        set: function set(value) {\n          // is initial value\n          if (target === null) {\n            target = value;\n            api.onupdate(value);\n            api.oncomplete(value);\n            return;\n          } // want to tween to a smaller value and have a current value\n\n\n          if (value < target) {\n            target = 1;\n            reverse = true;\n          } else {\n            // not tweening to a smaller value\n            reverse = false;\n            target = value;\n          } // let's go!\n\n\n          resting = false;\n          start = null;\n        }\n      },\n      resting: {\n        get: function get() {\n          return resting;\n        }\n      },\n      onupdate: function onupdate(value) {},\n      oncomplete: function oncomplete(value) {}\n    });\n    return api;\n  };\n\n  var animator = {\n    spring: spring,\n    tween: tween\n  };\n  /*\n                       { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n                       { translation: { type: 'spring', ... }, ... }\n                       { translation: { x: { type: 'spring', ... } } }\n                      */\n\n  var createAnimator = function createAnimator(definition, category, property) {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    var def = definition[category] && typeof definition[category][property] === 'object' ? definition[category][property] : definition[category] || definition;\n    var type = typeof def === 'string' ? def : def.type;\n    var props = typeof def === 'object' ? Object.assign({}, def) : {};\n    return animator[type] ? animator[type](props) : null;\n  };\n\n  var addGetSet = function addGetSet(keys, obj, props) {\n    var overwrite = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(function (o) {\n      keys.forEach(function (key) {\n        var name = key;\n\n        var getter = function getter() {\n          return props[key];\n        };\n\n        var setter = function setter(value) {\n          return props[key] = value;\n        };\n\n        if (typeof key === 'object') {\n          name = key.key;\n          getter = key.getter || getter;\n          setter = key.setter || setter;\n        }\n\n        if (o[name] && !overwrite) {\n          return;\n        }\n\n        o[name] = {\n          get: getter,\n          set: setter\n        };\n      });\n    });\n  }; // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // setup animators\n\n\n  var animations = function animations(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI; // initial properties\n\n    var initialProps = Object.assign({}, viewProps); // list of all active animations\n\n    var animations = []; // setup animators\n\n    forin(mixinConfig, function (property, animation) {\n      var animator = createAnimator(animation);\n\n      if (!animator) {\n        return;\n      } // when the animator updates, update the view state value\n\n\n      animator.onupdate = function (value) {\n        viewProps[property] = value;\n      }; // set animator target\n\n\n      animator.target = initialProps[property]; // when value is set, set the animator target value\n\n      var prop = {\n        key: property,\n        setter: function setter(value) {\n          // if already at target, we done!\n          if (animator.target === value) {\n            return;\n          }\n\n          animator.target = value;\n        },\n        getter: function getter() {\n          return viewProps[property];\n        }\n      }; // add getters and setters\n\n      addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true); // add it to the list for easy updating from the _write method\n\n      animations.push(animator);\n    }); // expose internal write api\n\n    return {\n      write: function write(ts) {\n        var skipToEndState = document.hidden;\n        var resting = true;\n        animations.forEach(function (animation) {\n          if (!animation.resting) resting = false;\n          animation.interpolate(ts, skipToEndState);\n        });\n        return resting;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var addEvent = function addEvent(element) {\n    return function (type, fn) {\n      element.addEventListener(type, fn);\n    };\n  };\n\n  var removeEvent = function removeEvent(element) {\n    return function (type, fn) {\n      element.removeEventListener(type, fn);\n    };\n  }; // mixin\n\n\n  var listeners = function listeners(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI,\n        viewState = _ref.viewState,\n        view = _ref.view;\n    var events = [];\n    var add = addEvent(view.element);\n    var remove = removeEvent(view.element);\n\n    viewExternalAPI.on = function (type, fn) {\n      events.push({\n        type: type,\n        fn: fn\n      });\n      add(type, fn);\n    };\n\n    viewExternalAPI.off = function (type, fn) {\n      events.splice(events.findIndex(function (event) {\n        return event.type === type && event.fn === fn;\n      }), 1);\n      remove(type, fn);\n    };\n\n    return {\n      write: function write() {\n        // not busy\n        return true;\n      },\n      destroy: function destroy() {\n        events.forEach(function (event) {\n          remove(event.type, event.fn);\n        });\n      }\n    };\n  }; // add to external api and link to props\n\n\n  var apis = function apis(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewExternalAPI = _ref.viewExternalAPI;\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  }; // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // set initial state based on props in viewProps\n  // apply as transforms each frame\n\n\n  var defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0\n  };\n\n  var styles = function styles(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI,\n        view = _ref.view; // initial props\n\n    var initialProps = Object.assign({}, viewProps); // current props\n\n    var currentProps = {}; // we will add those properties to the external API and link them to the viewState\n\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps); // override rect on internal and external rect getter so it takes in account transforms\n\n    var getOffset = function getOffset() {\n      return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    };\n\n    var getScale = function getScale() {\n      return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    };\n\n    var getRect = function getRect() {\n      return view.rect ? getViewRect(view.rect, view.childViews, getOffset(), getScale()) : null;\n    };\n\n    viewInternalAPI.rect = {\n      get: getRect\n    };\n    viewExternalAPI.rect = {\n      get: getRect\n    }; // apply view props\n\n    mixinConfig.forEach(function (key) {\n      viewProps[key] = typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];\n    }); // expose api\n\n    return {\n      write: function write() {\n        // see if props have changed\n        if (!propsHaveChanged(currentProps, viewProps)) {\n          return;\n        } // moves element to correct position on screen\n\n\n        applyStyles(view.element, viewProps); // store new transforms\n\n        Object.assign(currentProps, Object.assign({}, viewProps)); // no longer busy\n\n        return true;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n      return true;\n    } // lets analyze the individual props\n\n\n    for (var prop in newProps) {\n      if (newProps[prop] !== currentProps[prop]) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var applyStyles = function applyStyles(element, _ref2) {\n    var opacity = _ref2.opacity,\n        perspective = _ref2.perspective,\n        translateX = _ref2.translateX,\n        translateY = _ref2.translateY,\n        scaleX = _ref2.scaleX,\n        scaleY = _ref2.scaleY,\n        rotateX = _ref2.rotateX,\n        rotateY = _ref2.rotateY,\n        rotateZ = _ref2.rotateZ,\n        originX = _ref2.originX,\n        originY = _ref2.originY,\n        width = _ref2.width,\n        height = _ref2.height;\n    var transforms = '';\n    var styles = ''; // handle transform origin\n\n    if (isDefined(originX) || isDefined(originY)) {\n      styles += 'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';\n    } // transform order is relevant\n    // 0. perspective\n\n\n    if (isDefined(perspective)) {\n      transforms += 'perspective(' + perspective + 'px) ';\n    } // 1. translate\n\n\n    if (isDefined(translateX) || isDefined(translateY)) {\n      transforms += 'translate3d(' + (translateX || 0) + 'px, ' + (translateY || 0) + 'px, 0) ';\n    } // 2. scale\n\n\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n      transforms += 'scale3d(' + (isDefined(scaleX) ? scaleX : 1) + ', ' + (isDefined(scaleY) ? scaleY : 1) + ', 1) ';\n    } // 3. rotate\n\n\n    if (isDefined(rotateZ)) {\n      transforms += 'rotateZ(' + rotateZ + 'rad) ';\n    }\n\n    if (isDefined(rotateX)) {\n      transforms += 'rotateX(' + rotateX + 'rad) ';\n    }\n\n    if (isDefined(rotateY)) {\n      transforms += 'rotateY(' + rotateY + 'rad) ';\n    } // add transforms\n\n\n    if (transforms.length) {\n      styles += 'transform:' + transforms + ';';\n    } // add opacity\n\n\n    if (isDefined(opacity)) {\n      styles += 'opacity:' + opacity + ';'; // if we reach zero, we make the element inaccessible\n\n      if (opacity === 0) {\n        styles += 'visibility:hidden;';\n      } // if we're below 100% opacity this element can't be clicked\n\n\n      if (opacity < 1) {\n        styles += 'pointer-events:none;';\n      }\n    } // add height\n\n\n    if (isDefined(height)) {\n      styles += 'height:' + height + 'px;';\n    } // add width\n\n\n    if (isDefined(width)) {\n      styles += 'width:' + width + 'px;';\n    } // apply styles\n\n\n    var elementCurrentStyle = element.elementCurrentStyle || ''; // if new styles does not match current styles, lets update!\n\n    if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {\n      element.style.cssText = styles; // store current styles so we can compare them to new styles later on\n      // _not_ getting the style value is faster\n\n      element.elementCurrentStyle = styles;\n    }\n  };\n\n  var Mixins = {\n    styles: styles,\n    listeners: listeners,\n    animations: animations,\n    apis: apis\n  };\n\n  var updateRect = function updateRect() {\n    var rect = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var element = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var style = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!element.layoutCalculated) {\n      rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n      rect.marginTop = parseInt(style.marginTop, 10) || 0;\n      rect.marginRight = parseInt(style.marginRight, 10) || 0;\n      rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n      rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n      element.layoutCalculated = true;\n    }\n\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n    rect.scrollTop = element.scrollTop;\n    rect.hidden = element.offsetParent === null;\n    return rect;\n  };\n\n  var createView = // default view definition\n  function createView() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$tag = _ref.tag,\n        tag = _ref$tag === void 0 ? 'div' : _ref$tag,\n        _ref$name = _ref.name,\n        name = _ref$name === void 0 ? null : _ref$name,\n        _ref$attributes = _ref.attributes,\n        attributes = _ref$attributes === void 0 ? {} : _ref$attributes,\n        _ref$read = _ref.read,\n        read = _ref$read === void 0 ? function () {} : _ref$read,\n        _ref$write = _ref.write,\n        write = _ref$write === void 0 ? function () {} : _ref$write,\n        _ref$create = _ref.create,\n        create = _ref$create === void 0 ? function () {} : _ref$create,\n        _ref$destroy = _ref.destroy,\n        destroy = _ref$destroy === void 0 ? function () {} : _ref$destroy,\n        _ref$filterFrameActio = _ref.filterFrameActionsForChild,\n        filterFrameActionsForChild = _ref$filterFrameActio === void 0 ? function (child, actions) {\n      return actions;\n    } : _ref$filterFrameActio,\n        _ref$didCreateView = _ref.didCreateView,\n        didCreateView = _ref$didCreateView === void 0 ? function () {} : _ref$didCreateView,\n        _ref$didWriteView = _ref.didWriteView,\n        didWriteView = _ref$didWriteView === void 0 ? function () {} : _ref$didWriteView,\n        _ref$ignoreRect = _ref.ignoreRect,\n        ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,\n        _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,\n        ignoreRectUpdate = _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,\n        _ref$mixins = _ref.mixins,\n        mixins = _ref$mixins === void 0 ? [] : _ref$mixins;\n\n    return function ( // each view requires reference to store\n    store) {\n      var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // root element should not be changed\n\n      var element = createElement(tag, 'filepond--' + name, attributes); // style reference should also not be changed\n\n      var style = window.getComputedStyle(element, null); // element rectangle\n\n      var rect = updateRect();\n      var frameRect = null; // rest state\n\n      var isResting = false; // pretty self explanatory\n\n      var childViews = []; // loaded mixins\n\n      var activeMixins = []; // references to created children\n\n      var ref = {}; // state used for each instance\n\n      var state = {}; // list of writers that will be called to update this view\n\n      var writers = [write // default writer\n      ];\n      var readers = [read // default reader\n      ];\n      var destroyers = [destroy // default destroy\n      ]; // core view methods\n\n      var getElement = function getElement() {\n        return element;\n      };\n\n      var getChildViews = function getChildViews() {\n        return childViews.concat();\n      };\n\n      var getReference = function getReference() {\n        return ref;\n      };\n\n      var createChildView = function createChildView(store) {\n        return function (view, props) {\n          return view(store, props);\n        };\n      };\n\n      var getRect = function getRect() {\n        if (frameRect) {\n          return frameRect;\n        }\n\n        frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n        return frameRect;\n      };\n\n      var getStyle = function getStyle() {\n        return style;\n      };\n      /**\n       * Read data from DOM\n       * @private\n       */\n\n\n      var _read = function _read() {\n        frameRect = null; // read child views\n\n        childViews.forEach(function (child) {\n          return child._read();\n        });\n        var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n\n        if (shouldUpdate) {\n          updateRect(rect, element, style);\n        } // readers\n\n\n        var api = {\n          root: internalAPI,\n          props: props,\n          rect: rect\n        };\n        readers.forEach(function (reader) {\n          return reader(api);\n        });\n      };\n      /**\n       * Write data to DOM\n       * @private\n       */\n\n\n      var _write = function _write(ts, frameActions, shouldOptimize) {\n        // if no actions, we assume that the view is resting\n        var resting = frameActions.length === 0; // writers\n\n        writers.forEach(function (writer) {\n          var writerResting = writer({\n            props: props,\n            root: internalAPI,\n            actions: frameActions,\n            timestamp: ts,\n            shouldOptimize: shouldOptimize\n          });\n\n          if (writerResting === false) {\n            resting = false;\n          }\n        }); // run mixins\n\n        activeMixins.forEach(function (mixin) {\n          // if one of the mixins is still busy after write operation, we are not resting\n          var mixinResting = mixin.write(ts);\n\n          if (mixinResting === false) {\n            resting = false;\n          }\n        }); // updates child views that are currently attached to the DOM\n\n        childViews.filter(function (child) {\n          return !!child.element.parentNode;\n        }).forEach(function (child) {\n          // if a child view is not resting, we are not resting\n          var childResting = child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize);\n\n          if (!childResting) {\n            resting = false;\n          }\n        }); // append new elements to DOM and update those\n\n        childViews //.filter(child => !child.element.parentNode)\n        .forEach(function (child, index) {\n          // skip\n          if (child.element.parentNode) {\n            return;\n          } // append to DOM\n\n\n          internalAPI.appendChild(child.element, index); // call read (need to know the size of these elements)\n\n          child._read(); // re-call write\n\n\n          child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize); // we just added somthing to the dom, no rest\n\n\n          resting = false;\n        }); // update resting state\n\n        isResting = resting;\n        didWriteView({\n          props: props,\n          root: internalAPI,\n          actions: frameActions,\n          timestamp: ts\n        }); // let parent know if we are resting\n\n        return resting;\n      };\n\n      var _destroy = function _destroy() {\n        activeMixins.forEach(function (mixin) {\n          return mixin.destroy();\n        });\n        destroyers.forEach(function (destroyer) {\n          destroyer({\n            root: internalAPI,\n            props: props\n          });\n        });\n        childViews.forEach(function (child) {\n          return child._destroy();\n        });\n      }; // sharedAPI\n\n\n      var sharedAPIDefinition = {\n        element: {\n          get: getElement\n        },\n        style: {\n          get: getStyle\n        },\n        childViews: {\n          get: getChildViews\n        }\n      }; // private API definition\n\n      var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n        rect: {\n          get: getRect\n        },\n        // access to custom children references\n        ref: {\n          get: getReference\n        },\n        // dom modifiers\n        is: function is(needle) {\n          return name === needle;\n        },\n        appendChild: appendChild(element),\n        createChildView: createChildView(store),\n        linkView: function linkView(view) {\n          childViews.push(view);\n          return view;\n        },\n        unlinkView: function unlinkView(view) {\n          childViews.splice(childViews.indexOf(view), 1);\n        },\n        appendChildView: appendChildView(element, childViews),\n        removeChildView: removeChildView(element, childViews),\n        registerWriter: function registerWriter(writer) {\n          return writers.push(writer);\n        },\n        registerReader: function registerReader(reader) {\n          return readers.push(reader);\n        },\n        registerDestroyer: function registerDestroyer(destroyer) {\n          return destroyers.push(destroyer);\n        },\n        invalidateLayout: function invalidateLayout() {\n          return element.layoutCalculated = false;\n        },\n        // access to data store\n        dispatch: store.dispatch,\n        query: store.query\n      }); // public view API methods\n\n      var externalAPIDefinition = {\n        element: {\n          get: getElement\n        },\n        childViews: {\n          get: getChildViews\n        },\n        rect: {\n          get: getRect\n        },\n        resting: {\n          get: function get() {\n            return isResting;\n          }\n        },\n        isRectIgnored: function isRectIgnored() {\n          return ignoreRect;\n        },\n        _read: _read,\n        _write: _write,\n        _destroy: _destroy\n      }; // mixin API methods\n\n      var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n        rect: {\n          get: function get() {\n            return rect;\n          }\n        }\n      }); // add mixin functionality\n\n      Object.keys(mixins).sort(function (a, b) {\n        // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n        if (a === 'styles') {\n          return 1;\n        } else if (b === 'styles') {\n          return -1;\n        }\n\n        return 0;\n      }).forEach(function (key) {\n        var mixinAPI = Mixins[key]({\n          mixinConfig: mixins[key],\n          viewProps: props,\n          viewState: state,\n          viewInternalAPI: internalAPIDefinition,\n          viewExternalAPI: externalAPIDefinition,\n          view: createObject(mixinAPIDefinition)\n        });\n\n        if (mixinAPI) {\n          activeMixins.push(mixinAPI);\n        }\n      }); // construct private api\n\n      var internalAPI = createObject(internalAPIDefinition); // create the view\n\n      create({\n        root: internalAPI,\n        props: props\n      }); // append created child views to root node\n\n      var childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\n\n      childViews.forEach(function (child, index) {\n        internalAPI.appendChild(child.element, childCount + index);\n      }); // call did create\n\n      didCreateView(internalAPI); // expose public api\n\n      return createObject(externalAPIDefinition);\n    };\n  };\n\n  var createPainter = function createPainter(read, write) {\n    var fps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;\n    var name = '__framePainter'; // set global painter\n\n    if (window[name]) {\n      window[name].readers.push(read);\n      window[name].writers.push(write);\n      return;\n    }\n\n    window[name] = {\n      readers: [read],\n      writers: [write]\n    };\n    var painter = window[name];\n    var interval = 1000 / fps;\n    var last = null;\n    var id = null;\n    var requestTick = null;\n    var cancelTick = null;\n\n    var setTimerType = function setTimerType() {\n      if (document.hidden) {\n        requestTick = function requestTick() {\n          return window.setTimeout(function () {\n            return tick(performance.now());\n          }, interval);\n        };\n\n        cancelTick = function cancelTick() {\n          return window.clearTimeout(id);\n        };\n      } else {\n        requestTick = function requestTick() {\n          return window.requestAnimationFrame(tick);\n        };\n\n        cancelTick = function cancelTick() {\n          return window.cancelAnimationFrame(id);\n        };\n      }\n    };\n\n    document.addEventListener('visibilitychange', function () {\n      if (cancelTick) cancelTick();\n      setTimerType();\n      tick(performance.now());\n    });\n\n    var tick = function tick(ts) {\n      // queue next tick\n      id = requestTick(tick); // limit fps\n\n      if (!last) {\n        last = ts;\n      }\n\n      var delta = ts - last;\n\n      if (delta <= interval) {\n        // skip frame\n        return;\n      } // align next frame\n\n\n      last = ts - delta % interval; // update view\n\n      painter.readers.forEach(function (read) {\n        return read();\n      });\n      painter.writers.forEach(function (write) {\n        return write(ts);\n      });\n    };\n\n    setTimerType();\n    tick(performance.now());\n    return {\n      pause: function pause() {\n        cancelTick(id);\n      }\n    };\n  };\n\n  var createRoute = function createRoute(routes, fn) {\n    return function (_ref) {\n      var root = _ref.root,\n          props = _ref.props,\n          _ref$actions = _ref.actions,\n          actions = _ref$actions === void 0 ? [] : _ref$actions,\n          timestamp = _ref.timestamp,\n          shouldOptimize = _ref.shouldOptimize;\n      actions.filter(function (action) {\n        return routes[action.type];\n      }).forEach(function (action) {\n        return routes[action.type]({\n          root: root,\n          props: props,\n          action: action.data,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      });\n\n      if (fn) {\n        fn({\n          root: root,\n          props: props,\n          actions: actions,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      }\n    };\n  };\n\n  var insertBefore = function insertBefore(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode);\n  };\n\n  var insertAfter = function insertAfter(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n  };\n\n  var isArray = function isArray(value) {\n    return Array.isArray(value);\n  };\n\n  var isEmpty = function isEmpty(value) {\n    return value == null;\n  };\n\n  var trim = function trim(str) {\n    return str.trim();\n  };\n\n  var toString = function toString(value) {\n    return '' + value;\n  };\n\n  var toArray = function toArray(value) {\n    var splitter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n\n    if (isEmpty(value)) {\n      return [];\n    }\n\n    if (isArray(value)) {\n      return value;\n    }\n\n    return toString(value).split(splitter).map(trim).filter(function (str) {\n      return str.length;\n    });\n  };\n\n  var isBoolean = function isBoolean(value) {\n    return typeof value === 'boolean';\n  };\n\n  var toBoolean = function toBoolean(value) {\n    return isBoolean(value) ? value : value === 'true';\n  };\n\n  var isString = function isString(value) {\n    return typeof value === 'string';\n  };\n\n  var toNumber = function toNumber(value) {\n    return isNumber(value) ? value : isString(value) ? toString(value).replace(/[a-z]+/gi, '') : 0;\n  };\n\n  var toInt = function toInt(value) {\n    return parseInt(toNumber(value), 10);\n  };\n\n  var toFloat = function toFloat(value) {\n    return parseFloat(toNumber(value));\n  };\n\n  var isInt = function isInt(value) {\n    return isNumber(value) && isFinite(value) && Math.floor(value) === value;\n  };\n\n  var toBytes = function toBytes(value) {\n    // is in bytes\n    if (isInt(value)) {\n      return value;\n    } // is natural file size\n\n\n    var naturalFileSize = toString(value).trim(); // if is value in megabytes\n\n    if (/MB$/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n      return toInt(naturalFileSize) * 1000 * 1000;\n    } // if is value in kilobytes\n\n\n    if (/KB/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n      return toInt(naturalFileSize) * 1000;\n    }\n\n    return toInt(naturalFileSize);\n  };\n\n  var isFunction = function isFunction(value) {\n    return typeof value === 'function';\n  };\n\n  var toFunctionReference = function toFunctionReference(string) {\n    var ref = self;\n    var levels = string.split('.');\n    var level = null;\n\n    while (level = levels.shift()) {\n      ref = ref[level];\n\n      if (!ref) {\n        return null;\n      }\n    }\n\n    return ref;\n  };\n\n  var methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET'\n  };\n\n  var createServerAPI = function createServerAPI(outline) {\n    var api = {};\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n    forin(methods, function (key) {\n      api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);\n    }); // special treatment for remove\n\n    api.remove = outline.remove || null; // remove generic headers from api object\n\n    delete api.headers;\n    return api;\n  };\n\n  var createAction = function createAction(name, outline, method, timeout, headers) {\n    // is explicitely set to null so disable\n    if (outline === null) {\n      return null;\n    } // if is custom function, done! Dev handles everything.\n\n\n    if (typeof outline === 'function') {\n      return outline;\n    } // build action object\n\n\n    var action = {\n      url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',\n      method: method,\n      headers: headers,\n      withCredentials: false,\n      timeout: timeout,\n      onload: null,\n      ondata: null,\n      onerror: null\n    }; // is a single url\n\n    if (isString(outline)) {\n      action.url = outline;\n      return action;\n    } // overwrite\n\n\n    Object.assign(action, outline); // see if should reformat headers;\n\n    if (isString(action.headers)) {\n      var parts = action.headers.split(/:(.+)/);\n      action.headers = {\n        header: parts[0],\n        value: parts[1]\n      };\n    } // if is bool withCredentials\n\n\n    action.withCredentials = toBoolean(action.withCredentials);\n    return action;\n  };\n\n  var toServerAPI = function toServerAPI(value) {\n    return createServerAPI(value);\n  };\n\n  var isNull = function isNull(value) {\n    return value === null;\n  };\n\n  var isObject = function isObject(value) {\n    return typeof value === 'object' && value !== null;\n  };\n\n  var isAPI = function isAPI(value) {\n    return isObject(value) && isString(value.url) && isObject(value.process) && isObject(value.revert) && isObject(value.restore) && isObject(value.fetch);\n  };\n\n  var getType = function getType(value) {\n    if (isArray(value)) {\n      return 'array';\n    }\n\n    if (isNull(value)) {\n      return 'null';\n    }\n\n    if (isInt(value)) {\n      return 'int';\n    }\n\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n      return 'bytes';\n    }\n\n    if (isAPI(value)) {\n      return 'api';\n    }\n\n    return typeof value;\n  };\n\n  var replaceSingleQuotes = function replaceSingleQuotes(str) {\n    return str.replace(/{\\s*'/g, '{\"').replace(/'\\s*}/g, '\"}').replace(/'\\s*:/g, '\":').replace(/:\\s*'/g, ':\"').replace(/,\\s*'/g, ',\"').replace(/'\\s*,/g, '\",');\n  };\n\n  var conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: function int(value) {\n      return getType(value) === 'bytes' ? toBytes(value) : toInt(value);\n    },\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: function string(value) {\n      return isFunction(value) ? value : toString(value);\n    },\n    function: function _function(value) {\n      return toFunctionReference(value);\n    },\n    serverapi: toServerAPI,\n    object: function object(value) {\n      try {\n        return JSON.parse(replaceSingleQuotes(value));\n      } catch (e) {\n        return null;\n      }\n    }\n  };\n\n  var convertTo = function convertTo(value, type) {\n    return conversionTable[type](value);\n  };\n\n  var getValueByType = function getValueByType(newValue, defaultValue, valueType) {\n    // can always assign default value\n    if (newValue === defaultValue) {\n      return newValue;\n    } // get the type of the new value\n\n\n    var newValueType = getType(newValue); // is valid type?\n\n    if (newValueType !== valueType) {\n      // is string input, let's attempt to convert\n      var convertedValue = convertTo(newValue, valueType); // what is the type now\n\n      newValueType = getType(convertedValue); // no valid conversions found\n\n      if (convertedValue === null) {\n        throw 'Trying to assign value with incorrect type to \"' + option + '\", allowed type: \"' + valueType + '\"';\n      } else {\n        newValue = convertedValue;\n      }\n    } // assign new value\n\n\n    return newValue;\n  };\n\n  var createOption = function createOption(defaultValue, valueType) {\n    var currentValue = defaultValue;\n    return {\n      enumerable: true,\n      get: function get() {\n        return currentValue;\n      },\n      set: function set(newValue) {\n        currentValue = getValueByType(newValue, defaultValue, valueType);\n      }\n    };\n  };\n\n  var createOptions = function createOptions(options) {\n    var obj = {};\n    forin(options, function (prop) {\n      var optionDefinition = options[prop];\n      obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n  };\n\n  var createInitialState = function createInitialState(options) {\n    return {\n      // model\n      items: [],\n      // timeout used for calling update items\n      listUpdateTimeout: null,\n      // timeout used for stacking metadata updates\n      itemUpdateTimeout: null,\n      // queue of items waiting to be processed\n      processingQueue: [],\n      // options\n      options: createOptions(options)\n    };\n  };\n\n  var fromCamels = function fromCamels(string) {\n    var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.split(/(?=[A-Z])/).map(function (part) {\n      return part.toLowerCase();\n    }).join(separator);\n  };\n\n  var createOptionAPI = function createOptionAPI(store, options) {\n    var obj = {};\n    forin(options, function (key) {\n      obj[key] = {\n        get: function get() {\n          return store.getState().options[key];\n        },\n        set: function set(value) {\n          store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        }\n      };\n    });\n    return obj;\n  };\n\n  var createOptionActions = function createOptionActions(options) {\n    return function (dispatch, query, state) {\n      var obj = {};\n      forin(options, function (key) {\n        var name = fromCamels(key, '_').toUpperCase();\n\n        obj['SET_' + name] = function (action) {\n          try {\n            state.options[key] = action.value;\n          } catch (e) {} // nope, failed\n          // we successfully set the value of this option\n\n\n          dispatch('DID_SET_' + name, {\n            value: state.options[key]\n          });\n        };\n      });\n      return obj;\n    };\n  };\n\n  var createOptionQueries = function createOptionQueries(options) {\n    return function (state) {\n      var obj = {};\n      forin(options, function (key) {\n        obj['GET_' + fromCamels(key, '_').toUpperCase()] = function (action) {\n          return state.options[key];\n        };\n      });\n      return obj;\n    };\n  };\n\n  var InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5\n  };\n\n  var getUniqueId = function getUniqueId() {\n    return Math.random().toString(36).substr(2, 9);\n  };\n\n  var arrayRemove = function arrayRemove(arr, index) {\n    return arr.splice(index, 1);\n  };\n\n  var _fire = function fire(cb) {\n    if (document.hidden) {\n      Promise.resolve(1).then(cb);\n    } else {\n      setTimeout(cb, 0);\n    }\n  };\n\n  var on = function on() {\n    var listeners = [];\n\n    var off = function off(event, cb) {\n      arrayRemove(listeners, listeners.findIndex(function (listener) {\n        return listener.event === event && (listener.cb === cb || !cb);\n      }));\n    };\n\n    return {\n      fire: function fire(event) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        listeners.filter(function (listener) {\n          return listener.event === event;\n        }).map(function (listener) {\n          return listener.cb;\n        }).forEach(function (cb) {\n          return _fire(function () {\n            return cb.apply(void 0, args);\n          });\n        });\n      },\n      on: function on(event, cb) {\n        listeners.push({\n          event: event,\n          cb: cb\n        });\n      },\n      onOnce: function onOnce(event, _cb) {\n        listeners.push({\n          event: event,\n          cb: function cb() {\n            off(event, _cb);\n\n            _cb.apply(void 0, arguments);\n          }\n        });\n      },\n      off: off\n    };\n  };\n\n  var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(src, target, excluded) {\n    Object.getOwnPropertyNames(src).filter(function (property) {\n      return !excluded.includes(property);\n    }).forEach(function (key) {\n      return Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(src, key));\n    });\n  };\n\n  var PRIVATE = ['fire', 'process', 'revert', 'load', 'on', 'off', 'onOnce', 'retryLoad', 'extend', 'archive', 'archived', 'release', 'released', 'requestProcessing', 'freeze'];\n\n  var createItemAPI = function createItemAPI(item) {\n    var api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n  };\n\n  var removeReleasedItems = function removeReleasedItems(items) {\n    items.forEach(function (item, index) {\n      if (item.released) {\n        arrayRemove(items, index);\n      }\n    });\n  };\n\n  var ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8\n  };\n  var FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3\n  };\n\n  var getNonNumeric = function getNonNumeric(str) {\n    return /[^0-9]+/.exec(str);\n  };\n\n  var getDecimalSeparator = function getDecimalSeparator() {\n    return getNonNumeric(1.1.toLocaleString())[0];\n  };\n\n  var getThousandsSeparator = function getThousandsSeparator() {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    var decimalSeparator = getDecimalSeparator();\n    var thousandsStringWithSeparator = 1000.0.toLocaleString();\n    var thousandsStringWithoutSeparator = 1000.0.toString();\n\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n      return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n\n    return decimalSeparator === '.' ? ',' : '.';\n  };\n\n  var Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex'\n  }; // all registered filters\n\n  var filters = []; // loops over matching filters and passes options to each filter, returning the mapped results\n\n  var applyFilterChain = function applyFilterChain(key, value, utils) {\n    return new Promise(function (resolve, reject) {\n      // find matching filters for this key\n      var matchingFilters = filters.filter(function (f) {\n        return f.key === key;\n      }).map(function (f) {\n        return f.cb;\n      }); // resolve now\n\n      if (matchingFilters.length === 0) {\n        resolve(value);\n        return;\n      } // first filter to kick things of\n\n\n      var initialFilter = matchingFilters.shift(); // chain filters\n\n      matchingFilters.reduce( // loop over promises passing value to next promise\n      function (current, next) {\n        return current.then(function (value) {\n          return next(value, utils);\n        });\n      }, // call initial filter, will return a promise\n      initialFilter(value, utils) // all executed\n      ).then(function (value) {\n        return resolve(value);\n      }).catch(function (error) {\n        return reject(error);\n      });\n    });\n  };\n\n  var applyFilters = function applyFilters(key, value, utils) {\n    return filters.filter(function (f) {\n      return f.key === key;\n    }).map(function (f) {\n      return f.cb(value, utils);\n    });\n  }; // adds a new filter to the list\n\n\n  var addFilter = function addFilter(key, cb) {\n    return filters.push({\n      key: key,\n      cb: cb\n    });\n  };\n\n  var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {\n    return Object.assign(defaultOptions, additionalOptions);\n  };\n\n  var getOptions = function getOptions() {\n    return Object.assign({}, defaultOptions);\n  };\n\n  var setOptions = function setOptions(opts) {\n    forin(opts, function (key, value) {\n      // key does not exist, so this option cannot be set\n      if (!defaultOptions[key]) {\n        return;\n      }\n\n      defaultOptions[key][0] = getValueByType(value, defaultOptions[key][0], defaultOptions[key][1]);\n    });\n  }; // default options on app\n\n\n  var defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n    // input field name to use\n    name: ['filepond', Type.STRING],\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n    // is the field required\n    required: [false, Type.BOOLEAN],\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN],\n    // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN],\n    // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN],\n    // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN],\n    // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN],\n    // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN],\n    // Allows user to revert file upload\n    allowReorder: [false, Type.BOOLEAN],\n    // Allow reordering of files\n    allowDirectoriesOnly: [false, Type.BOOLEAN],\n    // Allow only selecting directories with browse (no support for filtering dnd at this point)\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN],\n    // Set to 'force' to require the file to be reverted before removal\n    // Input requirements\n    maxFiles: [null, Type.INT],\n    // Max number of files\n    checkValidity: [false, Type.BOOLEAN],\n    // Enables custom validity messages\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN],\n    // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING],\n    // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN],\n    // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN],\n    // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN],\n    // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN],\n    // Should upload files immidiately on drop\n    maxParallelUploads: [2, Type.INT],\n    // Maximum files to upload in parallel\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN],\n    // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN],\n    // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT],\n    // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.Array],\n    // Amount of times to retry upload of a chunk when it fails\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n    // Labels and status messages\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING],\n    // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING],\n    // Default is locale separator\n    labelIdle: ['Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>', Type.STRING],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING],\n    // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING],\n    // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconProcess: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>', Type.STRING],\n    iconRetry: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconUndo: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconDone: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n    onreorderfiles: [null, Type.FUNCTION],\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n    // styles\n    stylePanelLayout: [null, Type.STRING],\n    // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING],\n    // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n    styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\n    // custom initial files array\n    files: [[], Type.ARRAY]\n  };\n\n  var getItemByQuery = function getItemByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return items[0] || null;\n    } // query is index\n\n\n    if (isInt(query)) {\n      return items[query] || null;\n    } // if query is item, get the id\n\n\n    if (typeof query === 'object') {\n      query = query.id;\n    } // assume query is a string and return item by id\n\n\n    return items.find(function (item) {\n      return item.id === query;\n    }) || null;\n  };\n\n  var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(aspectRatio) {\n    if (isEmpty(aspectRatio)) {\n      return aspectRatio;\n    }\n\n    if (/:/.test(aspectRatio)) {\n      var parts = aspectRatio.split(':');\n      return parts[1] / parts[0];\n    }\n\n    return parseFloat(aspectRatio);\n  };\n\n  var getActiveItems = function getActiveItems(items) {\n    return items.filter(function (item) {\n      return !item.archived;\n    });\n  };\n\n  var Status = {\n    EMPTY: 0,\n    IDLE: 1,\n    // waiting\n    ERROR: 2,\n    // a file is in error state\n    BUSY: 3,\n    // busy processing or loading\n    READY: 4 // all files uploaded\n\n  };\n  var ITEM_ERROR = [ItemStatus.LOAD_ERROR, ItemStatus.PROCESSING_ERROR, ItemStatus.PROCESSING_REVERT_ERROR];\n  var ITEM_BUSY = [ItemStatus.LOADING, ItemStatus.PROCESSING, ItemStatus.PROCESSING_QUEUED, ItemStatus.INIT];\n  var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\n  var isItemInErrorState = function isItemInErrorState(item) {\n    return ITEM_ERROR.includes(item.status);\n  };\n\n  var isItemInBusyState = function isItemInBusyState(item) {\n    return ITEM_BUSY.includes(item.status);\n  };\n\n  var isItemInReadyState = function isItemInReadyState(item) {\n    return ITEM_READY.includes(item.status);\n  };\n\n  var queries = function queries(state) {\n    return {\n      GET_STATUS: function GET_STATUS() {\n        var items = getActiveItems(state.items);\n        var EMPTY = Status.EMPTY,\n            ERROR = Status.ERROR,\n            BUSY = Status.BUSY,\n            IDLE = Status.IDLE,\n            READY = Status.READY;\n        if (items.length === 0) return EMPTY;\n        if (items.some(isItemInErrorState)) return ERROR;\n        if (items.some(isItemInBusyState)) return BUSY;\n        if (items.some(isItemInReadyState)) return READY;\n        return IDLE;\n      },\n      GET_ITEM: function GET_ITEM(query) {\n        return getItemByQuery(state.items, query);\n      },\n      GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {\n        return getItemByQuery(getActiveItems(state.items), query);\n      },\n      GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {\n        return getActiveItems(state.items);\n      },\n      GET_ITEMS: function GET_ITEMS() {\n        return state.items;\n      },\n      GET_ITEM_NAME: function GET_ITEM_NAME(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n      },\n      GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n      },\n      GET_STYLES: function GET_STYLES() {\n        return Object.keys(state.options).filter(function (key) {\n          return /^style/.test(key);\n        }).map(function (option) {\n          return {\n            name: option,\n            value: state.options[option]\n          };\n        });\n      },\n      GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {\n        var isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        var aspectRatio = isShapeCircle ? 1 : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);\n        return aspectRatio;\n      },\n      GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {\n        return state.options.styleItemPanelAspectRatio;\n      },\n      GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {\n        return getActiveItems(state.items).filter(function (item) {\n          return item.status === status;\n        });\n      },\n      GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {\n        return getActiveItems(state.items).length;\n      },\n      IS_ASYNC: function IS_ASYNC() {\n        return isObject(state.options.server) && (isObject(state.options.server.process) || isFunction(state.options.server.process));\n      }\n    };\n  };\n\n  var hasRoomForItem = function hasRoomForItem(state) {\n    var count = getActiveItems(state.items).length; // if cannot have multiple items, to add one item it should currently not contain items\n\n    if (!state.options.allowMultiple) {\n      return count === 0;\n    } // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n\n\n    var maxFileCount = state.options.maxFiles;\n\n    if (maxFileCount === null) {\n      return true;\n    } // we check if the current count is smaller than the max count, if so, another file can still be added\n\n\n    if (count < maxFileCount) {\n      return true;\n    } // no more room for another file\n\n\n    return false;\n  };\n\n  var limit = function limit(value, min, max) {\n    return Math.max(Math.min(max, value), min);\n  };\n\n  var arrayInsert = function arrayInsert(arr, index, item) {\n    return arr.splice(index, 0, item);\n  };\n\n  var insertItem = function insertItem(items, item, index) {\n    if (isEmpty(item)) {\n      return null;\n    } // if index is undefined, append\n\n\n    if (typeof index === 'undefined') {\n      items.push(item);\n      return item;\n    } // limit the index to the size of the items array\n\n\n    index = limit(index, 0, items.length); // add item to array\n\n    arrayInsert(items, index, item); // expose\n\n    return item;\n  };\n\n  var isBase64DataURI = function isBase64DataURI(str) {\n    return /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(str);\n  };\n\n  var getFilenameFromURL = function getFilenameFromURL(url) {\n    return url.split('/').pop().split('?').shift();\n  };\n\n  var getExtensionFromFilename = function getExtensionFromFilename(name) {\n    return name.split('.').pop();\n  };\n\n  var guesstimateExtension = function guesstimateExtension(type) {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n      return '';\n    } // get subtype\n\n\n    var subtype = type.split('/').pop(); // is svg subtype\n\n    if (/svg/.test(subtype)) {\n      return 'svg';\n    }\n\n    if (/zip|compressed/.test(subtype)) {\n      return 'zip';\n    }\n\n    if (/plain/.test(subtype)) {\n      return 'txt';\n    }\n\n    if (/msword/.test(subtype)) {\n      return 'doc';\n    } // if is valid subtype\n\n\n    if (/[a-z]+/.test(subtype)) {\n      // always use jpg extension\n      if (subtype === 'jpeg') {\n        return 'jpg';\n      } // return subtype\n\n\n      return subtype;\n    }\n\n    return '';\n  };\n\n  var leftPad = function leftPad(value) {\n    var padding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    return (padding + value).slice(-padding.length);\n  };\n\n  var getDateString = function getDateString() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n    return date.getFullYear() + '-' + leftPad(date.getMonth() + 1, '00') + '-' + leftPad(date.getDate(), '00') + '_' + leftPad(date.getHours(), '00') + '-' + leftPad(date.getMinutes(), '00') + '-' + leftPad(date.getSeconds(), '00');\n  };\n\n  var getFileFromBlob = function getFileFromBlob(blob, filename) {\n    var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var extension = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    var file = typeof type === 'string' ? blob.slice(0, blob.size, type) : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date(); // copy relative path\n\n    if (blob._relativePath) file._relativePath = blob._relativePath; // if blob has name property, use as filename if no filename supplied\n\n    if (!isString(filename)) {\n      filename = getDateString();\n    } // if filename supplied but no extension and filename has extension\n\n\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n      file.name = filename;\n    } else {\n      extension = extension || guesstimateExtension(file.type);\n      file.name = filename + (extension ? '.' + extension : '');\n    }\n\n    return file;\n  };\n\n  var getBlobBuilder = function getBlobBuilder() {\n    return window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n  };\n\n  var createBlob = function createBlob(arrayBuffer, mimeType) {\n    var BB = getBlobBuilder();\n\n    if (BB) {\n      var bb = new BB();\n      bb.append(arrayBuffer);\n      return bb.getBlob(mimeType);\n    }\n\n    return new Blob([arrayBuffer], {\n      type: mimeType\n    });\n  };\n\n  var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(byteString, mimeType) {\n    var ab = new ArrayBuffer(byteString.length);\n    var ia = new Uint8Array(ab);\n\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n\n    return createBlob(ab, mimeType);\n  };\n\n  var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(dataURI) {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n  };\n\n  var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(dataURI) {\n    // get data part of string (remove data:image/jpeg...,)\n    var data = dataURI.split(',')[1]; // remove any whitespace as that causes InvalidCharacterError in IE\n\n    return data.replace(/\\s/g, '');\n  };\n\n  var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(dataURI) {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n  };\n\n  var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {\n    var mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    var byteString = getByteStringFromBase64DataURI(dataURI);\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n  };\n\n  var getFileFromBase64DataURI = function getFileFromBase64DataURI(dataURI, filename, extension) {\n    return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);\n  };\n\n  var getFileNameFromHeader = function getFileNameFromHeader(header) {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null; // get filename parts\n\n    var matches = header.split(/filename=|filename\\*=.+''/).splice(1).map(function (name) {\n      return name.trim().replace(/^[\"']|[;\"']{0,2}$/g, '');\n    }).filter(function (name) {\n      return name.length;\n    });\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n  };\n\n  var getFileSizeFromHeader = function getFileSizeFromHeader(header) {\n    if (/content-length:/i.test(header)) {\n      var size = header.match(/[0-9]+/)[0];\n      return size ? parseInt(size, 10) : null;\n    }\n\n    return null;\n  };\n\n  var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {\n    if (/x-content-transfer-id:/i.test(header)) {\n      var id = (header.split(':')[1] || '').trim();\n      return id || null;\n    }\n\n    return null;\n  };\n\n  var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {\n    var info = {\n      source: null,\n      name: null,\n      size: null\n    };\n    var rows = headers.split('\\n');\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = rows[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var header = _step.value;\n        var name = getFileNameFromHeader(header);\n\n        if (name) {\n          info.name = name;\n          continue;\n        }\n\n        var size = getFileSizeFromHeader(header);\n\n        if (size) {\n          info.size = size;\n          continue;\n        }\n\n        var source = getTranfserIdFromHeader(header);\n\n        if (source) {\n          info.source = source;\n          continue;\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    return info;\n  };\n\n  var createFileLoader = function createFileLoader(fetchFn) {\n    var state = {\n      source: null,\n      complete: false,\n      progress: 0,\n      size: null,\n      timestamp: null,\n      duration: 0,\n      request: null\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress;\n    };\n\n    var abort = function abort() {\n      if (state.request && state.request.abort) {\n        state.request.abort();\n      }\n    }; // load source\n\n\n    var load = function load() {\n      // get quick reference\n      var source = state.source;\n      api.fire('init', source); // Load Files\n\n      if (source instanceof File) {\n        api.fire('load', source);\n      } else if (source instanceof Blob) {\n        // Load blobs, set default name to current date\n        api.fire('load', getFileFromBlob(source, source.name));\n      } else if (isBase64DataURI(source)) {\n        // Load base 64, set default name to current date\n        api.fire('load', getFileFromBase64DataURI(source));\n      } else {\n        // Deal as if is external URL, let's load it!\n        loadURL(source);\n      }\n    }; // loads a url\n\n\n    var loadURL = function loadURL(url) {\n      // is remote url and no fetch method supplied\n      if (!fetchFn) {\n        api.fire('error', {\n          type: 'error',\n          body: \"Can't load URL\",\n          code: 400\n        });\n        return;\n      } // set request start\n\n\n      state.timestamp = Date.now(); // load file\n\n      state.request = fetchFn(url, function (response) {\n        // update duration\n        state.duration = Date.now() - state.timestamp; // done!\n\n        state.complete = true; // turn blob response into a file\n\n        if (response instanceof Blob) {\n          response = getFileFromBlob(response, response.name || getFilenameFromURL(url));\n        }\n\n        api.fire('load', // if has received blob, we go with blob, if no response, we return null\n        response instanceof Blob ? response : response ? response.body : null);\n      }, function (error) {\n        api.fire('error', typeof error === 'string' ? {\n          type: 'error',\n          code: 0,\n          body: error\n        } : error);\n      }, function (computable, current, total) {\n        // collected some meta data already\n        if (total) {\n          state.size = total;\n        } // update duration\n\n\n        state.duration = Date.now() - state.timestamp; // if we can't compute progress, we're not going to fire progress events\n\n        if (!computable) {\n          state.progress = null;\n          return;\n        } // update progress percentage\n\n\n        state.progress = current / total; // expose\n\n        api.fire('progress', state.progress);\n      }, function () {\n        api.fire('abort');\n      }, function (response) {\n        var fileinfo = getFileInfoFromHeaders(typeof response === 'string' ? response : response.headers);\n        api.fire('meta', {\n          size: state.size || fileinfo.size,\n          filename: fileinfo.name,\n          source: fileinfo.source\n        });\n      });\n    };\n\n    var api = Object.assign({}, on(), {\n      setSource: function setSource(source) {\n        return state.source = source;\n      },\n      getProgress: getProgress,\n      // file load progress\n      abort: abort,\n      // abort file load\n      load: load // start load\n\n    });\n    return api;\n  };\n\n  var isGet = function isGet(method) {\n    return /GET|HEAD/.test(method);\n  };\n\n  var sendRequest = function sendRequest(data, url, options) {\n    var api = {\n      onheaders: function onheaders() {},\n      onprogress: function onprogress() {},\n      onload: function onload() {},\n      ontimeout: function ontimeout() {},\n      onerror: function onerror() {},\n      onabort: function onabort() {},\n      abort: function abort() {\n        aborted = true;\n        xhr.abort();\n      }\n    }; // timeout identifier, only used when timeout is defined\n\n    var aborted = false;\n    var headersReceived = false; // set default options\n\n    options = Object.assign({\n      method: 'POST',\n      headers: {},\n      withCredentials: false\n    }, options); // encode url\n\n    url = encodeURI(url); // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n      url = '' + url + encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data));\n    } // create request\n\n\n    var xhr = new XMLHttpRequest(); // progress of load\n\n    var process = isGet(options.method) ? xhr : xhr.upload;\n\n    process.onprogress = function (e) {\n      // no progress event when aborted ( onprogress is called once after abort() )\n      if (aborted) {\n        return;\n      }\n\n      api.onprogress(e.lengthComputable, e.loaded, e.total);\n    }; // tries to get header info to the app as fast as possible\n\n\n    xhr.onreadystatechange = function () {\n      // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n      if (xhr.readyState < 2) {\n        return;\n      } // no server response\n\n\n      if (xhr.readyState === 4 && xhr.status === 0) {\n        return;\n      }\n\n      if (headersReceived) {\n        return;\n      }\n\n      headersReceived = true; // we've probably received some useful data in response headers\n\n      api.onheaders(xhr);\n    }; // load successful\n\n\n    xhr.onload = function () {\n      // is classified as valid response\n      if (xhr.status >= 200 && xhr.status < 300) {\n        api.onload(xhr);\n      } else {\n        api.onerror(xhr);\n      }\n    }; // error during load\n\n\n    xhr.onerror = function () {\n      return api.onerror(xhr);\n    }; // request aborted\n\n\n    xhr.onabort = function () {\n      aborted = true;\n      api.onabort();\n    }; // request timeout\n\n\n    xhr.ontimeout = function () {\n      return api.ontimeout(xhr);\n    }; // open up open up!\n\n\n    xhr.open(options.method, url, true); // set timeout if defined (do it after open so IE11 plays ball)\n\n    if (isInt(options.timeout)) {\n      xhr.timeout = options.timeout;\n    } // add headers\n\n\n    Object.keys(options.headers).forEach(function (key) {\n      var value = unescape(encodeURIComponent(options.headers[key]));\n      xhr.setRequestHeader(key, value);\n    }); // set type of response\n\n    if (options.responseType) {\n      xhr.responseType = options.responseType;\n    } // set credentials\n\n\n    if (options.withCredentials) {\n      xhr.withCredentials = true;\n    } // let's send our data\n\n\n    xhr.send(data);\n    return api;\n  };\n\n  var createResponse = function createResponse(type, code, body, headers) {\n    return {\n      type: type,\n      code: code,\n      body: body,\n      headers: headers\n    };\n  };\n\n  var createTimeoutResponse = function createTimeoutResponse(cb) {\n    return function (xhr) {\n      cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n    };\n  };\n\n  var hasQS = function hasQS(str) {\n    return /\\?/.test(str);\n  };\n\n  var buildURL = function buildURL() {\n    var url = '';\n\n    for (var _len = arguments.length, parts = new Array(_len), _key = 0; _key < _len; _key++) {\n      parts[_key] = arguments[_key];\n    }\n\n    parts.forEach(function (part) {\n      url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\n    });\n    return url;\n  };\n\n  var createFetchFunction = function createFetchFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined; // custom handler (should also handle file, load, error, progress and abort)\n\n    if (typeof action === 'function') {\n      return action;\n    } // no action supplied\n\n\n    if (!action || !isString(action.url)) {\n      return null;\n    } // set onload hanlder\n\n\n    var onload = action.onload || function (res) {\n      return res;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // internal handler\n\n\n    return function (url, load, error, progress, abort, headers) {\n      // do local or remote request based on if the url is external\n      var request = sendRequest(url, buildURL(apiUrl, action.url), Object.assign({}, action, {\n        responseType: 'blob'\n      }));\n\n      request.onload = function (xhr) {\n        // get headers\n        var headers = xhr.getAllResponseHeaders(); // get filename\n\n        var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url); // create response\n\n        load(createResponse('load', xhr.status, action.method === 'HEAD' ? null : getFileFromBlob(onload(xhr.response), filename), headers));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.onheaders = function (xhr) {\n        headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort; // should return request\n\n      return request;\n    };\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol['for'] && Symbol['for']('react.element') || 0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol !== 'undefined') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n          if (wrappedAwait) {\n            resume('next', arg);\n            return;\n          }\n\n          settle(result.done ? 'return' : 'normal', arg);\n        }, function (err) {\n          resume('throw', err);\n        });\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function () {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n        waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function (resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function () {\n        return this;\n      };\n    }\n\n    iter.next = function (value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function (value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function (value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function () {\n      var self = this,\n          args = arguments;\n      return new Promise(function (resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends = Object.assign || function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n\n      return target;\n    };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n        }));\n      }\n\n      ownKeys.forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(source, true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(source).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError('Super expression must either be null or a function');\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n      return !!right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(Object.defineProperties(strings, {\n      raw: {\n        value: Object.freeze(raw)\n      }\n    }));\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === '[object Arguments]') return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function () {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and set to use loose mode. ' + 'To use proposal-class-properties in spec mode with decorators, wait for ' + 'the next major version of decorators in stage 2.');\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer ? descriptor.initializer.call(context) : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function (key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n      return decorator(target, property, desc) || desc;\n    }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classPrivateFieldDestructureSet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      if (!('__destrObj' in descriptor)) {\n        descriptor.__destrObj = {\n          set value(v) {\n            descriptor.set.call(receiver, v);\n          }\n\n        };\n      }\n\n      return descriptor.__destrObj;\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      return descriptor;\n    }\n  }\n\n  function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function () {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function (O, elements) {\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function (F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            var placement = element.placement;\n\n            if (element.kind === kind && (placement === 'static' || placement === 'prototype')) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function (receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function (elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function (element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function (element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(element, placements);\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function (element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function (element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function (elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {\n                  throw new TypeError('Duplicated element (' + elements[j].key + ')');\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function (element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function (elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function (elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n          this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function (elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError('An element descriptor\\'s .kind property must be either \"method\" or' + ' \"field\", but a decorator created an element descriptor with' + ' .kind \"' + kind + '\"');\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n          throw new TypeError('An element descriptor\\'s .placement property must be one of \"static\",' + ' \"prototype\" or \"own\", but a decorator created an element descriptor' + ' with .placement \"' + placement + '\"');\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n        } else {\n          this.disallowProperty(descriptor, 'get', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'set', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'value', 'The property descriptor of a field descriptor');\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function (elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function (elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function (obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError('A class descriptor\\'s .kind property must be \"class\", but a decorator' + ' created a class descriptor with .kind \"' + kind + '\"');\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function (constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function (obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function (other) {\n      return other.kind === 'method' && other.key === element.key && other.placement === element.placement;\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n        if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError('Duplicated methods (' + element.key + \") can't be decorated.\");\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\"Decorators can't be placed on different accessors with for \" + 'the same property (' + element.key + ').');\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function (re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function (str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function (str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) {\n          return '$' + groups[name];\n        }));\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function () {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function (groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4\n  };\n  /*\n                                                       function signature:\n                                                         (file, metadata, load, error, progress, abort, transfer, options) => {\n                                                           return {\n                                                           abort:() => {}\n                                                         }\n                                                       }\n                                                       */\n  // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\n\n  var processFileChunked = function processFileChunked(apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options) {\n    // all chunks\n    var chunks = [];\n    var chunkTransferId = options.chunkTransferId,\n        chunkServer = options.chunkServer,\n        chunkSize = options.chunkSize,\n        chunkRetryDelays = options.chunkRetryDelays; // default state\n\n    var state = {\n      serverId: chunkTransferId,\n      aborted: false\n    }; // set onload handlers\n\n    var ondata = action.ondata || function (fd) {\n      return fd;\n    };\n\n    var onload = action.onload || function (xhr, method) {\n      return method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // create server hook\n\n\n    var requestTransferId = function requestTransferId(cb) {\n      var formData = new FormData(); // add metadata under same name\n\n      if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n      var headers = typeof action.headers === 'function' ? action.headers(file, metadata) : Object.assign({}, action.headers, {\n        'Upload-Length': file.size\n      });\n      var requestParams = Object.assign({}, action, {\n        headers: headers\n      }); // send request object\n\n      var request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\n\n      request.onload = function (xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function (xhr) {\n        return error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    var requestTransferOffset = function requestTransferOffset(cb) {\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n      var headers = typeof action.headers === 'function' ? action.headers(state.serverId) : Object.assign({}, action.headers);\n      var requestParams = {\n        headers: headers,\n        method: 'HEAD'\n      };\n      var request = sendRequest(null, requestUrl, requestParams);\n\n      request.onload = function (xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function (xhr) {\n        return error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    }; // create chunks\n\n\n    var lastChunkIndex = Math.floor(file.size / chunkSize);\n\n    for (var i = 0; i <= lastChunkIndex; i++) {\n      var offset = i * chunkSize;\n      var data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');\n      chunks[i] = {\n        index: i,\n        size: data.size,\n        offset: offset,\n        data: data,\n        file: file,\n        progress: 0,\n        retries: _toConsumableArray(chunkRetryDelays),\n        status: ChunkStatus.QUEUED,\n        error: null,\n        request: null,\n        timeout: null\n      };\n    }\n\n    var completeProcessingChunks = function completeProcessingChunks() {\n      return load(state.serverId);\n    };\n\n    var canProcessChunk = function canProcessChunk(chunk) {\n      return chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;\n    };\n\n    var processChunk = function processChunk(chunk) {\n      // processing is paused, wait here\n      if (state.aborted) return; // get next chunk to process\n\n      chunk = chunk || chunks.find(canProcessChunk); // no more chunks to process\n\n      if (!chunk) {\n        // all done?\n        if (chunks.every(function (chunk) {\n          return chunk.status === ChunkStatus.COMPLETE;\n        })) {\n          completeProcessingChunks();\n        } // no chunk to handle\n\n\n        return;\n      } // now processing this chunk\n\n\n      chunk.status = ChunkStatus.PROCESSING;\n      chunk.progress = null; // allow parsing of formdata\n\n      var ondata = chunkServer.ondata || function (fd) {\n        return fd;\n      };\n\n      var onerror = chunkServer.onerror || function (res) {\n        return null;\n      }; // send request object\n\n\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n      var headers = typeof chunkServer.headers === 'function' ? chunkServer.headers(chunk) : Object.assign({}, chunkServer.headers, {\n        'Content-Type': 'application/offset+octet-stream',\n        'Upload-Offset': chunk.offset,\n        'Upload-Length': file.size,\n        'Upload-Name': file.name\n      });\n      var request = chunk.request = sendRequest(ondata(chunk.data), requestUrl, Object.assign({}, chunkServer, {\n        headers: headers\n      }));\n\n      request.onload = function () {\n        // done!\n        chunk.status = ChunkStatus.COMPLETE; // remove request reference\n\n        chunk.request = null; // start processing more chunks\n\n        processChunks();\n      };\n\n      request.onprogress = function (lengthComputable, loaded, total) {\n        chunk.progress = lengthComputable ? loaded : null;\n        updateTotalProgress();\n      };\n\n      request.onerror = function (xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        chunk.error = onerror(xhr.response) || xhr.statusText;\n\n        if (!retryProcessChunk(chunk)) {\n          error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n        }\n      };\n\n      request.ontimeout = function (xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n\n        if (!retryProcessChunk(chunk)) {\n          createTimeoutResponse(error)(xhr);\n        }\n      };\n\n      request.onabort = function () {\n        chunk.status = ChunkStatus.QUEUED;\n        chunk.request = null;\n        abort();\n      };\n    };\n\n    var retryProcessChunk = function retryProcessChunk(chunk) {\n      // no more retries left\n      if (chunk.retries.length === 0) return false; // new retry\n\n      chunk.status = ChunkStatus.WAITING;\n      clearTimeout(chunk.timeout);\n      chunk.timeout = setTimeout(function () {\n        processChunk(chunk);\n      }, chunk.retries.shift()); // we're going to retry\n\n      return true;\n    };\n\n    var updateTotalProgress = function updateTotalProgress() {\n      // calculate total progress fraction\n      var totalBytesTransfered = chunks.reduce(function (p, chunk) {\n        if (p === null || chunk.progress === null) return null;\n        return p + chunk.progress;\n      }, 0); // can't compute progress\n\n      if (totalBytesTransfered === null) return progress(false, 0, 0); // calculate progress values\n\n      var totalSize = chunks.reduce(function (total, chunk) {\n        return total + chunk.size;\n      }, 0); // can update progress indicator\n\n      progress(true, totalBytesTransfered, totalSize);\n    }; // process new chunks\n\n\n    var processChunks = function processChunks() {\n      var totalProcessing = chunks.filter(function (chunk) {\n        return chunk.status === ChunkStatus.PROCESSING;\n      }).length;\n      if (totalProcessing >= 1) return;\n      processChunk();\n    };\n\n    var abortChunks = function abortChunks() {\n      chunks.forEach(function (chunk) {\n        clearTimeout(chunk.timeout);\n\n        if (chunk.request) {\n          chunk.request.abort();\n        }\n      });\n    }; // let's go!\n\n\n    if (!state.serverId) {\n      requestTransferId(function (serverId) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return; // pass back to item so we can use it if something goes wrong\n\n        transfer(serverId); // store internally\n\n        state.serverId = serverId;\n        processChunks();\n      });\n    } else {\n      requestTransferOffset(function (offset) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return; // mark chunks with lower offset as complete\n\n        chunks.filter(function (chunk) {\n          return chunk.offset < offset;\n        }).forEach(function (chunk) {\n          chunk.status = ChunkStatus.COMPLETE;\n          chunk.progress = chunk.size;\n        }); // continue processing\n\n        processChunks();\n      });\n    }\n\n    return {\n      abort: function abort() {\n        state.aborted = true;\n        abortChunks();\n      }\n    };\n  };\n  /*\n                                                               function signature:\n                                                                 (file, metadata, load, error, progress, abort) => {\n                                                                   return {\n                                                                   abort:() => {}\n                                                                 }\n                                                               }\n                                                               */\n\n\n  var createFileProcessorFunction = function createFileProcessorFunction(apiUrl, action, name, options) {\n    return function (file, metadata, load, error, progress, abort, transfer) {\n      // no file received\n      if (!file) return; // if was passed a file, and we can chunk it, exit here\n\n      var canChunkUpload = options.chunkUploads;\n      var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n      var willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);\n      if (file instanceof Blob && willChunkUpload) return processFileChunked(apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options); // set handlers\n\n      var ondata = action.ondata || function (fd) {\n        return fd;\n      };\n\n      var onload = action.onload || function (res) {\n        return res;\n      };\n\n      var onerror = action.onerror || function (res) {\n        return null;\n      }; // create formdata object\n\n\n      var formData = new FormData(); // add metadata under same name\n\n      if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n      } // Turn into an array of objects so no matter what the input, we can handle it the same way\n\n\n      (file instanceof Blob ? [{\n        name: null,\n        file: file\n      }] : file).forEach(function (item) {\n        formData.append(name, item.file, item.name === null ? item.file.name : '' + item.name + item.file.name);\n      }); // send request object\n\n      var request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), action);\n\n      request.onload = function (xhr) {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort; // should return request\n\n      return request;\n    };\n  };\n\n  var createProcessorFunction = function createProcessorFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    var name = arguments.length > 2 ? arguments[2] : undefined;\n    var options = arguments.length > 3 ? arguments[3] : undefined; // custom handler (should also handle file, load, error, progress and abort)\n\n    if (typeof action === 'function') return function () {\n      for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n        params[_key] = arguments[_key];\n      }\n\n      return action.apply(void 0, [name].concat(params, [options]));\n    }; // no action supplied\n\n    if (!action || !isString(action.url)) return null; // internal handler\n\n    return createFileProcessorFunction(apiUrl, action, name, options);\n  };\n  /*\n                                                      function signature:\n                                                      (uniqueFileId, load, error) => { }\n                                                      */\n\n\n  var createRevertFunction = function createRevertFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined; // is custom implementation\n\n    if (typeof action === 'function') {\n      return action;\n    } // no action supplied, return stub function, interface will work, but file won't be removed\n\n\n    if (!action || !isString(action.url)) {\n      return function (uniqueFileId, load) {\n        return load();\n      };\n    } // set onload hanlder\n\n\n    var onload = action.onload || function (res) {\n      return res;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // internal implementation\n\n\n    return function (uniqueFileId, load, error) {\n      var request = sendRequest(uniqueFileId, apiUrl + action.url, action // contains method, headers and withCredentials properties\n      );\n\n      request.onload = function (xhr) {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      return request;\n    };\n  };\n\n  var getRandomNumber = function getRandomNumber() {\n    var min = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var max = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return min + Math.random() * (max - min);\n  };\n\n  var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(cb) {\n    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var tickMin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;\n    var tickMax = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n    var timeout = null;\n    var start = Date.now();\n\n    var tick = function tick() {\n      var runtime = Date.now() - start;\n      var delay = getRandomNumber(tickMin, tickMax);\n\n      if (runtime + delay > duration) {\n        delay = runtime + delay - duration;\n      }\n\n      var progress = runtime / duration;\n\n      if (progress >= 1 || document.hidden) {\n        cb(1);\n        return;\n      }\n\n      cb(progress);\n      timeout = setTimeout(tick, delay);\n    };\n\n    tick();\n    return {\n      clear: function clear() {\n        clearTimeout(timeout);\n      }\n    };\n  };\n\n  var createFileProcessor = function createFileProcessor(processFn) {\n    var state = {\n      complete: false,\n      perceivedProgress: 0,\n      perceivedPerformanceUpdater: null,\n      progress: null,\n      timestamp: null,\n      perceivedDuration: 0,\n      duration: 0,\n      request: null,\n      response: null\n    };\n\n    var process = function process(file, metadata) {\n      var progressFn = function progressFn() {\n        // we've not yet started the real download, stop here\n        // the request might not go through, for instance, there might be some server trouble\n        // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n        if (state.duration === 0 || state.progress === null) {\n          return;\n        } // as we're now processing, fire the progress event\n\n\n        api.fire('progress', api.getProgress());\n      };\n\n      var completeFn = function completeFn() {\n        state.complete = true;\n        api.fire('load-perceived', state.response.body);\n      }; // let's start processing\n\n\n      api.fire('start'); // set request start\n\n      state.timestamp = Date.now(); // create perceived performance progress indicator\n\n      state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(function (progress) {\n        state.perceivedProgress = progress;\n        state.perceivedDuration = Date.now() - state.timestamp;\n        progressFn(); // if fake progress is done, and a response has been received,\n        // and we've not yet called the complete method\n\n        if (state.response && state.perceivedProgress === 1 && !state.complete) {\n          // we done!\n          completeFn();\n        }\n      }, // random delay as in a list of files you start noticing\n      // files uploading at the exact same speed\n      getRandomNumber(750, 1500)); // remember request so we can abort it later\n\n      state.request = processFn( // the file to process\n      file, // the metadata to send along\n      metadata, // callbacks (load, error, progress, abort, transfer)\n      // load expects the body to be a server id if\n      // you want to make use of revert\n      function (response) {\n        // we put the response in state so we can access\n        // it outside of this method\n        state.response = isObject(response) ? response : {\n          type: 'load',\n          code: 200,\n          body: '' + response,\n          headers: {}\n        }; // update duration\n\n        state.duration = Date.now() - state.timestamp; // force progress to 1 as we're now done\n\n        state.progress = 1; // actual load is done let's share results\n\n        api.fire('load', state.response.body); // we are really done\n        // if perceived progress is 1 ( wait for perceived progress to complete )\n        // or if server does not support progress ( null )\n\n        if (state.perceivedProgress === 1) {\n          completeFn();\n        }\n      }, // error is expected to be an object with type, code, body\n      function (error) {\n        // cancel updater\n        state.perceivedPerformanceUpdater.clear(); // update others about this error\n\n        api.fire('error', isObject(error) ? error : {\n          type: 'error',\n          code: 0,\n          body: '' + error\n        });\n      }, // actual processing progress\n      function (computable, current, total) {\n        // update actual duration\n        state.duration = Date.now() - state.timestamp; // update actual progress\n\n        state.progress = computable ? current / total : null;\n        progressFn();\n      }, // abort does not expect a value\n      function () {\n        // stop updater\n        state.perceivedPerformanceUpdater.clear(); // fire the abort event so we can switch visuals\n\n        api.fire('abort', state.response ? state.response.body : null);\n      }, // register the id for this transfer\n      function (transferId) {\n        api.fire('transfer', transferId);\n      });\n    };\n\n    var abort = function abort() {\n      // no request running, can't abort\n      if (!state.request) return; // stop updater\n\n      state.perceivedPerformanceUpdater.clear(); // abort actual request\n\n      state.request.abort(); // if has response object, we've completed the request\n\n      state.complete = true;\n    };\n\n    var reset = function reset() {\n      abort();\n      state.complete = false;\n      state.perceivedProgress = 0;\n      state.progress = 0;\n      state.timestamp = null;\n      state.perceivedDuration = 0;\n      state.duration = 0;\n      state.request = null;\n      state.response = null;\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress ? Math.min(state.progress, state.perceivedProgress) : null;\n    };\n\n    var getDuration = function getDuration() {\n      return Math.min(state.duration, state.perceivedDuration);\n    };\n\n    var api = Object.assign({}, on(), {\n      process: process,\n      // start processing file\n      abort: abort,\n      // abort active process request\n      getProgress: getProgress,\n      getDuration: getDuration,\n      reset: reset\n    });\n    return api;\n  };\n\n  var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n    return name.substr(0, name.lastIndexOf('.')) || name;\n  };\n\n  var createFileStub = function createFileStub(source) {\n    var data = [source.name, source.size, source.type]; // is blob or base64, then we need to set the name\n\n    if (source instanceof Blob || isBase64DataURI(source)) {\n      data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n      // if is base64 data uri we need to determine the average size and type\n      data[1] = source.length;\n      data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n      // url\n      data[0] = getFilenameFromURL(source);\n      data[1] = 0;\n      data[2] = 'application/octet-stream';\n    }\n\n    return {\n      name: data[0],\n      size: data[1],\n      type: data[2]\n    };\n  };\n\n  var isFile = function isFile(value) {\n    return !!(value instanceof File || value instanceof Blob && value.name);\n  };\n\n  var deepCloneObject = function deepCloneObject(src) {\n    if (!isObject(src)) return src;\n    var target = isArray(src) ? [] : {};\n\n    for (var key in src) {\n      if (!src.hasOwnProperty(key)) continue;\n      var v = src[key];\n      target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n\n    return target;\n  };\n\n  var createItem = function createItem() {\n    var origin = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var serverFileReference = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var file = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null; // unique id for this item, is used to identify the item across views\n\n    var id = getUniqueId();\n    /**\n     * Internal item state\n     */\n\n    var state = {\n      // is archived\n      archived: false,\n      // if is frozen, no longer fires events\n      frozen: false,\n      // removed from view\n      released: false,\n      // original source\n      source: null,\n      // file model reference\n      file: file,\n      // id of file on server\n      serverFileReference: serverFileReference,\n      // id of file transfer on server\n      transferId: null,\n      // is aborted\n      processingAborted: false,\n      // current item status\n      status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,\n      // active processes\n      activeLoader: null,\n      activeProcessor: null\n    }; // callback used when abort processing is called to link back to the resolve method\n\n    var abortProcessingRequestComplete = null;\n    /**\n     * Externally added item metadata\n     */\n\n    var metadata = {}; // item data\n\n    var setStatus = function setStatus(status) {\n      return state.status = status;\n    }; // fire event unless the item has been archived\n\n\n    var fire = function fire(event) {\n      if (state.released || state.frozen) return;\n\n      for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        params[_key - 1] = arguments[_key];\n      }\n\n      api.fire.apply(api, [event].concat(params));\n    }; // file data\n\n\n    var getFileExtension = function getFileExtension() {\n      return getExtensionFromFilename(state.file.name);\n    };\n\n    var getFileType = function getFileType() {\n      return state.file.type;\n    };\n\n    var getFileSize = function getFileSize() {\n      return state.file.size;\n    };\n\n    var getFile = function getFile() {\n      return state.file;\n    }; //\n    // logic to load a file\n    //\n\n\n    var load = function load(source, loader, onload) {\n      // remember the original item source\n      state.source = source; // file stub is already there\n\n      if (state.file) {\n        fire('load-skip');\n        return;\n      } // set a stub file object while loading the actual data\n\n\n      state.file = createFileStub(source); // starts loading\n\n      loader.on('init', function () {\n        fire('load-init');\n      }); // we'eve received a size indication, let's update the stub\n\n      loader.on('meta', function (meta) {\n        // set size of file stub\n        state.file.size = meta.size; // set name of file stub\n\n        state.file.filename = meta.filename; // if has received source, we done\n\n        if (meta.source) {\n          origin = FileOrigin.LIMBO;\n          state.serverFileReference = meta.source;\n          state.status = ItemStatus.PROCESSING_COMPLETE;\n        } // size has been updated\n\n\n        fire('load-meta');\n      }); // the file is now loading we need to update the progress indicators\n\n      loader.on('progress', function (progress) {\n        setStatus(ItemStatus.LOADING);\n        fire('load-progress', progress);\n      }); // an error was thrown while loading the file, we need to switch to error state\n\n      loader.on('error', function (error) {\n        setStatus(ItemStatus.LOAD_ERROR);\n        fire('load-request-error', error);\n      }); // user or another process aborted the file load (cannot retry)\n\n      loader.on('abort', function () {\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n      }); // done loading\n\n      loader.on('load', function (file) {\n        // as we've now loaded the file the loader is no longer required\n        state.activeLoader = null; // called when file has loaded succesfully\n\n        var success = function success(result) {\n          // set (possibly) transformed file\n          state.file = isFile(result) ? result : state.file; // file received\n\n          if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n          } else {\n            setStatus(ItemStatus.IDLE);\n          }\n\n          fire('load');\n        };\n\n        var error = function error(result) {\n          // set original file\n          state.file = file;\n          fire('load-meta');\n          setStatus(ItemStatus.LOAD_ERROR);\n          fire('load-file-error', result);\n        }; // if we already have a server file reference, we don't need to call the onload method\n\n\n        if (state.serverFileReference) {\n          success(file);\n          return;\n        } // no server id, let's give this file the full treatment\n\n\n        onload(file, success, error);\n      }); // set loader source data\n\n      loader.setSource(source); // set as active loader\n\n      state.activeLoader = loader; // load the source data\n\n      loader.load();\n    };\n\n    var retryLoad = function retryLoad() {\n      if (!state.activeLoader) {\n        return;\n      }\n\n      state.activeLoader.load();\n    };\n\n    var abortLoad = function abortLoad() {\n      if (state.activeLoader) {\n        state.activeLoader.abort();\n        return;\n      }\n\n      setStatus(ItemStatus.INIT);\n      fire('load-abort');\n    }; //\n    // logic to process a file\n    //\n\n\n    var process = function process(processor, onprocess) {\n      // processing was aborted\n      if (state.processingAborted) {\n        state.processingAborted = false;\n        return;\n      } // now processing\n\n\n      setStatus(ItemStatus.PROCESSING); // reset abort callback\n\n      abortProcessingRequestComplete = null; // if no file loaded we'll wait for the load event\n\n      if (!(state.file instanceof Blob)) {\n        api.on('load', function () {\n          process(processor, onprocess);\n        });\n        return;\n      } // setup processor\n\n\n      processor.on('load', function (serverFileReference) {\n        // need this id to be able to revert the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n      }); // register transfer id\n\n      processor.on('transfer', function (transferId) {\n        // need this id to be able to revert the upload\n        state.transferId = transferId;\n      });\n      processor.on('load-perceived', function (serverFileReference) {\n        // no longer required\n        state.activeProcessor = null; // need this id to be able to rever the upload\n\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n        setStatus(ItemStatus.PROCESSING_COMPLETE);\n        fire('process-complete', serverFileReference);\n      });\n      processor.on('start', function () {\n        fire('process-start');\n      });\n      processor.on('error', function (error) {\n        state.activeProcessor = null;\n        setStatus(ItemStatus.PROCESSING_ERROR);\n        fire('process-error', error);\n      });\n      processor.on('abort', function (serverFileReference) {\n        state.activeProcessor = null; // if file was uploaded but processing was cancelled during perceived processor time store file reference\n\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n        setStatus(ItemStatus.IDLE);\n        fire('process-abort'); // has timeout so doesn't interfere with remove action\n\n        if (abortProcessingRequestComplete) {\n          abortProcessingRequestComplete();\n        }\n      });\n      processor.on('progress', function (progress) {\n        fire('process-progress', progress);\n      }); // when successfully transformed\n\n      var success = function success(file) {\n        // if was archived in the mean time, don't process\n        if (state.archived) return; // process file!\n\n        processor.process(file, Object.assign({}, metadata));\n      }; // something went wrong during transform phase\n\n\n      var error = console.error; // start processing the file\n\n      onprocess(state.file, success, error); // set as active processor\n\n      state.activeProcessor = processor;\n    };\n\n    var requestProcessing = function requestProcessing() {\n      state.processingAborted = false;\n      setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n\n    var abortProcessing = function abortProcessing() {\n      return new Promise(function (resolve) {\n        if (!state.activeProcessor) {\n          state.processingAborted = true;\n          setStatus(ItemStatus.IDLE);\n          fire('process-abort');\n          resolve();\n          return;\n        }\n\n        abortProcessingRequestComplete = function abortProcessingRequestComplete() {\n          resolve();\n        };\n\n        state.activeProcessor.abort();\n      });\n    }; //\n    // logic to revert a processed file\n    //\n\n\n    var revert = function revert(revertFileUpload, forceRevert) {\n      return new Promise(function (resolve, reject) {\n        // cannot revert without a server id for this process\n        if (state.serverFileReference === null) {\n          resolve();\n          return;\n        } // revert the upload (fire and forget)\n\n\n        revertFileUpload(state.serverFileReference, function () {\n          // reset file server id as now it's no available on the server\n          state.serverFileReference = null;\n          resolve();\n        }, function (error) {\n          // don't set error state when reverting is optional, it will always resolve\n          if (!forceRevert) {\n            resolve();\n            return;\n          } // oh no errors\n\n\n          setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n          fire('process-revert-error');\n          reject(error);\n        }); // fire event\n\n        setStatus(ItemStatus.IDLE);\n        fire('process-revert');\n      });\n    }; // exposed methods\n\n\n    var _setMetadata = function setMetadata(key, value, silent) {\n      var keys = key.split('.');\n      var root = keys[0];\n      var last = keys.pop();\n      var data = metadata;\n      keys.forEach(function (key) {\n        return data = data[key];\n      }); // compare old value against new value, if they're the same, we're not updating\n\n      if (JSON.stringify(data[last]) === JSON.stringify(value)) return; // update value\n\n      data[last] = value; // don't fire update\n\n      if (silent) return; // fire update\n\n      fire('metadata-update', {\n        key: root,\n        value: metadata[root]\n      });\n    };\n\n    var getMetadata = function getMetadata(key) {\n      return deepCloneObject(key ? metadata[key] : metadata);\n    };\n\n    var api = Object.assign({\n      id: {\n        get: function get() {\n          return id;\n        }\n      },\n      origin: {\n        get: function get() {\n          return origin;\n        }\n      },\n      serverId: {\n        get: function get() {\n          return state.serverFileReference;\n        }\n      },\n      transferId: {\n        get: function get() {\n          return state.transferId;\n        }\n      },\n      status: {\n        get: function get() {\n          return state.status;\n        }\n      },\n      filename: {\n        get: function get() {\n          return state.file.name;\n        }\n      },\n      filenameWithoutExtension: {\n        get: function get() {\n          return getFilenameWithoutExtension(state.file.name);\n        }\n      },\n      fileExtension: {\n        get: getFileExtension\n      },\n      fileType: {\n        get: getFileType\n      },\n      fileSize: {\n        get: getFileSize\n      },\n      file: {\n        get: getFile\n      },\n      relativePath: {\n        get: function get() {\n          return state.file._relativePath;\n        }\n      },\n      source: {\n        get: function get() {\n          return state.source;\n        }\n      },\n      getMetadata: getMetadata,\n      setMetadata: function setMetadata(key, value, silent) {\n        if (isObject(key)) {\n          var data = key;\n          Object.keys(data).forEach(function (key) {\n            _setMetadata(key, data[key], value);\n          });\n          return key;\n        }\n\n        _setMetadata(key, value, silent);\n\n        return value;\n      },\n      extend: function extend(name, handler) {\n        return itemAPI[name] = handler;\n      },\n      abortLoad: abortLoad,\n      retryLoad: retryLoad,\n      requestProcessing: requestProcessing,\n      abortProcessing: abortProcessing,\n      load: load,\n      process: process,\n      revert: revert\n    }, on(), {\n      freeze: function freeze() {\n        return state.frozen = true;\n      },\n      release: function release() {\n        return state.released = true;\n      },\n      released: {\n        get: function get() {\n          return state.released;\n        }\n      },\n      archive: function archive() {\n        return state.archived = true;\n      },\n      archived: {\n        get: function get() {\n          return state.archived;\n        }\n      }\n    }); // create it here instead of returning it instantly so we can extend it later\n\n    var itemAPI = createObject(api);\n    return itemAPI;\n  };\n\n  var getItemIndexByQuery = function getItemIndexByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return 0;\n    } // invalid queries\n\n\n    if (!isString(query)) {\n      return -1;\n    } // return item by id (or -1 if not found)\n\n\n    return items.findIndex(function (item) {\n      return item.id === query;\n    });\n  };\n\n  var getItemById = function getItemById(items, itemId) {\n    var index = getItemIndexByQuery(items, itemId);\n\n    if (index < 0) {\n      return;\n    }\n\n    return items[index] || null;\n  };\n\n  var fetchLocal = function fetchLocal(url, load, error, progress, abort, headers) {\n    var request = sendRequest(null, url, {\n      method: 'GET',\n      responseType: 'blob'\n    });\n\n    request.onload = function (xhr) {\n      // get headers\n      var headers = xhr.getAllResponseHeaders(); // get filename\n\n      var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url); // create response\n\n      load(createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers));\n    };\n\n    request.onerror = function (xhr) {\n      error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));\n    };\n\n    request.onheaders = function (xhr) {\n      headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort; // should return request\n\n    return request;\n  };\n\n  var getDomainFromURL = function getDomainFromURL(url) {\n    if (url.indexOf('//') === 0) {\n      url = location.protocol + url;\n    }\n\n    return url.toLowerCase().replace('blob:', '').replace(/([a-z])?:\\/\\//, '$1').split('/')[0];\n  };\n\n  var isExternalURL = function isExternalURL(url) {\n    return (url.indexOf(':') > -1 || url.indexOf('//') > -1) && getDomainFromURL(location.href) !== getDomainFromURL(url);\n  };\n\n  var dynamicLabel = function dynamicLabel(label) {\n    return function () {\n      return isFunction(label) ? label.apply(void 0, arguments) : label;\n    };\n  };\n\n  var isMockItem = function isMockItem(item) {\n    return !isFile(item.file);\n  };\n\n  var listUpdated = function listUpdated(dispatch, state) {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(function () {\n      dispatch('DID_UPDATE_ITEMS', {\n        items: getActiveItems(state.items)\n      });\n    }, 0);\n  };\n\n  var optionalPromise = function optionalPromise(fn) {\n    for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      params[_key - 1] = arguments[_key];\n    }\n\n    return new Promise(function (resolve) {\n      if (!fn) {\n        return resolve(true);\n      }\n\n      var result = fn.apply(void 0, params);\n\n      if (result == null) {\n        return resolve(true);\n      }\n\n      if (typeof result === 'boolean') {\n        return resolve(result);\n      }\n\n      if (typeof result.then === 'function') {\n        result.then(resolve);\n      }\n    });\n  };\n\n  var sortItems = function sortItems(state, compare) {\n    state.items.sort(function (a, b) {\n      return compare(createItemAPI(a), createItemAPI(b));\n    });\n  }; // returns item based on state\n\n\n  var getItemByQueryFromState = function getItemByQueryFromState(state, itemHandler) {\n    return function () {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          query = _ref.query,\n          _ref$success = _ref.success,\n          success = _ref$success === void 0 ? function () {} : _ref$success,\n          _ref$failure = _ref.failure,\n          failure = _ref$failure === void 0 ? function () {} : _ref$failure;\n\n      var item = getItemByQuery(state.items, query);\n\n      if (!item) {\n        failure({\n          error: createResponse('error', 0, 'Item not found'),\n          file: null\n        });\n        return;\n      }\n\n      itemHandler(item, success, failure);\n    };\n  };\n\n  var actions = function actions(dispatch, query, state) {\n    return {\n      /**\n       * Aborts all ongoing processes\n       */\n      ABORT_ALL: function ABORT_ALL() {\n        getActiveItems(state.items).forEach(function (item) {\n          item.freeze();\n          item.abortLoad();\n          item.abortProcessing();\n        });\n      },\n\n      /**\n       * Sets initial files\n       */\n      DID_SET_FILES: function DID_SET_FILES(_ref2) {\n        var _ref2$value = _ref2.value,\n            value = _ref2$value === void 0 ? [] : _ref2$value; // map values to file objects\n\n        var files = value.map(function (file) {\n          return {\n            source: file.source ? file.source : file,\n            options: file.options\n          };\n        }); // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n\n        var activeItems = getActiveItems(state.items);\n        activeItems.forEach(function (item) {\n          // if item not is in new value, remove\n          if (!files.find(function (file) {\n            return file.source === item.source || file.source === item.file;\n          })) {\n            dispatch('REMOVE_ITEM', {\n              query: item\n            });\n          }\n        }); // add new files\n\n        activeItems = getActiveItems(state.items);\n        files.forEach(function (file, index) {\n          // if file is already in list\n          if (activeItems.find(function (item) {\n            return item.source === file.source || item.file === file.source;\n          })) return; // not in list, add\n\n          dispatch('ADD_ITEM', Object.assign({}, file, {\n            interactionMethod: InteractionMethod.NONE,\n            index: index\n          }));\n        });\n      },\n      DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {\n        var id = _ref3.id; // if is called multiple times in close succession we combined all calls together to save resources\n\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(function () {\n          var item = getItemById(state.items, id); // only revert and attempt to upload when we're uploading to a server\n\n          if (!query('IS_ASYNC')) {\n            // should we update the output data\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function (shouldPrepareOutput) {\n              if (!shouldPrepareOutput) {\n                return;\n              }\n\n              dispatch('REQUEST_PREPARE_OUTPUT', {\n                query: id,\n                item: item,\n                success: function success(file) {\n                  dispatch('DID_PREPARE_OUTPUT', {\n                    id: id,\n                    file: file\n                  });\n                }\n              }, true);\n            });\n            return;\n          } // for async scenarios\n\n\n          var upload = function upload() {\n            // we push this forward a bit so the interface is updated correctly\n            setTimeout(function () {\n              dispatch('REQUEST_ITEM_PROCESSING', {\n                query: id\n              });\n            }, 32);\n          };\n\n          var revert = function revert(doUpload) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(doUpload ? upload : function () {}).catch(function () {});\n          };\n\n          var abort = function abort(doUpload) {\n            item.abortProcessing().then(doUpload ? upload : function () {});\n          }; // if we should re-upload the file immidiately\n\n\n          if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n            return revert(state.options.instantUpload);\n          } // if currently uploading, cancel upload\n\n\n          if (item.status === ItemStatus.PROCESSING) {\n            return abort(state.options.instantUpload);\n          }\n\n          if (state.options.instantUpload) {\n            upload();\n          }\n        }, 0);\n      },\n      MOVE_ITEM: function MOVE_ITEM(_ref4) {\n        var query = _ref4.query,\n            index = _ref4.index;\n        var item = getItemByQuery(state.items, query);\n        if (!item) return;\n        var currentIndex = state.items.indexOf(item);\n        index = limit(index, 0, state.items.length - 1);\n        if (currentIndex === index) return;\n        state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\n      },\n      SORT: function SORT(_ref5) {\n        var compare = _ref5.compare;\n        sortItems(state, compare);\n        dispatch('DID_SORT_ITEMS', {\n          items: query('GET_ACTIVE_ITEMS')\n        });\n      },\n      ADD_ITEMS: function ADD_ITEMS(_ref6) {\n        var items = _ref6.items,\n            index = _ref6.index,\n            interactionMethod = _ref6.interactionMethod,\n            _ref6$success = _ref6.success,\n            success = _ref6$success === void 0 ? function () {} : _ref6$success,\n            _ref6$failure = _ref6.failure,\n            failure = _ref6$failure === void 0 ? function () {} : _ref6$failure;\n        var currentIndex = index;\n\n        if (index === -1 || typeof index === 'undefined') {\n          var insertLocation = query('GET_ITEM_INSERT_LOCATION');\n          var totalItems = query('GET_TOTAL_ITEMS');\n          currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n\n        var ignoredFiles = query('GET_IGNORED_FILES');\n\n        var isValidFile = function isValidFile(source) {\n          return isFile(source) ? !ignoredFiles.includes(source.name.toLowerCase()) : !isEmpty(source);\n        };\n\n        var validItems = items.filter(isValidFile);\n        var promises = validItems.map(function (source) {\n          return new Promise(function (resolve, reject) {\n            dispatch('ADD_ITEM', {\n              interactionMethod: interactionMethod,\n              source: source.source || source,\n              success: resolve,\n              failure: reject,\n              index: currentIndex++,\n              options: source.options || {}\n            });\n          });\n        });\n        Promise.all(promises).then(success).catch(failure);\n      },\n\n      /**\n       * @param source\n       * @param index\n       * @param interactionMethod\n       */\n      ADD_ITEM: function ADD_ITEM(_ref7) {\n        var source = _ref7.source,\n            _ref7$index = _ref7.index,\n            index = _ref7$index === void 0 ? -1 : _ref7$index,\n            interactionMethod = _ref7.interactionMethod,\n            _ref7$success = _ref7.success,\n            success = _ref7$success === void 0 ? function () {} : _ref7$success,\n            _ref7$failure = _ref7.failure,\n            failure = _ref7$failure === void 0 ? function () {} : _ref7$failure,\n            _ref7$options = _ref7.options,\n            options = _ref7$options === void 0 ? {} : _ref7$options; // if no source supplied\n\n        if (isEmpty(source)) {\n          failure({\n            error: createResponse('error', 0, 'No source'),\n            file: null\n          });\n          return;\n        } // filter out invalid file items, used to filter dropped directory contents\n\n\n        if (isFile(source) && state.options.ignoredFiles.includes(source.name.toLowerCase())) {\n          // fail silently\n          return;\n        } // test if there's still room in the list of files\n\n\n        if (!hasRoomForItem(state)) {\n          // if multiple allowed, we can't replace\n          // or if only a single item is allowed but we're not allowed to replace it we exit\n          if (state.options.allowMultiple || !state.options.allowMultiple && !state.options.allowReplace) {\n            var error = createResponse('warning', 0, 'Max files');\n            dispatch('DID_THROW_MAX_FILES', {\n              source: source,\n              error: error\n            });\n            failure({\n              error: error,\n              file: null\n            });\n            return;\n          } // let's replace the item\n          // id of first item we're about to remove\n\n\n          var _item = getActiveItems(state.items)[0]; // if has been processed remove it from the server as well\n\n          if (_item.status === ItemStatus.PROCESSING_COMPLETE || _item.status === ItemStatus.PROCESSING_REVERT_ERROR) {\n            var forceRevert = query('GET_FORCE_REVERT');\n\n            _item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), forceRevert).then(function () {\n              if (!forceRevert) return; // try to add now\n\n              dispatch('ADD_ITEM', {\n                source: source,\n                index: index,\n                interactionMethod: interactionMethod,\n                success: success,\n                failure: failure,\n                options: options\n              });\n            }).catch(function () {}); // no need to handle this catch state for now\n\n\n            if (forceRevert) return;\n          } // remove first item as it will be replaced by this item\n\n\n          dispatch('REMOVE_ITEM', {\n            query: _item.id\n          });\n        } // where did the file originate\n\n\n        var origin = options.type === 'local' ? FileOrigin.LOCAL : options.type === 'limbo' ? FileOrigin.LIMBO : FileOrigin.INPUT; // create a new blank item\n\n        var item = createItem( // where did this file come from\n        origin, // an input file never has a server file reference\n        origin === FileOrigin.INPUT ? null : source, // file mock data, if defined\n        options.file); // set initial meta data\n\n        Object.keys(options.metadata || {}).forEach(function (key) {\n          item.setMetadata(key, options.metadata[key]);\n        }); // created the item, let plugins add methods\n\n        applyFilters('DID_CREATE_ITEM', item, {\n          query: query,\n          dispatch: dispatch\n        }); // where to insert new items\n\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION'); // adjust index if is not allowed to pick location\n\n        if (!state.options.itemInsertLocationFreedom) {\n          index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        } // add item to list\n\n\n        insertItem(state.items, item, index); // sort items in list\n\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        } // get a quick reference to the item id\n\n\n        var id = item.id; // observe item events\n\n        item.on('load-init', function () {\n          dispatch('DID_START_ITEM_LOAD', {\n            id: id\n          });\n        });\n        item.on('load-meta', function () {\n          dispatch('DID_UPDATE_ITEM_META', {\n            id: id\n          });\n        });\n        item.on('load-progress', function (progress) {\n          dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n        item.on('load-request-error', function (error) {\n          var mainStatus = dynamicLabel(state.options.labelFileLoadError)(error); // is client error, no way to recover\n\n          if (error.code >= 400 && error.code < 500) {\n            dispatch('DID_THROW_ITEM_INVALID', {\n              id: id,\n              error: error,\n              status: {\n                main: mainStatus,\n                sub: error.code + ' (' + error.body + ')'\n              }\n            }); // reject the file so can be dealt with through API\n\n            failure({\n              error: error,\n              file: createItemAPI(item)\n            });\n            return;\n          } // is possible server error, so might be possible to retry\n\n\n          dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: mainStatus,\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('load-file-error', function (error) {\n          dispatch('DID_THROW_ITEM_INVALID', {\n            id: id,\n            error: error.status,\n            status: error.status\n          });\n          failure({\n            error: error.status,\n            file: createItemAPI(item)\n          });\n        });\n        item.on('load-abort', function () {\n          dispatch('REMOVE_ITEM', {\n            query: id\n          });\n        });\n        item.on('load-skip', function () {\n          dispatch('COMPLETE_LOAD_ITEM', {\n            query: id,\n            item: item,\n            data: {\n              source: source,\n              success: success\n            }\n          });\n        });\n        item.on('load', function () {\n          var handleAdd = function handleAdd(shouldAdd) {\n            // no should not add this file\n            if (!shouldAdd) {\n              dispatch('REMOVE_ITEM', {\n                query: id\n              });\n              return;\n            } // now interested in metadata updates\n\n\n            item.on('metadata-update', function (change) {\n              dispatch('DID_UPDATE_ITEM_METADATA', {\n                id: id,\n                change: change\n              });\n            }); // let plugins decide if the output data should be prepared at this point\n            // means we'll do this and wait for idle state\n\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function (shouldPrepareOutput) {\n              var loadComplete = function loadComplete() {\n                dispatch('COMPLETE_LOAD_ITEM', {\n                  query: id,\n                  item: item,\n                  data: {\n                    source: source,\n                    success: success\n                  }\n                });\n                listUpdated(dispatch, state);\n              }; // exit\n\n\n              if (shouldPrepareOutput) {\n                // wait for idle state and then run PREPARE_OUTPUT\n                dispatch('REQUEST_PREPARE_OUTPUT', {\n                  query: id,\n                  item: item,\n                  success: function success(file) {\n                    dispatch('DID_PREPARE_OUTPUT', {\n                      id: id,\n                      file: file\n                    });\n                    loadComplete();\n                  }\n                }, true);\n                return;\n              }\n\n              loadComplete();\n            });\n          }; // item loaded, allow plugins to\n          // - read data (quickly)\n          // - add metadata\n\n\n          applyFilterChain('DID_LOAD_ITEM', item, {\n            query: query,\n            dispatch: dispatch\n          }).then(function () {\n            optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(handleAdd);\n          }).catch(function () {\n            handleAdd(false);\n          });\n        });\n        item.on('process-start', function () {\n          dispatch('DID_START_ITEM_PROCESSING', {\n            id: id\n          });\n        });\n        item.on('process-progress', function (progress) {\n          dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n        item.on('process-error', function (error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('process-revert-error', function (error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('process-complete', function (serverFileReference) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: id,\n            error: null,\n            serverFileReference: serverFileReference\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: id,\n            value: serverFileReference\n          });\n        });\n        item.on('process-abort', function () {\n          dispatch('DID_ABORT_ITEM_PROCESSING', {\n            id: id\n          });\n        });\n        item.on('process-revert', function () {\n          dispatch('DID_REVERT_ITEM_PROCESSING', {\n            id: id\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: id,\n            value: null\n          });\n        }); // let view know the item has been inserted\n\n        dispatch('DID_ADD_ITEM', {\n          id: id,\n          index: index,\n          interactionMethod: interactionMethod\n        });\n        listUpdated(dispatch, state); // start loading the source\n\n        var _ref8 = state.options.server || {},\n            url = _ref8.url,\n            load = _ref8.load,\n            restore = _ref8.restore,\n            fetch = _ref8.fetch;\n\n        item.load(source, // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n        createFileLoader(origin === FileOrigin.INPUT ? // input\n        isString(source) && isExternalURL(source) ? createFetchFunction(url, fetch) // remote url\n        : fetchLocal // local url\n        : // limbo or local\n        origin === FileOrigin.LIMBO ? createFetchFunction(url, restore) // limbo\n        : createFetchFunction(url, load) // local\n        ), // called when the file is loaded so it can be piped through the filters\n        function (file, success, error) {\n          // let's process the file\n          applyFilterChain('LOAD_FILE', file, {\n            query: query\n          }).then(success).catch(error);\n        });\n      },\n      REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref9) {\n        var item = _ref9.item,\n            success = _ref9.success,\n            _ref9$failure = _ref9.failure,\n            failure = _ref9$failure === void 0 ? function () {} : _ref9$failure; // error response if item archived\n\n        var err = {\n          error: createResponse('error', 0, 'Item not found'),\n          file: null\n        }; // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n\n        if (item.archived) return failure(err); // allow plugins to alter the file data\n\n        applyFilterChain('PREPARE_OUTPUT', item.file, {\n          query: query,\n          item: item\n        }).then(function (result) {\n          applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {\n            query: query,\n            item: item\n          }).then(function (result) {\n            // don't handle archived items, an item could have been archived (load aborted) while being prepared\n            if (item.archived) return failure(err); // we done!\n\n            success(result);\n          });\n        });\n      },\n      COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref10) {\n        var item = _ref10.item,\n            data = _ref10.data;\n        var success = data.success,\n            source = data.source; // sort items in list\n\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        } // let interface know the item has loaded\n\n\n        dispatch('DID_LOAD_ITEM', {\n          id: item.id,\n          error: null,\n          serverFileReference: item.origin === FileOrigin.INPUT ? null : source\n        }); // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n\n        success(createItemAPI(item)); // if this is a local server file we need to show a different state\n\n        if (item.origin === FileOrigin.LOCAL) {\n          dispatch('DID_LOAD_LOCAL_ITEM', {\n            id: item.id\n          });\n          return;\n        } // if is a temp server file we prevent async upload call here (as the file is already on the server)\n\n\n        if (item.origin === FileOrigin.LIMBO) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: item.id,\n            error: null,\n            serverFileReference: source\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: item.id,\n            value: source\n          });\n          return;\n        } // id we are allowed to upload the file immidiately, lets do it\n\n\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n          dispatch('REQUEST_ITEM_PROCESSING', {\n            query: item.id\n          });\n        }\n      },\n      RETRY_ITEM_LOAD: getItemByQueryFromState(state, function (item) {\n        // try loading the source one more time\n        item.retryLoad();\n      }),\n      REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, function (item, _success, failure) {\n        dispatch('REQUEST_PREPARE_OUTPUT', {\n          query: item.id,\n          item: item,\n          success: function success(file) {\n            dispatch('DID_PREPARE_OUTPUT', {\n              id: item.id,\n              file: file\n            });\n\n            _success({\n              file: item,\n              output: file\n            });\n          },\n          failure: failure\n        }, true);\n      }),\n      REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function (item, success, failure) {\n        // cannot be queued (or is already queued)\n        var itemCanBeQueuedForProcessing = // waiting for something\n        item.status === ItemStatus.IDLE || // processing went wrong earlier\n        item.status === ItemStatus.PROCESSING_ERROR; // not ready to be processed\n\n        if (!itemCanBeQueuedForProcessing) {\n          var processNow = function processNow() {\n            return dispatch('REQUEST_ITEM_PROCESSING', {\n              query: item,\n              success: success,\n              failure: failure\n            });\n          };\n\n          var process = function process() {\n            return document.hidden ? processNow() : setTimeout(processNow, 32);\n          }; // if already done processing or tried to revert but didn't work, try again\n\n\n          if (item.status === ItemStatus.PROCESSING_COMPLETE || item.status === ItemStatus.PROCESSING_REVERT_ERROR) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(process).catch(function () {}); // don't continue with processing if something went wrong\n          } else if (item.status === ItemStatus.PROCESSING) {\n            item.abortProcessing().then(process);\n          }\n\n          return;\n        } // already queued for processing\n\n\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n        item.requestProcessing();\n        dispatch('DID_REQUEST_ITEM_PROCESSING', {\n          id: item.id\n        });\n        dispatch('PROCESS_ITEM', {\n          query: item,\n          success: success,\n          failure: failure\n        }, true);\n      }),\n      PROCESS_ITEM: getItemByQueryFromState(state, function (item, success, failure) {\n        var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        var totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING).length; // queue and wait till queue is freed up\n\n        if (totalCurrentUploads === maxParallelUploads) {\n          // queue for later processing\n          state.processingQueue.push({\n            id: item.id,\n            success: success,\n            failure: failure\n          }); // stop it!\n\n          return;\n        } // if was not queued or is already processing exit here\n\n\n        if (item.status === ItemStatus.PROCESSING) return;\n\n        var processNext = function processNext() {\n          // process queueud items\n          var queueEntry = state.processingQueue.shift(); // no items left\n\n          if (!queueEntry) return; // get item reference\n\n          var id = queueEntry.id,\n              success = queueEntry.success,\n              failure = queueEntry.failure;\n          var itemReference = getItemByQuery(state.items, id); // if item was archived while in queue, jump to next\n\n          if (!itemReference || itemReference.archived) {\n            processNext();\n            return;\n          } // process queued item\n\n\n          dispatch('PROCESS_ITEM', {\n            query: id,\n            success: success,\n            failure: failure\n          }, true);\n        }; // we done function\n\n\n        item.onOnce('process-complete', function () {\n          success(createItemAPI(item));\n          processNext(); // All items processed? No errors?\n\n          var allItemsProcessed = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length === state.items.length;\n\n          if (allItemsProcessed) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n          }\n        }); // we error function\n\n        item.onOnce('process-error', function (error) {\n          failure({\n            error: error,\n            file: createItemAPI(item)\n          });\n          processNext();\n        }); // start file processing\n\n        var options = state.options;\n        item.process(createFileProcessor(createProcessorFunction(options.server.url, options.server.process, options.name, {\n          chunkTransferId: item.transferId,\n          chunkServer: options.server.patch,\n          chunkUploads: options.chunkUploads,\n          chunkForce: options.chunkForce,\n          chunkSize: options.chunkSize,\n          chunkRetryDelays: options.chunkRetryDelays\n        })), // called when the file is about to be processed so it can be piped through the transform filters\n        function (file, success, error) {\n          // allow plugins to alter the file data\n          applyFilterChain('PREPARE_OUTPUT', file, {\n            query: query,\n            item: item\n          }).then(function (file) {\n            dispatch('DID_PREPARE_OUTPUT', {\n              id: item.id,\n              file: file\n            });\n            success(file);\n          }).catch(error);\n        });\n      }),\n      RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        dispatch('REQUEST_ITEM_PROCESSING', {\n          query: item\n        });\n      }),\n      REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function (item) {\n        optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(function (shouldRemove) {\n          if (!shouldRemove) {\n            return;\n          }\n\n          dispatch('REMOVE_ITEM', {\n            query: item\n          });\n        });\n      }),\n      RELEASE_ITEM: getItemByQueryFromState(state, function (item) {\n        item.release();\n      }),\n      REMOVE_ITEM: getItemByQueryFromState(state, function (item, success) {\n        var removeFromView = function removeFromView() {\n          // get id reference\n          var id = item.id; // archive the item, this does not remove it from the list\n\n          getItemById(state.items, id).archive(); // tell the view the item has been removed\n\n          dispatch('DID_REMOVE_ITEM', {\n            error: null,\n            id: id,\n            item: item\n          }); // now the list has been modified\n\n          listUpdated(dispatch, state); // correctly removed\n\n          success(createItemAPI(item));\n        }; // if this is a local file and the server.remove function has been configured, send source there so dev can remove file from server\n\n\n        var server = state.options.server;\n\n        if (item.origin === FileOrigin.LOCAL && server && isFunction(server.remove)) {\n          dispatch('DID_START_ITEM_REMOVE', {\n            id: item.id\n          });\n          server.remove(item.source, function () {\n            return removeFromView();\n          }, function (status) {\n            dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n              id: item.id,\n              error: createResponse('error', 0, status, null),\n              status: {\n                main: dynamicLabel(state.options.labelFileRemoveError)(status),\n                sub: state.options.labelTapToRetry\n              }\n            });\n          });\n        } else {\n          // if is limbo item, need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\n          if (item.origin !== FileOrigin.LOCAL && item.serverId !== null) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT'));\n          } // can now safely remove from view\n\n\n          removeFromView();\n        }\n      }),\n      ABORT_ITEM_LOAD: getItemByQueryFromState(state, function (item) {\n        item.abortLoad();\n      }),\n      ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        // test if is already processed\n        if (item.serverId) {\n          dispatch('REVERT_ITEM_PROCESSING', {\n            id: item.id\n          });\n          return;\n        } // abort\n\n\n        item.abortProcessing().then(function () {\n          var shouldRemove = state.options.instantUpload;\n\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', {\n              query: item.id\n            });\n          }\n        });\n      }),\n      REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        // not instant uploading, revert immidiately\n        if (!state.options.instantUpload) {\n          dispatch('REVERT_ITEM_PROCESSING', {\n            query: item\n          });\n          return;\n        } // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n\n\n        var handleRevert = function handleRevert(shouldRevert) {\n          if (!shouldRevert) return;\n          dispatch('REVERT_ITEM_PROCESSING', {\n            query: item\n          });\n        };\n\n        var fn = query('GET_BEFORE_REMOVE_FILE');\n\n        if (!fn) {\n          return handleRevert(true);\n        }\n\n        var requestRemoveResult = fn(createItemAPI(item));\n\n        if (requestRemoveResult == null) {\n          // undefined or null\n          return handleRevert(true);\n        }\n\n        if (typeof requestRemoveResult === 'boolean') {\n          return handleRevert(requestRemoveResult);\n        }\n\n        if (typeof requestRemoveResult.then === 'function') {\n          requestRemoveResult.then(handleRevert);\n        }\n      }),\n      REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(function () {\n          var shouldRemove = state.options.instantUpload || isMockItem(item);\n\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', {\n              query: item.id\n            });\n          }\n        }).catch(function () {});\n      }),\n      SET_OPTIONS: function SET_OPTIONS(_ref11) {\n        var options = _ref11.options;\n        forin(options, function (key, value) {\n          dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        });\n      }\n    };\n  };\n\n  var formatFilename = function formatFilename(name) {\n    return name;\n  };\n\n  var createElement$1 = function createElement(tagName) {\n    return document.createElement(tagName);\n  };\n\n  var text = function text(node, value) {\n    var textNode = node.childNodes[0];\n\n    if (!textNode) {\n      textNode = document.createTextNode(value);\n      node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n      textNode.nodeValue = value;\n    }\n  };\n\n  var polarToCartesian = function polarToCartesian(centerX, centerY, radius, angleInDegrees) {\n    var angleInRadians = (angleInDegrees % 360 - 90) * Math.PI / 180.0;\n    return {\n      x: centerX + radius * Math.cos(angleInRadians),\n      y: centerY + radius * Math.sin(angleInRadians)\n    };\n  };\n\n  var describeArc = function describeArc(x, y, radius, startAngle, endAngle, arcSweep) {\n    var start = polarToCartesian(x, y, radius, endAngle);\n    var end = polarToCartesian(x, y, radius, startAngle);\n    return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\n  };\n\n  var percentageArc = function percentageArc(x, y, radius, from, to) {\n    var arcSweep = 1;\n\n    if (to > from && to - from <= 0.5) {\n      arcSweep = 0;\n    }\n\n    if (from > to && from - to >= 0.5) {\n      arcSweep = 0;\n    }\n\n    return describeArc(x, y, radius, Math.min(0.9999, from) * 360, Math.min(0.9999, to) * 360, arcSweep);\n  };\n\n  var create = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // start at 0\n\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0; // svg\n\n    var svg = createElement('svg');\n    root.ref.path = createElement('path', {\n      'stroke-width': 2,\n      'stroke-linecap': 'round'\n    });\n    svg.appendChild(root.ref.path);\n    root.ref.svg = svg;\n    root.appendChild(svg);\n  };\n\n  var write = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n\n    if (props.opacity === 0) {\n      return;\n    }\n\n    if (props.align) {\n      root.element.dataset.align = props.align;\n    } // get width of stroke\n\n\n    var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10); // calculate size of ring\n\n    var size = root.rect.element.width * 0.5; // ring state\n\n    var ringFrom = 0;\n    var ringTo = 0; // now in busy mode\n\n    if (props.spin) {\n      ringFrom = 0;\n      ringTo = 0.5;\n    } else {\n      ringFrom = 0;\n      ringTo = props.progress;\n    } // get arc path\n\n\n    var coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo); // update progress bar\n\n    attr(root.ref.path, 'd', coordinates); // hide while contains 0 value\n\n    attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);\n  };\n\n  var progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create: create,\n    write: write,\n    mixins: {\n      apis: ['progress', 'spin', 'align'],\n      styles: ['opacity'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 500\n        },\n        progress: {\n          type: 'spring',\n          stiffness: 0.95,\n          damping: 0.65,\n          mass: 10\n        }\n      }\n    }\n  });\n\n  var create$1 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.element.innerHTML = (props.icon || '') + ('<span>' + props.label + '</span>');\n    props.isDisabled = false;\n  };\n\n  var write$1 = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n    var isDisabled = props.isDisabled;\n    var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n    if (shouldDisable && !isDisabled) {\n      props.isDisabled = true;\n      attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n      props.isDisabled = false;\n      root.element.removeAttribute('disabled');\n    }\n  };\n\n  var fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n      type: 'button'\n    },\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n      apis: ['label'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      },\n      listeners: true\n    },\n    create: create$1,\n    write: write$1\n  });\n\n  var toNaturalFileSize = function toNaturalFileSize(bytes) {\n    var decimalSeparator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.'; // nope, no negative byte sizes\n\n    bytes = Math.round(Math.abs(bytes)); // just bytes\n\n    if (bytes < 1000) {\n      return bytes + ' bytes';\n    } // kilobytes\n\n\n    if (bytes < MB) {\n      return Math.floor(bytes / KB) + ' KB';\n    } // megabytes\n\n\n    if (bytes < GB) {\n      return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' MB';\n    } // gigabytes\n\n\n    return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' GB';\n  };\n\n  var KB = 1000;\n  var MB = 1000000;\n  var GB = 1000000000;\n\n  var removeDecimalsWhenZero = function removeDecimalsWhenZero(value, decimalCount, separator) {\n    return value.toFixed(decimalCount).split('.').filter(function (part) {\n      return part !== '0';\n    }).join(separator);\n  };\n\n  var create$2 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // filename\n\n    var fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main'; // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName; // filesize\n\n    var fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize; // set initial values\n\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFile = function updateFile(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n    text(root.ref.fileSize, toNaturalFileSize(root.query('GET_ITEM_SIZE', props.id)));\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {\n    var root = _ref3.root,\n        props = _ref3.props; // if size is available don't fallback to unknown size message\n\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n      return;\n    }\n\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n  };\n\n  var fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: updateFile,\n      DID_UPDATE_ITEM_META: updateFile,\n      DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n      DID_THROW_ITEM_INVALID: updateFileSizeOnError\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    create: create$2,\n    mixins: {\n      styles: ['translateX', 'translateY'],\n      animations: {\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var toPercentage = function toPercentage(value) {\n    return Math.round(value * 100);\n  };\n\n  var create$3 = function create(_ref) {\n    var root = _ref.root; // main status\n\n    var main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main; // sub status\n\n    var sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n    didSetItemLoadProgress({\n      root: root,\n      action: {\n        progress: null\n      }\n    });\n  };\n\n  var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    var title = action.progress === null ? root.query('GET_LABEL_FILE_LOADING') : root.query('GET_LABEL_FILE_LOADING') + ' ' + toPercentage(action.progress) + '%';\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    var title = action.progress === null ? root.query('GET_LABEL_FILE_PROCESSING') : root.query('GET_LABEL_FILE_PROCESSING') + ' ' + toPercentage(action.progress) + '%';\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {\n    var root = _ref4.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {\n    var root = _ref5.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n  };\n\n  var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {\n    var root = _ref6.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n  };\n\n  var clear = function clear(_ref7) {\n    var root = _ref7.root;\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n  };\n\n  var error = function error(_ref8) {\n    var root = _ref8.root,\n        action = _ref8.action;\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n  };\n\n  var fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: clear,\n      DID_REVERT_ITEM_PROCESSING: clear,\n      DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n      DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n      DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n      DID_THROW_ITEM_LOAD_ERROR: error,\n      DID_THROW_ITEM_INVALID: error,\n      DID_THROW_ITEM_PROCESSING_ERROR: error,\n      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n      DID_THROW_ITEM_REMOVE_ERROR: error\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    create: create$3,\n    mixins: {\n      styles: ['translateX', 'translateY', 'opacity'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 250\n        },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n  /**\n   * Button definitions for the file view\n   */\n\n  var Buttons = {\n    AbortItemLoad: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n      action: 'ABORT_ITEM_LOAD',\n      className: 'filepond--action-abort-item-load',\n      align: 'LOAD_INDICATOR_POSITION' // right\n\n    },\n    RetryItemLoad: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n      action: 'RETRY_ITEM_LOAD',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-load',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RemoveItem: {\n      label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n      action: 'REQUEST_REMOVE_ITEM',\n      icon: 'GET_ICON_REMOVE',\n      className: 'filepond--action-remove-item',\n      align: 'BUTTON_REMOVE_ITEM_POSITION' // left\n\n    },\n    ProcessItem: {\n      label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n      action: 'REQUEST_ITEM_PROCESSING',\n      icon: 'GET_ICON_PROCESS',\n      className: 'filepond--action-process-item',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    AbortItemProcessing: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n      action: 'ABORT_ITEM_PROCESSING',\n      className: 'filepond--action-abort-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RetryItemProcessing: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n      action: 'RETRY_ITEM_PROCESSING',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RevertItemProcessing: {\n      label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n      action: 'REQUEST_REVERT_ITEM_PROCESSING',\n      icon: 'GET_ICON_UNDO',\n      className: 'filepond--action-revert-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    }\n  }; // make a list of buttons, we can then remove buttons from this list if they're disabled\n\n  var ButtonKeys = [];\n  forin(Buttons, function (key) {\n    ButtonKeys.push(key);\n  });\n\n  var calculateFileInfoOffset = function calculateFileInfoOffset(root) {\n    var buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n  }; // Force on full pixels so text stays crips\n\n\n  var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(root) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\n  };\n\n  var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(root) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n  };\n\n  var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {\n    return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\n  };\n\n  var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(root) {\n    return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\n  };\n\n  var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {\n    return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n  };\n\n  var DefaultStyle = {\n    buttonAbortItemLoad: {\n      opacity: 0\n    },\n    buttonRetryItemLoad: {\n      opacity: 0\n    },\n    buttonRemoveItem: {\n      opacity: 0\n    },\n    buttonProcessItem: {\n      opacity: 0\n    },\n    buttonAbortItemProcessing: {\n      opacity: 0\n    },\n    buttonRetryItemProcessing: {\n      opacity: 0\n    },\n    buttonRevertItemProcessing: {\n      opacity: 0\n    },\n    loadProgressIndicator: {\n      opacity: 0,\n      align: getLoadIndicatorAlignment\n    },\n    processProgressIndicator: {\n      opacity: 0,\n      align: getProcessIndicatorAlignment\n    },\n    processingCompleteIndicator: {\n      opacity: 0,\n      scaleX: 0.75,\n      scaleY: 0.75\n    },\n    info: {\n      translateX: 0,\n      translateY: 0,\n      opacity: 0\n    },\n    status: {\n      translateX: 0,\n      translateY: 0,\n      opacity: 0\n    }\n  };\n  var IdleStyle = {\n    buttonRemoveItem: {\n      opacity: 1\n    },\n    buttonProcessItem: {\n      opacity: 1\n    },\n    info: {\n      translateX: calculateFileInfoOffset\n    },\n    status: {\n      translateX: calculateFileInfoOffset\n    }\n  };\n  var ProcessingStyle = {\n    buttonAbortItemProcessing: {\n      opacity: 1\n    },\n    processProgressIndicator: {\n      opacity: 1\n    },\n    status: {\n      opacity: 1\n    }\n  };\n  var StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        translateX: calculateFileInfoOffset,\n        opacity: 1\n      }\n    },\n    DID_START_ITEM_LOAD: {\n      buttonAbortItemLoad: {\n        opacity: 1\n      },\n      loadProgressIndicator: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_THROW_ITEM_LOAD_ERROR: {\n      buttonRetryItemLoad: {\n        opacity: 1\n      },\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_START_ITEM_REMOVE: {\n      processProgressIndicator: {\n        opacity: 1,\n        align: getRemoveIndicatorAligment\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 0\n      }\n    },\n    DID_THROW_ITEM_REMOVE_ERROR: {\n      processProgressIndicator: {\n        opacity: 0,\n        align: getRemoveIndicatorAligment\n      },\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1,\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n      buttonRevertItemProcessing: {\n        opacity: 1\n      },\n      info: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      buttonRetryItemProcessing: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n      buttonRevertItemProcessing: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      },\n      info: {\n        opacity: 1\n      }\n    },\n    DID_ABORT_ITEM_PROCESSING: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      buttonProcessItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_REVERT_ITEM_PROCESSING: IdleStyle\n  }; // complete indicator view\n\n  var processingCompleteIndicatorView = createView({\n    create: function create(_ref) {\n      var root = _ref.root;\n      root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n      styles: ['scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      }\n    }\n  });\n  /**\n   * Creates the file view\n   */\n\n  var create$4 = function create(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n    var id = props.id; // allow reverting upload\n\n    var allowRevert = root.query('GET_ALLOW_REVERT'); // is instant uploading, need this to determine the icon of the undo button\n\n    var instantUpload = root.query('GET_INSTANT_UPLOAD'); // is async set up\n\n    var isAsync = root.query('IS_ASYNC'); // should align remove item buttons\n\n    var alignRemoveItemButton = root.query('GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN'); // enabled buttons array\n\n    var enabledButtons = isAsync ? ButtonKeys.concat() : ButtonKeys.filter(function (key) {\n      return !/Process/.test(key);\n    }); // update icon and label for revert button when instant uploading\n\n    if (instantUpload && allowRevert) {\n      Buttons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n      Buttons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    } // remove last button (revert) if not allowed\n\n\n    if (isAsync && !allowRevert) {\n      enabledButtons.splice(-1, 1);\n      var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      map.info.translateX = calculateFileHorizontalCenterOffset;\n      map.info.translateY = calculateFileVerticalCenterOffset;\n      map.status.translateY = calculateFileVerticalCenterOffset;\n      map.processingCompleteIndicator = {\n        opacity: 1,\n        scaleX: 1,\n        scaleY: 1\n      };\n    } // move remove button to right\n\n\n    if (alignRemoveItemButton && allowRevert) {\n      Buttons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\n      var _map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      _map.info.translateX = calculateFileInfoOffset;\n      _map.status.translateY = calculateFileVerticalCenterOffset;\n      _map.processingCompleteIndicator = {\n        opacity: 1,\n        scaleX: 1,\n        scaleY: 1\n      };\n    } // create the button views\n\n\n    forin(Buttons, function (key, definition) {\n      // create button\n      var buttonView = root.createChildView(fileActionButton, {\n        label: root.query(definition.label),\n        icon: root.query(definition.icon),\n        opacity: 0\n      }); // should be appended?\n\n      if (enabledButtons.includes(key)) {\n        root.appendChildView(buttonView);\n      } // add position attribute\n\n\n      buttonView.element.dataset.align = root.query('GET_STYLE_' + definition.align); // add class\n\n      buttonView.element.classList.add(definition.className); // handle interactions\n\n      buttonView.on('click', function (e) {\n        e.stopPropagation();\n        root.dispatch(definition.action, {\n          query: id\n        });\n      }); // set reference\n\n      root.ref['button' + key] = buttonView;\n    }); // checkmark\n\n    root.ref.processingCompleteIndicator = root.appendChildView(root.createChildView(processingCompleteIndicatorView));\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query('GET_STYLE_BUTTON_PROCESS_ITEM_POSITION'); // create file info view\n\n    root.ref.info = root.appendChildView(root.createChildView(fileInfo, {\n      id: id\n    })); // create file status view\n\n    root.ref.status = root.appendChildView(root.createChildView(fileStatus, {\n      id: id\n    })); // add progress indicators\n\n    var loadIndicatorView = root.appendChildView(root.createChildView(progressIndicator, {\n      opacity: 0,\n      align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION')\n    }));\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n    var progressIndicatorView = root.appendChildView(root.createChildView(progressIndicator, {\n      opacity: 0,\n      align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION')\n    }));\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView; // current active styles\n\n    root.ref.activeStyles = [];\n  };\n\n  var write$2 = function write(_ref3) {\n    var root = _ref3.root,\n        actions = _ref3.actions,\n        props = _ref3.props; // route actions\n\n    route({\n      root: root,\n      actions: actions,\n      props: props\n    }); // select last state change action\n\n    var action = actions.concat().filter(function (action) {\n      return /^DID_/.test(action.type);\n    }).reverse().find(function (action) {\n      return StyleMap[action.type];\n    }); // a new action happened, let's get the matching styles\n\n    if (action) {\n      // define new active styles\n      root.ref.activeStyles = [];\n      var stylesToApply = StyleMap[action.type];\n      forin(DefaultStyle, function (name, defaultStyles) {\n        // get reference to control\n        var control = root.ref[name]; // loop over all styles for this control\n\n        forin(defaultStyles, function (key, defaultValue) {\n          var value = stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined' ? stylesToApply[name][key] : defaultValue;\n          root.ref.activeStyles.push({\n            control: control,\n            key: key,\n            value: value\n          });\n        });\n      });\n    } // apply active styles to element\n\n\n    root.ref.activeStyles.forEach(function (_ref4) {\n      var control = _ref4.control,\n          key = _ref4.key,\n          value = _ref4.value;\n      control[key] = typeof value === 'function' ? value(root) : value;\n    });\n  };\n\n  var route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(_ref5) {\n      var root = _ref5.root,\n          action = _ref5.action;\n      root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(_ref6) {\n      var root = _ref6.root,\n          action = _ref6.action;\n      root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(_ref7) {\n      var root = _ref7.root,\n          action = _ref7.action;\n      root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {\n      var root = _ref8.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {\n      var root = _ref9.root;\n      root.ref.loadProgressIndicator.spin = true;\n      root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {\n      var root = _ref10.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(_ref11) {\n      var root = _ref11.root,\n          action = _ref11.action;\n      root.ref.loadProgressIndicator.spin = false;\n      root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(_ref12) {\n      var root = _ref12.root,\n          action = _ref12.action;\n      root.ref.processProgressIndicator.spin = false;\n      root.ref.processProgressIndicator.progress = action.progress;\n    }\n  });\n  var file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    name: 'file'\n  });\n  /**\n   * Creates the file view\n   */\n\n  var create$5 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // filename\n\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName); // file appended\n\n    root.ref.file = root.appendChildView(root.createChildView(file, {\n      id: props.id\n    })); // data has moved to data.js\n\n    root.ref.data = false;\n  };\n  /**\n   * Data storage\n   */\n\n\n  var didLoadItem = function didLoadItem(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props; // updates the legend of the fieldset so screenreaders can better group buttons\n\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n      DID_LOAD_ITEM: didLoadItem\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper'\n  });\n  var PANEL_SPRING_PROPS = {\n    type: 'spring',\n    damping: 0.6,\n    mass: 7\n  };\n\n  var create$6 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    [{\n      name: 'top'\n    }, {\n      name: 'center',\n      props: {\n        translateY: null,\n        scaleY: null\n      },\n      mixins: {\n        animations: {\n          scaleY: PANEL_SPRING_PROPS\n        },\n        styles: ['translateY', 'scaleY']\n      }\n    }, {\n      name: 'bottom',\n      props: {\n        translateY: null\n      },\n      mixins: {\n        animations: {\n          translateY: PANEL_SPRING_PROPS\n        },\n        styles: ['translateY']\n      }\n    }].forEach(function (section) {\n      createSection(root, section, props.name);\n    });\n    root.element.classList.add('filepond--' + props.name);\n    root.ref.scalable = null;\n  };\n\n  var createSection = function createSection(root, section, className) {\n    var viewConstructor = createView({\n      name: 'panel-' + section.name + ' filepond--' + className,\n      mixins: section.mixins,\n      ignoreRectUpdate: true\n    });\n    var view = root.createChildView(viewConstructor, section.props);\n    root.ref[section.name] = root.appendChildView(view);\n  };\n\n  var write$3 = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props; // update scalable state\n\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n      root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n      root.element.dataset.scalable = root.ref.scalable;\n    } // no height, can't set\n\n\n    if (!props.height) return; // get child rects\n\n    var topRect = root.ref.top.rect.element;\n    var bottomRect = root.ref.bottom.rect.element; // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n\n    var height = Math.max(topRect.height + bottomRect.height, props.height); // offset center part\n\n    root.ref.center.translateY = topRect.height; // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n\n    root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100; // offset bottom part\n\n    root.ref.bottom.translateY = height - bottomRect.height;\n  };\n\n  var panel = createView({\n    name: 'panel',\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n      apis: ['height', 'scalable']\n    }\n  });\n  var ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10\n  };\n  var ITEM_SCALE_SPRING = 'spring';\n  var StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy',\n    DID_REQUEST_ITEM_PROCESSING: 'busy',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle'\n  };\n  /**\n   * Creates the file view\n   */\n\n  var create$7 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // select\n\n    root.ref.handleClick = function (e) {\n      return root.dispatch('DID_ACTIVATE_ITEM', {\n        id: props.id\n      });\n    }; // set id\n\n\n    root.element.id = 'filepond--item-' + props.id;\n    root.element.addEventListener('click', root.ref.handleClick); // file view\n\n    root.ref.container = root.appendChildView(root.createChildView(fileWrapper, {\n      id: props.id\n    })); // file panel\n\n    root.ref.panel = root.appendChildView(root.createChildView(panel, {\n      name: 'item-panel'\n    })); // default start height\n\n    root.ref.panel.height = null; // by default not marked for removal\n\n    props.markedForRemoval = false; // if not allowed to reorder file items, exit here\n\n    if (!root.query('GET_ALLOW_REORDER')) return; // set to idle so shows grab cursor\n\n    root.element.dataset.dragState = 'idle';\n\n    var grab = function grab(e) {\n      if (!e.isPrimary) return;\n      var removedActivateListener = false;\n      var origin = {\n        x: e.pageX,\n        y: e.pageY\n      };\n      props.dragOrigin = {\n        x: root.translateX,\n        y: root.translateY\n      };\n      props.dragCenter = {\n        x: e.offsetX,\n        y: e.offsetY\n      };\n      root.dispatch('DID_GRAB_ITEM', {\n        id: props.id\n      });\n\n      var drag = function drag(e) {\n        if (!e.isPrimary) return;\n        e.stopPropagation();\n        e.preventDefault();\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        }; // if dragged stop listening to clicks, will re-add when done dragging\n\n        var dist = props.dragOffset.x * props.dragOffset.x + props.dragOffset.y * props.dragOffset.y;\n\n        if (dist > 16 && !removedActivateListener) {\n          removedActivateListener = true;\n          root.element.removeEventListener('click', root.ref.handleClick);\n        }\n\n        root.dispatch('DID_DRAG_ITEM', {\n          id: props.id\n        });\n      };\n\n      var drop = function drop(e) {\n        if (!e.isPrimary) return;\n        document.removeEventListener('pointermove', drag);\n        document.removeEventListener('pointerup', drop);\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        };\n        root.dispatch('DID_DROP_ITEM', {\n          id: props.id\n        }); // start listening to clicks again\n\n        if (removedActivateListener) {\n          setTimeout(function () {\n            return root.element.addEventListener('click', root.ref.handleClick);\n          }, 0);\n        }\n      };\n\n      document.addEventListener('pointermove', drag);\n      document.addEventListener('pointerup', drop);\n    };\n\n    root.element.addEventListener('pointerdown', grab);\n  };\n\n  var route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {\n      var root = _ref2.root,\n          action = _ref2.action;\n      root.height = action.height;\n    }\n  });\n  var write$4 = createRoute({\n    DID_GRAB_ITEM: function DID_GRAB_ITEM(_ref3) {\n      var root = _ref3.root,\n          props = _ref3.props;\n      props.dragOrigin = {\n        x: root.translateX,\n        y: root.translateY\n      };\n    },\n    DID_DRAG_ITEM: function DID_DRAG_ITEM(_ref4) {\n      var root = _ref4.root;\n      root.element.dataset.dragState = 'drag';\n    },\n    DID_DROP_ITEM: function DID_DROP_ITEM(_ref5) {\n      var root = _ref5.root,\n          props = _ref5.props;\n      props.dragOffset = null;\n      props.dragOrigin = null;\n      root.element.dataset.dragState = 'drop';\n    }\n  }, function (_ref6) {\n    var root = _ref6.root,\n        actions = _ref6.actions,\n        props = _ref6.props,\n        shouldOptimize = _ref6.shouldOptimize;\n\n    if (root.element.dataset.dragState === 'drop') {\n      if (root.scaleX <= 1) {\n        root.element.dataset.dragState = 'idle';\n      }\n    } // select last state change action\n\n\n    var action = actions.concat().filter(function (action) {\n      return /^DID_/.test(action.type);\n    }).reverse().find(function (action) {\n      return StateMap[action.type];\n    }); // no need to set same state twice\n\n    if (action && action.type !== props.currentState) {\n      // set current state\n      props.currentState = action.type; // set state\n\n      root.element.dataset.filepondItemState = StateMap[props.currentState] || '';\n    } // route actions\n\n\n    var aspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');\n\n    if (!aspectRatio) {\n      route$1({\n        root: root,\n        actions: actions,\n        props: props\n      });\n\n      if (!root.height && root.ref.container.rect.element.height > 0) {\n        root.height = root.ref.container.rect.element.height;\n      }\n    } else if (!shouldOptimize) {\n      root.height = root.rect.element.width * aspectRatio;\n    } // sync panel height with item height\n\n\n    if (shouldOptimize) {\n      root.ref.panel.height = null;\n    }\n\n    root.ref.panel.height = root.height;\n  });\n  var item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: function destroy(_ref7) {\n      var root = _ref7.root,\n          props = _ref7.props;\n      root.element.removeEventListener('click', root.ref.handleClick);\n      root.dispatch('RELEASE_ITEM', {\n        query: props.id\n      });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n      apis: ['id', 'interactionMethod', 'markedForRemoval', 'spawnDate', 'dragCenter', 'dragOrigin', 'dragOffset'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],\n      animations: {\n        scaleX: ITEM_SCALE_SPRING,\n        scaleY: ITEM_SCALE_SPRING,\n        translateX: ITEM_TRANSLATE_SPRING,\n        translateY: ITEM_TRANSLATE_SPRING,\n        opacity: {\n          type: 'tween',\n          duration: 150\n        }\n      }\n    }\n  });\n\n  var getItemIndexByPosition = function getItemIndexByPosition(view, children, positionInView) {\n    if (!positionInView) return;\n    var horizontalSpace = view.rect.element.width; // const children = view.childViews;\n\n    var l = children.length;\n    var last = null; // -1, don't move items to accomodate (either add to top or bottom)\n\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1; // let's get the item width\n\n    var item = children[0];\n    var itemRect = item.rect.element;\n    var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    var itemWidth = itemRect.width + itemHorizontalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      for (var index = 0; index < l; index++) {\n        var child = children[index];\n        var childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n\n        if (positionInView.top < childMid) {\n          return index;\n        }\n      }\n\n      return l;\n    } // grid\n\n\n    var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    var itemHeight = itemRect.height + itemVerticalMargin;\n\n    for (var _index = 0; _index < l; _index++) {\n      var indexX = _index % itemsPerRow;\n      var indexY = Math.floor(_index / itemsPerRow);\n      var offsetX = indexX * itemWidth;\n      var offsetY = indexY * itemHeight;\n      var itemTop = offsetY - itemRect.marginTop;\n      var itemRight = offsetX + itemWidth;\n      var itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n      if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n        if (positionInView.left < itemRight) {\n          return _index;\n        } else if (_index !== l - 1) {\n          last = _index;\n        } else {\n          last = null;\n        }\n      }\n    }\n\n    if (last !== null) {\n      return last;\n    }\n\n    return l;\n  };\n\n  var create$8 = function create(_ref) {\n    var root = _ref.root; // need to set role to list as otherwise it won't be read as a list by VoiceOver\n\n    attr(root.element, 'role', 'list');\n    root.ref.lastItemSpanwDate = Date.now();\n  };\n  /**\n   * Inserts a new item\n   * @param root\n   * @param action\n   */\n\n\n  var addItemView = function addItemView(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    var id = action.id,\n        index = action.index,\n        interactionMethod = action.interactionMethod;\n    root.ref.addIndex = index;\n    var now = Date.now();\n    var spawnDate = now;\n    var opacity = 1;\n\n    if (interactionMethod !== InteractionMethod.NONE) {\n      opacity = 0;\n      var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n      var dist = now - root.ref.lastItemSpanwDate;\n      spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n\n    root.ref.lastItemSpanwDate = spawnDate;\n    root.appendChildView(root.createChildView( // view type\n    item, // props\n    {\n      spawnDate: spawnDate,\n      id: id,\n      opacity: opacity,\n      interactionMethod: interactionMethod\n    }), index);\n  };\n\n  var moveItem = function moveItem(item, x, y) {\n    var vx = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var vy = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1; // set to null to remove animation while dragging\n\n    if (item.dragOffset) {\n      item.translateX = null;\n      item.translateY = null;\n      item.translateX = item.dragOrigin.x + item.dragOffset.x;\n      item.translateY = item.dragOrigin.y + item.dragOffset.y;\n      item.scaleX = 1.025;\n      item.scaleY = 1.025;\n    } else {\n      item.translateX = x;\n      item.translateY = y;\n\n      if (Date.now() > item.spawnDate) {\n        // reveal element\n        if (item.opacity === 0) {\n          introItemView(item, x, y, vx, vy);\n        } // make sure is default scale every frame\n\n\n        item.scaleX = 1;\n        item.scaleY = 1;\n        item.opacity = 1;\n      }\n    }\n  };\n\n  var introItemView = function introItemView(item, x, y, vx, vy) {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n      item.translateX = null;\n      item.translateX = x;\n      item.translateY = null;\n      item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n      item.translateX = null;\n      item.translateX = x - vx * 20;\n      item.translateY = null;\n      item.translateY = y - vy * 10;\n      item.scaleX = 0.8;\n      item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n      item.translateY = null;\n      item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n      item.translateX = null;\n      item.translateX = x - 30;\n      item.translateY = null;\n    }\n  };\n  /**\n   * Removes an existing item\n   * @param root\n   * @param action\n   */\n\n\n  var removeItemView = function removeItemView(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    var id = action.id; // get the view matching the given id\n\n    var view = root.childViews.find(function (child) {\n      return child.id === id;\n    }); // if no view found, exit\n\n    if (!view) {\n      return;\n    } // animate view out of view\n\n\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0; // mark for removal\n\n    view.markedForRemoval = true;\n  };\n\n  var getItemHeight = function getItemHeight(child) {\n    return child.rect.element.height + child.rect.element.marginBottom * 0.5 + child.rect.element.marginTop * 0.5;\n  };\n\n  var dragItem = function dragItem(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action,\n        props = _ref4.props;\n    var id = action.id; // get the view matching the given id\n\n    var view = root.childViews.find(function (child) {\n      return child.id === id;\n    }); // if no view found, exit\n\n    if (!view) return;\n    var dragPosition = {\n      x: 0,\n      y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y // find new index\n\n    };\n    var items = root.query('GET_ACTIVE_ITEMS');\n    var visibleChildren = root.childViews.filter(function (child) {\n      return child.rect.element.height;\n    });\n    var children = items.map(function (item) {\n      return visibleChildren.find(function (childView) {\n        return childView.id === item.id;\n      });\n    });\n    var l = children.length;\n    var targetIndex = l - 1;\n    var childHeight = 0;\n    var childBottom = 0;\n    var childTop = 0;\n    var currentIndex = children.findIndex(function (child) {\n      return child === view;\n    });\n    var dragHeight = getItemHeight(view);\n\n    for (var i = 0; i < l; i++) {\n      childHeight = getItemHeight(children[i]);\n      childTop = childBottom;\n      childBottom = childTop + childHeight;\n\n      if (dragPosition.y < childBottom) {\n        if (currentIndex > i) {\n          if (dragPosition.y < childTop + dragHeight) {\n            targetIndex = i;\n            break;\n          }\n\n          continue;\n        }\n\n        targetIndex = i;\n        break;\n      }\n    }\n\n    root.dispatch('MOVE_ITEM', {\n      query: view,\n      index: targetIndex\n    }); // if the index of the item changed, dispatch reorder action\n\n    if (currentIndex !== targetIndex) {\n      root.dispatch('DID_REORDER_ITEMS', {\n        items: root.query('GET_ACTIVE_ITEMS')\n      });\n    }\n  };\n  /**\n   * Setup action routes\n   */\n\n\n  var route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView,\n    DID_DRAG_ITEM: dragItem\n  });\n  /**\n   * Write to view\n   * @param root\n   * @param actions\n   * @param props\n   */\n\n  var write$5 = function write(_ref5) {\n    var root = _ref5.root,\n        props = _ref5.props,\n        actions = _ref5.actions,\n        shouldOptimize = _ref5.shouldOptimize; // route actions\n\n    route$2({\n      root: root,\n      props: props,\n      actions: actions\n    });\n    var dragCoordinates = props.dragCoordinates; // available space on horizontal axis\n\n    var horizontalSpace = root.rect.element.width; // only draw children that have dimensions\n\n    var visibleChildren = root.childViews.filter(function (child) {\n      return child.rect.element.height;\n    }); // sort based on current active items\n\n    var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n      return visibleChildren.find(function (child) {\n        return child.id === item.id;\n      });\n    }).filter(function (item) {\n      return item;\n    }); // get index\n\n    var dragIndex = dragCoordinates ? getItemIndexByPosition(root, children, dragCoordinates) : null; // add index is used to reserve the dropped/added item index till the actual item is rendered\n\n    var addIndex = root.ref.addIndex || null; // add index no longer needed till possibly next draw\n\n    root.ref.addIndex = null;\n    var dragIndexOffset = 0;\n    var removeIndexOffset = 0;\n    var addIndexOffset = 0;\n    if (children.length === 0) return;\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      var offsetY = 0;\n      var dragOffset = 0;\n      children.forEach(function (child, index) {\n        if (dragIndex) {\n          var dist = index - dragIndex;\n\n          if (dist === -2) {\n            dragOffset = -itemVerticalMargin * 0.25;\n          } else if (dist === -1) {\n            dragOffset = -itemVerticalMargin * 0.75;\n          } else if (dist === 0) {\n            dragOffset = itemVerticalMargin * 0.75;\n          } else if (dist === 1) {\n            dragOffset = itemVerticalMargin * 0.25;\n          } else {\n            dragOffset = 0;\n          }\n        }\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        if (!child.markedForRemoval) {\n          moveItem(child, 0, offsetY + dragOffset);\n        }\n\n        var itemHeight = child.rect.element.height + itemVerticalMargin;\n        var visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);\n        offsetY += visualHeight;\n      });\n    } // grid\n    else {\n        var prevX = 0;\n        var prevY = 0;\n        children.forEach(function (child, index) {\n          if (index === dragIndex) {\n            dragIndexOffset = 1;\n          }\n\n          if (index === addIndex) {\n            addIndexOffset += 1;\n          }\n\n          if (child.markedForRemoval && child.opacity < 0.5) {\n            removeIndexOffset -= 1;\n          }\n\n          var visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n          var indexX = visualIndex % itemsPerRow;\n          var indexY = Math.floor(visualIndex / itemsPerRow);\n          var offsetX = indexX * itemWidth;\n          var offsetY = indexY * itemHeight;\n          var vectorX = Math.sign(offsetX - prevX);\n          var vectorY = Math.sign(offsetY - prevY);\n          prevX = offsetX;\n          prevY = offsetY;\n          if (child.markedForRemoval) return;\n\n          if (shouldOptimize) {\n            child.translateX = null;\n            child.translateY = null;\n          }\n\n          moveItem(child, offsetX, offsetY, vectorX, vectorY);\n        });\n      }\n  };\n  /**\n   * Filters actions that are meant specifically for a certain child of the list\n   * @param child\n   * @param actions\n   */\n\n\n  var filterSetItemActions = function filterSetItemActions(child, actions) {\n    return actions.filter(function (action) {\n      // if action has an id, filter out actions that don't have this child id\n      if (action.data && action.data.id) {\n        return child.id === action.data.id;\n      } // allow all other actions\n\n\n      return true;\n    });\n  };\n\n  var list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: function didWriteView(_ref6) {\n      var root = _ref6.root;\n      root.childViews.filter(function (view) {\n        return view.markedForRemoval && view.opacity === 0 && view.resting;\n      }).forEach(function (view) {\n        view._destroy();\n\n        root.removeChildView(view);\n      });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n      apis: ['dragCoordinates']\n    }\n  });\n\n  var create$9 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n  };\n\n  var storeDragCoordinates = function storeDragCoordinates(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props,\n        action = _ref2.action;\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n      left: action.position.scopeLeft - root.ref.list.rect.element.left,\n      top: action.position.scopeTop - (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop)\n    };\n  };\n\n  var clearDragCoordinates = function clearDragCoordinates(_ref3) {\n    var props = _ref3.props;\n    props.dragCoordinates = null;\n  };\n\n  var route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates\n  });\n\n  var write$6 = function write(_ref4) {\n    var root = _ref4.root,\n        props = _ref4.props,\n        actions = _ref4.actions; // route actions\n\n    route$3({\n      root: root,\n      props: props,\n      actions: actions\n    }); // current drag position\n\n    root.ref.list.dragCoordinates = props.dragCoordinates; // if currently overflowing but no longer received overflow\n\n    if (props.overflowing && !props.overflow) {\n      props.overflowing = false; // reset overflow state\n\n      root.element.dataset.state = '';\n      root.height = null;\n    } // if is not overflowing currently but does receive overflow value\n\n\n    if (props.overflow) {\n      var newHeight = Math.round(props.overflow);\n\n      if (newHeight !== root.height) {\n        props.overflowing = true;\n        root.element.dataset.state = 'overflow';\n        root.height = newHeight;\n      }\n    }\n  };\n\n  var listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n      apis: ['overflow', 'dragCoordinates'],\n      styles: ['height', 'translateY'],\n      animations: {\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var attrToggle = function attrToggle(element, name, state) {\n    var enabledValue = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n\n    if (state) {\n      attr(element, name, enabledValue);\n    } else {\n      element.removeAttribute(name);\n    }\n  };\n\n  var resetFileInput = function resetFileInput(input) {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n      return;\n    }\n\n    try {\n      // for modern browsers\n      input.value = '';\n    } catch (err) {} // for IE10\n\n\n    if (input.value) {\n      // quickly append input to temp form and reset form\n      var form = createElement$1('form');\n      var parentNode = input.parentNode;\n      var ref = input.nextSibling;\n      form.appendChild(input);\n      form.reset(); // re-inject input where it originally was\n\n      if (ref) {\n        parentNode.insertBefore(input, ref);\n      } else {\n        parentNode.appendChild(input);\n      }\n    }\n  };\n\n  var create$a = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // set id so can be referenced from outside labels\n\n    root.element.id = 'filepond--browser-' + props.id; // set name of element (is removed when a value is set)\n\n    attr(root.element, 'name', root.query('GET_NAME')); // we have to link this element to the status element\n\n    attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id); // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n\n    attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id); // set configurable props\n\n    setAcceptedFileTypes({\n      root: root,\n      action: {\n        value: root.query('GET_ACCEPTED_FILE_TYPES')\n      }\n    });\n    toggleAllowMultiple({\n      root: root,\n      action: {\n        value: root.query('GET_ALLOW_MULTIPLE')\n      }\n    });\n    toggleDirectoryFilter({\n      root: root,\n      action: {\n        value: root.query('GET_ALLOW_DIRECTORIES_ONLY')\n      }\n    });\n    toggleDisabled({\n      root: root\n    });\n    toggleRequired({\n      root: root,\n      action: {\n        value: root.query('GET_REQUIRED')\n      }\n    });\n    setCaptureMethod({\n      root: root,\n      action: {\n        value: root.query('GET_CAPTURE_METHOD')\n      }\n    }); // handle changes to the input field\n\n    root.ref.handleChange = function (e) {\n      if (!root.element.value) {\n        return;\n      } // extract files and move value of webkitRelativePath path to _relativePath\n\n\n      var files = Array.from(root.element.files).map(function (file) {\n        file._relativePath = file.webkitRelativePath;\n        return file;\n      }); // we add a little delay so the OS file select window can move out of the way before we add our file\n\n      setTimeout(function () {\n        // load files\n        props.onload(files); // reset input, it's just for exposing a method to drop files, should not retain any state\n\n        resetFileInput(root.element);\n      }, 250);\n    };\n\n    root.element.addEventListener('change', root.ref.handleChange);\n  };\n\n  var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    attrToggle(root.element, 'accept', !!action.value, action.value ? action.value.join(',') : '');\n  };\n\n  var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    attrToggle(root.element, 'multiple', action.value);\n  };\n\n  var toggleDirectoryFilter = function toggleDirectoryFilter(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action;\n    attrToggle(root.element, 'webkitdirectory', action.value);\n  };\n\n  var toggleDisabled = function toggleDisabled(_ref5) {\n    var root = _ref5.root;\n    var isDisabled = root.query('GET_DISABLED');\n    var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    var disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n  };\n\n  var toggleRequired = function toggleRequired(_ref6) {\n    var root = _ref6.root,\n        action = _ref6.action; // want to remove required, always possible\n\n    if (!action.value) {\n      attrToggle(root.element, 'required', false);\n    } // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n        attrToggle(root.element, 'required', true);\n      }\n  };\n\n  var setCaptureMethod = function setCaptureMethod(_ref7) {\n    var root = _ref7.root,\n        action = _ref7.action;\n    attrToggle(root.element, 'capture', !!action.value, action.value === true ? '' : action.value);\n  };\n\n  var updateRequiredStatus = function updateRequiredStatus(_ref8) {\n    var root = _ref8.root;\n    var element = root.element; // always remove the required attribute when more than zero items\n\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n      attrToggle(element, 'required', false);\n      attrToggle(element, 'name', false);\n    } else {\n      // add name attribute\n      attrToggle(element, 'name', true, root.query('GET_NAME')); // remove any validation messages\n\n      var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n\n      if (shouldCheckValidity) {\n        element.setCustomValidity('');\n      } // we only add required if the field has been deemed required\n\n\n      if (root.query('GET_REQUIRED')) {\n        attrToggle(element, 'required', true);\n      }\n    }\n  };\n\n  var updateFieldValidityStatus = function updateFieldValidityStatus(_ref9) {\n    var root = _ref9.root;\n    var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n  };\n\n  var browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n      type: 'file'\n    },\n    create: create$a,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n      DID_LOAD_ITEM: updateRequiredStatus,\n      DID_REMOVE_ITEM: updateRequiredStatus,\n      DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n      DID_SET_DISABLED: toggleDisabled,\n      DID_SET_ALLOW_BROWSE: toggleDisabled,\n      DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\n      DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n      DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n      DID_SET_CAPTURE_METHOD: setCaptureMethod,\n      DID_SET_REQUIRED: toggleRequired\n    })\n  });\n  var Key = {\n    ENTER: 13,\n    SPACE: 32\n  };\n\n  var create$b = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // create the label and link it to the file browser\n\n    var label = createElement$1('label');\n    attr(label, 'for', 'filepond--browser-' + props.id); // use for labeling file input (aria-labelledby on file input)\n\n    attr(label, 'id', 'filepond--drop-label-' + props.id); // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.\n\n    attr(label, 'aria-hidden', 'true'); // handle keys\n\n    root.ref.handleKeyDown = function (e) {\n      var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n      if (!isActivationKey) return; // stops from triggering the element a second time\n\n      e.preventDefault(); // click link (will then in turn activate file input)\n\n      root.ref.label.click();\n    };\n\n    root.ref.handleClick = function (e) {\n      var isLabelClick = e.target === label || label.contains(e.target); // don't want to click twice\n\n      if (isLabelClick) return; // click link (will then in turn activate file input)\n\n      root.ref.label.click();\n    }; // attach events\n\n\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick); // update\n\n    updateLabelValue(label, props.caption); // add!\n\n    root.appendChild(label);\n    root.ref.label = label;\n  };\n\n  var updateLabelValue = function updateLabelValue(label, value) {\n    label.innerHTML = value;\n    var clickable = label.querySelector('.filepond--label-action');\n\n    if (clickable) {\n      attr(clickable, 'tabindex', '0');\n    }\n\n    return value;\n  };\n\n  var dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: function destroy(_ref2) {\n      var root = _ref2.root;\n      root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n      root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n      DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {\n        var root = _ref3.root,\n            action = _ref3.action;\n        updateLabelValue(root.ref.label, action.value);\n      }\n    }),\n    mixins: {\n      styles: ['opacity', 'translateX', 'translateY'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 150\n        },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n  var blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      }\n    }\n  });\n\n  var addBlob = function addBlob(_ref) {\n    var root = _ref.root;\n    var centerX = root.rect.element.width * 0.5;\n    var centerY = root.rect.element.height * 0.5;\n    root.ref.blob = root.appendChildView(root.createChildView(blob, {\n      opacity: 0,\n      scaleX: 2.5,\n      scaleY: 2.5,\n      translateX: centerX,\n      translateY: centerY\n    }));\n  };\n\n  var moveBlob = function moveBlob(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n\n    if (!root.ref.blob) {\n      addBlob({\n        root: root\n      });\n      return;\n    }\n\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n  };\n\n  var hideBlob = function hideBlob(_ref3) {\n    var root = _ref3.root;\n\n    if (!root.ref.blob) {\n      return;\n    }\n\n    root.ref.blob.opacity = 0;\n  };\n\n  var explodeBlob = function explodeBlob(_ref4) {\n    var root = _ref4.root;\n\n    if (!root.ref.blob) {\n      return;\n    }\n\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n  };\n\n  var write$7 = function write(_ref5) {\n    var root = _ref5.root,\n        props = _ref5.props,\n        actions = _ref5.actions;\n    route$4({\n      root: root,\n      props: props,\n      actions: actions\n    });\n    var blob = root.ref.blob;\n\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n      root.removeChildView(blob);\n      root.ref.blob = null;\n    }\n  };\n\n  var route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob\n  });\n  var drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7\n  });\n\n  var create$c = function create(_ref) {\n    var root = _ref.root;\n    return root.ref.fields = {};\n  };\n\n  var getField = function getField(root, id) {\n    return root.ref.fields[id];\n  };\n\n  var syncFieldPositionssWithItems = function syncFieldPositionssWithItems(root) {\n    root.query('GET_ACTIVE_ITEMS').forEach(function (item) {\n      root.element.appendChild(root.ref.fields[item.id]);\n    });\n  };\n\n  var didReorderItems = function didReorderItems(_ref2) {\n    var root = _ref2.root;\n    return syncFieldPositionssWithItems(root);\n  };\n\n  var didAddItem = function didAddItem(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    var dataContainer = createElement$1('input');\n    dataContainer.type = 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    dataContainer.disabled = root.query('GET_DISABLED');\n    root.appendChild(dataContainer, 0);\n    root.ref.fields[action.id] = dataContainer;\n  };\n\n  var didLoadItem$1 = function didLoadItem(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action;\n    var field = getField(root, action.id);\n    if (!field || action.serverFileReference === null) return;\n    field.value = action.serverFileReference;\n  };\n\n  var didSetDisabled = function didSetDisabled(_ref5) {\n    var root = _ref5.root;\n    root.element.disabled = root.query('GET_DISABLED');\n  };\n\n  var didRemoveItem = function didRemoveItem(_ref6) {\n    var root = _ref6.root,\n        action = _ref6.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n    field.parentNode.removeChild(field);\n    delete root.ref.fields[action.id];\n  };\n\n  var didDefineValue = function didDefineValue(_ref7) {\n    var root = _ref7.root,\n        action = _ref7.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n\n    if (action.value === null) {\n      field.removeAttribute('value');\n    } else {\n      field.value = action.value;\n    }\n  };\n\n  var write$8 = createRoute({\n    DID_SET_DISABLED: didSetDisabled,\n    DID_ADD_ITEM: didAddItem,\n    DID_LOAD_ITEM: didLoadItem$1,\n    DID_REMOVE_ITEM: didRemoveItem,\n    DID_DEFINE_VALUE: didDefineValue,\n    DID_REORDER_ITEMS: didReorderItems,\n    DID_SORT_ITEMS: didReorderItems\n  });\n  var data = createView({\n    tag: 'fieldset',\n    name: 'data',\n    create: create$c,\n    write: write$8,\n    ignoreRect: true\n  });\n\n  var getRootNode = function getRootNode(element) {\n    return 'getRootNode' in element ? element.getRootNode() : document;\n  };\n\n  var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n  var text$1 = ['css', 'csv', 'html', 'txt'];\n  var map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip'\n  };\n\n  var guesstimateMimeType = function guesstimateMimeType() {\n    var extension = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    extension = extension.toLowerCase();\n\n    if (images.includes(extension)) {\n      return 'image/' + (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension);\n    }\n\n    if (text$1.includes(extension)) {\n      return 'text/' + extension;\n    }\n\n    return map[extension] || '';\n  };\n\n  var requestDataTransferItems = function requestDataTransferItems(dataTransfer) {\n    return new Promise(function (resolve, reject) {\n      // try to get links from transfer, if found we'll exit immidiately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n      var links = getLinks(dataTransfer);\n\n      if (links.length && !hasFiles(dataTransfer)) {\n        return resolve(links);\n      } // try to get files from the transfer\n\n\n      getFiles(dataTransfer).then(resolve);\n    });\n  };\n  /**\n   * Test if datatransfer has files\n   */\n\n\n  var hasFiles = function hasFiles(dataTransfer) {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n  };\n  /**\n   * Extracts files from a DataTransfer object\n   */\n\n\n  var getFiles = function getFiles(dataTransfer) {\n    return new Promise(function (resolve, reject) {\n      // get the transfer items as promises\n      var promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : []). // only keep file system items (files and directories)\n      filter(function (item) {\n        return isFileSystemItem(item);\n      }) // map each item to promise\n      .map(function (item) {\n        return getFilesFromItem(item);\n      }); // if is empty, see if we can extract some info from the files property as a fallback\n\n      if (!promisedFiles.length) {\n        // TODO: test for directories (should not be allowed)\n        // Use FileReader, problem is that the files property gets lost in the process\n        resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n        return;\n      } // done!\n\n\n      Promise.all(promisedFiles).then(function (returnedFileGroups) {\n        // flatten groups\n        var files = [];\n        returnedFileGroups.forEach(function (group) {\n          files.push.apply(files, group);\n        }); // done (filter out empty files)!\n\n        resolve(files.filter(function (file) {\n          return file;\n        }).map(function (file) {\n          if (!file._relativePath) file._relativePath = file.webkitRelativePath;\n          return file;\n        }));\n      }).catch(console.error);\n    });\n  };\n\n  var isFileSystemItem = function isFileSystemItem(item) {\n    if (isEntry(item)) {\n      var entry = getAsEntry(item);\n\n      if (entry) {\n        return entry.isFile || entry.isDirectory;\n      }\n    }\n\n    return item.kind === 'file';\n  };\n\n  var getFilesFromItem = function getFilesFromItem(item) {\n    return new Promise(function (resolve, reject) {\n      if (isDirectoryEntry(item)) {\n        getFilesInDirectory(getAsEntry(item)).then(resolve).catch(reject);\n        return;\n      }\n\n      resolve([item.getAsFile()]);\n    });\n  };\n\n  var getFilesInDirectory = function getFilesInDirectory(entry) {\n    return new Promise(function (resolve, reject) {\n      var files = []; // the total entries to read\n\n      var dirCounter = 0;\n      var fileCounter = 0;\n\n      var resolveIfDone = function resolveIfDone() {\n        if (fileCounter === 0 && dirCounter === 0) {\n          resolve(files);\n        }\n      }; // the recursive function\n\n\n      var readEntries = function readEntries(dirEntry) {\n        dirCounter++;\n        var directoryReader = dirEntry.createReader(); // directories are returned in batches, we need to process all batches before we're done\n\n        var readBatch = function readBatch() {\n          directoryReader.readEntries(function (entries) {\n            if (entries.length === 0) {\n              dirCounter--;\n              resolveIfDone();\n              return;\n            }\n\n            entries.forEach(function (entry) {\n              // recursively read more directories\n              if (entry.isDirectory) {\n                readEntries(entry);\n              } else {\n                // read as file\n                fileCounter++;\n                entry.file(function (file) {\n                  var correctedFile = correctMissingFileType(file);\n                  if (entry.fullPath) correctedFile._relativePath = entry.fullPath;\n                  files.push(correctedFile);\n                  fileCounter--;\n                  resolveIfDone();\n                });\n              }\n            }); // try to get next batch of files\n\n            readBatch();\n          }, reject);\n        }; // read first batch of files\n\n\n        readBatch();\n      }; // go!\n\n\n      readEntries(entry);\n    });\n  };\n\n  var correctMissingFileType = function correctMissingFileType(file) {\n    if (file.type.length) return file;\n    var date = file.lastModifiedDate;\n    var name = file.name;\n    file = file.slice(0, file.size, guesstimateMimeType(getExtensionFromFilename(file.name)));\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n  };\n\n  var isDirectoryEntry = function isDirectoryEntry(item) {\n    return isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n  };\n\n  var isEntry = function isEntry(item) {\n    return 'webkitGetAsEntry' in item;\n  };\n\n  var getAsEntry = function getAsEntry(item) {\n    return item.webkitGetAsEntry();\n  };\n  /**\n   * Extracts links from a DataTransfer object\n   */\n\n\n  var getLinks = function getLinks(dataTransfer) {\n    var links = [];\n\n    try {\n      // look in meta data property\n      links = getLinksFromTransferMetaData(dataTransfer);\n\n      if (links.length) {\n        return links;\n      }\n\n      links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {// nope nope nope (probably IE trouble)\n    }\n\n    return links;\n  };\n\n  var getLinksFromTransferURLData = function getLinksFromTransferURLData(dataTransfer) {\n    var data = dataTransfer.getData('url');\n\n    if (typeof data === 'string' && data.length) {\n      return [data];\n    }\n\n    return [];\n  };\n\n  var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(dataTransfer) {\n    var data = dataTransfer.getData('text/html');\n\n    if (typeof data === 'string' && data.length) {\n      var matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n\n      if (matches) {\n        return [matches[1]];\n      }\n    }\n\n    return [];\n  };\n\n  var dragNDropObservers = [];\n\n  var eventPosition = function eventPosition(e) {\n    return {\n      pageLeft: e.pageX,\n      pageTop: e.pageY,\n      scopeLeft: e.offsetX || e.layerX,\n      scopeTop: e.offsetY || e.layerY\n    };\n  };\n\n  var createDragNDropClient = function createDragNDropClient(element, scopeToObserve, filterElement) {\n    var observer = getDragNDropObserver(scopeToObserve);\n    var client = {\n      element: element,\n      filterElement: filterElement,\n      state: null,\n      ondrop: function ondrop() {},\n      onenter: function onenter() {},\n      ondrag: function ondrag() {},\n      onexit: function onexit() {},\n      onload: function onload() {},\n      allowdrop: function allowdrop() {}\n    };\n    client.destroy = observer.addListener(client);\n    return client;\n  };\n\n  var getDragNDropObserver = function getDragNDropObserver(element) {\n    // see if already exists, if so, return\n    var observer = dragNDropObservers.find(function (item) {\n      return item.element === element;\n    });\n\n    if (observer) {\n      return observer;\n    } // create new observer, does not yet exist for this element\n\n\n    var newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n  };\n\n  var createDragNDropObserver = function createDragNDropObserver(element) {\n    var clients = [];\n    var routes = {\n      dragenter: dragenter,\n      dragover: dragover,\n      dragleave: dragleave,\n      drop: drop\n    };\n    var handlers = {};\n    forin(routes, function (event, createHandler) {\n      handlers[event] = createHandler(element, clients);\n      element.addEventListener(event, handlers[event], false);\n    });\n    var observer = {\n      element: element,\n      addListener: function addListener(client) {\n        // add as client\n        clients.push(client); // return removeListener function\n\n        return function () {\n          // remove client\n          clients.splice(clients.indexOf(client), 1); // if no more clients, clean up observer\n\n          if (clients.length === 0) {\n            dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n            forin(routes, function (event) {\n              element.removeEventListener(event, handlers[event], false);\n            });\n          }\n        };\n      }\n    };\n    return observer;\n  };\n\n  var elementFromPoint = function elementFromPoint(root, point) {\n    if (!('elementFromPoint' in root)) {\n      root = document;\n    }\n\n    return root.elementFromPoint(point.x, point.y);\n  };\n\n  var isEventTarget = function isEventTarget(e, target) {\n    // get root\n    var root = getRootNode(target); // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n\n    var elementAtPosition = elementFromPoint(root, {\n      x: e.pageX - window.pageXOffset,\n      y: e.pageY - window.pageYOffset\n    }); // test if target is the element or if one of its children is\n\n    return elementAtPosition === target || target.contains(elementAtPosition);\n  };\n\n  var initialTarget = null;\n\n  var setDropEffect = function setDropEffect(dataTransfer, effect) {\n    // is in try catch as IE11 will throw error if not\n    try {\n      dataTransfer.dropEffect = effect;\n    } catch (e) {}\n  };\n\n  var dragenter = function dragenter(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      initialTarget = e.target;\n      clients.forEach(function (client) {\n        var element = client.element,\n            onenter = client.onenter;\n\n        if (isEventTarget(e, element)) {\n          client.state = 'enter'; // fire enter event\n\n          onenter(eventPosition(e));\n        }\n      });\n    };\n  };\n\n  var dragover = function dragover(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      var dataTransfer = e.dataTransfer;\n      requestDataTransferItems(dataTransfer).then(function (items) {\n        var overDropTarget = false;\n        clients.some(function (client) {\n          var filterElement = client.filterElement,\n              element = client.element,\n              onenter = client.onenter,\n              onexit = client.onexit,\n              ondrag = client.ondrag,\n              allowdrop = client.allowdrop; // by default we can drop\n\n          setDropEffect(dataTransfer, 'copy'); // allow transfer of these items\n\n          var allowsTransfer = allowdrop(items); // only used when can be dropped on page\n\n          if (!allowsTransfer) {\n            setDropEffect(dataTransfer, 'none');\n            return;\n          } // targetting this client\n\n\n          if (isEventTarget(e, element)) {\n            overDropTarget = true; // had no previous state, means we are entering this client\n\n            if (client.state === null) {\n              client.state = 'enter';\n              onenter(eventPosition(e));\n              return;\n            } // now over element (no matter if it allows the drop or not)\n\n\n            client.state = 'over'; // needs to allow transfer\n\n            if (filterElement && !allowsTransfer) {\n              setDropEffect(dataTransfer, 'none');\n              return;\n            } // dragging\n\n\n            ondrag(eventPosition(e));\n          } else {\n            // should be over an element to drop\n            if (filterElement && !overDropTarget) {\n              setDropEffect(dataTransfer, 'none');\n            } // might have just left this client?\n\n\n            if (client.state) {\n              client.state = null;\n              onexit(eventPosition(e));\n            }\n          }\n        });\n      });\n    };\n  };\n\n  var drop = function drop(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      var dataTransfer = e.dataTransfer;\n      requestDataTransferItems(dataTransfer).then(function (items) {\n        clients.forEach(function (client) {\n          var filterElement = client.filterElement,\n              element = client.element,\n              ondrop = client.ondrop,\n              onexit = client.onexit,\n              allowdrop = client.allowdrop;\n          client.state = null; // if we're filtering on element we need to be over the element to drop\n\n          if (filterElement && !isEventTarget(e, element)) return; // no transfer for this client\n\n          if (!allowdrop(items)) return onexit(eventPosition(e)); // we can drop these items on this client\n\n          ondrop(eventPosition(e), items);\n        });\n      });\n    };\n  };\n\n  var dragleave = function dragleave(root, clients) {\n    return function (e) {\n      if (initialTarget !== e.target) {\n        return;\n      }\n\n      clients.forEach(function (client) {\n        var onexit = client.onexit;\n        client.state = null;\n        onexit(eventPosition(e));\n      });\n    };\n  };\n\n  var createHopper = function createHopper(scope, validateItems, options) {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper'); // shortcuts\n\n    var catchesDropsOnPage = options.catchesDropsOnPage,\n        requiresDropOnElement = options.requiresDropOnElement,\n        _options$filterItems = options.filterItems,\n        filterItems = _options$filterItems === void 0 ? function (items) {\n      return items;\n    } : _options$filterItems; // create a dnd client\n\n    var client = createDragNDropClient(scope, catchesDropsOnPage ? document.documentElement : scope, requiresDropOnElement); // current client state\n\n    var lastState = '';\n    var currentState = ''; // determines if a file may be dropped\n\n    client.allowdrop = function (items) {\n      // TODO: if we can, throw error to indicate the items cannot by dropped\n      return validateItems(filterItems(items));\n    };\n\n    client.ondrop = function (position, items) {\n      var filteredItems = filterItems(items);\n\n      if (!validateItems(filteredItems)) {\n        api.ondragend(position);\n        return;\n      }\n\n      currentState = 'drag-drop';\n      api.onload(filteredItems, position);\n    };\n\n    client.ondrag = function (position) {\n      api.ondrag(position);\n    };\n\n    client.onenter = function (position) {\n      currentState = 'drag-over';\n      api.ondragstart(position);\n    };\n\n    client.onexit = function (position) {\n      currentState = 'drag-exit';\n      api.ondragend(position);\n    };\n\n    var api = {\n      updateHopperState: function updateHopperState() {\n        if (lastState !== currentState) {\n          scope.dataset.hopperState = currentState;\n          lastState = currentState;\n        }\n      },\n      onload: function onload() {},\n      ondragstart: function ondragstart() {},\n      ondrag: function ondrag() {},\n      ondragend: function ondragend() {},\n      destroy: function destroy() {\n        // destroy client\n        client.destroy();\n      }\n    };\n    return api;\n  };\n\n  var listening = false;\n  var listeners$1 = [];\n\n  var handlePaste = function handlePaste(e) {\n    requestDataTransferItems(e.clipboardData).then(function (files) {\n      // no files received\n      if (!files.length) {\n        return;\n      } // notify listeners of received files\n\n\n      listeners$1.forEach(function (listener) {\n        return listener(files);\n      });\n    });\n  };\n\n  var listen = function listen(cb) {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n      return;\n    } // add initial listener\n\n\n    listeners$1.push(cb); // setup paste listener for entire page\n\n    if (listening) {\n      return;\n    }\n\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n  };\n\n  var unlisten = function unlisten(listener) {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener)); // clean up\n\n    if (listeners$1.length === 0) {\n      document.removeEventListener('paste', handlePaste);\n      listening = false;\n    }\n  };\n\n  var createPaster = function createPaster() {\n    var cb = function cb(files) {\n      api.onload(files);\n    };\n\n    var api = {\n      destroy: function destroy() {\n        unlisten(cb);\n      },\n      onload: function onload() {}\n    };\n    listen(cb);\n    return api;\n  };\n  /**\n   * Creates the file view\n   */\n\n\n  var create$d = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.element.id = 'filepond--assistant-' + props.id;\n    attr(root.element, 'role', 'status');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n  };\n\n  var addFilesNotificationTimeout = null;\n  var notificationClearTimeout = null;\n  var filenames = [];\n\n  var assist = function assist(root, message) {\n    root.element.textContent = message;\n  };\n\n  var clear$1 = function clear(root) {\n    root.element.textContent = '';\n  };\n\n  var listModified = function listModified(root, filename, label) {\n    var total = root.query('GET_TOTAL_ITEMS');\n    assist(root, label + ' ' + filename + ', ' + total + ' ' + (total === 1 ? root.query('GET_LABEL_FILE_COUNT_SINGULAR') : root.query('GET_LABEL_FILE_COUNT_PLURAL'))); // clear group after set amount of time so the status is not read twice\n\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(function () {\n      clear$1(root);\n    }, 1500);\n  };\n\n  var isUsingFilePond = function isUsingFilePond(root) {\n    return root.element.parentNode.contains(document.activeElement);\n  };\n\n  var itemAdded = function itemAdded(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    root.element.textContent = '';\n    var item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(function () {\n      listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));\n      filenames.length = 0;\n    }, 750);\n  };\n\n  var itemRemoved = function itemRemoved(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    var item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n  };\n\n  var itemProcessed = function itemProcessed(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action; // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemProcessedUndo = function itemProcessedUndo(_ref5) {\n    var root = _ref5.root,\n        action = _ref5.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemError = function itemError(_ref6) {\n    var root = _ref6.root,\n        action = _ref6.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename; // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);\n  };\n\n  var assistant = createView({\n    create: create$d,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: itemAdded,\n      DID_REMOVE_ITEM: itemRemoved,\n      DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n      DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_THROW_ITEM_REMOVE_ERROR: itemError,\n      DID_THROW_ITEM_LOAD_ERROR: itemError,\n      DID_THROW_ITEM_INVALID: itemError,\n      DID_THROW_ITEM_PROCESSING_ERROR: itemError\n    }),\n    tag: 'span',\n    name: 'assistant'\n  });\n\n  var toCamels = function toCamels(string) {\n    var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.replace(new RegExp(separator + '.', 'g'), function (sub) {\n      return sub.charAt(1).toUpperCase();\n    });\n  };\n\n  var debounce = function debounce(func) {\n    var interval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n    var immidiateOnly = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var last = Date.now();\n    var timeout = null;\n    return function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      clearTimeout(timeout);\n      var dist = Date.now() - last;\n\n      var fn = function fn() {\n        last = Date.now();\n        func.apply(void 0, args);\n      };\n\n      if (dist < interval) {\n        // we need to delay by the difference between interval and dist\n        // for example: if distance is 10 ms and interval is 16 ms,\n        // we need to wait an additional 6ms before calling the function)\n        if (!immidiateOnly) {\n          timeout = setTimeout(fn, interval - dist);\n        }\n      } else {\n        // go!\n        fn();\n      }\n    };\n  };\n\n  var MAX_FILES_LIMIT = 1000000;\n\n  var prevent = function prevent(e) {\n    return e.preventDefault();\n  };\n\n  var create$e = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // Add id\n\n    var id = root.query('GET_ID');\n\n    if (id) {\n      root.element.id = id;\n    } // Add className\n\n\n    var className = root.query('GET_CLASS_NAME');\n\n    if (className) {\n      className.split(' ').filter(function (name) {\n        return name.length;\n      }).forEach(function (name) {\n        root.element.classList.add(name);\n      });\n    } // Field label\n\n\n    root.ref.label = root.appendChildView(root.createChildView(dropLabel, Object.assign({}, props, {\n      translateY: null,\n      caption: root.query('GET_LABEL_IDLE')\n    }))); // List of items\n\n    root.ref.list = root.appendChildView(root.createChildView(listScroller, {\n      translateY: null\n    })); // Background panel\n\n    root.ref.panel = root.appendChildView(root.createChildView(panel, {\n      name: 'panel-root'\n    })); // Assistant notifies assistive tech when content changes\n\n    root.ref.assistant = root.appendChildView(root.createChildView(assistant, Object.assign({}, props))); // Data\n\n    root.ref.data = root.appendChildView(root.createChildView(data, Object.assign({}, props))); // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure); // information on the root height or fixed height status\n\n    root.ref.bounds = null; // apply initial style properties\n\n    root.query('GET_STYLES').filter(function (style) {\n      return !isEmpty(style.value);\n    }).map(function (_ref2) {\n      var name = _ref2.name,\n          value = _ref2.value;\n      root.element.dataset[name] = value;\n    }); // determine if width changed\n\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(function () {\n      root.ref.updateHistory = [];\n      root.dispatch('DID_RESIZE_ROOT');\n    }, 250); // history of updates\n\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = []; // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\n\n    var canHover = window.matchMedia('(pointer: fine) and (hover: hover)').matches;\n    var hasPointerEvents = ('PointerEvent' in window);\n\n    if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\n      root.element.addEventListener('touchmove', prevent, {\n        passive: false\n      });\n      root.element.addEventListener('gesturestart', prevent);\n    }\n  };\n\n  var write$9 = function write(_ref3) {\n    var root = _ref3.root,\n        props = _ref3.props,\n        actions = _ref3.actions; // route actions\n\n    route$5({\n      root: root,\n      props: props,\n      actions: actions\n    }); // apply style properties\n\n    actions.filter(function (action) {\n      return /^DID_SET_STYLE_/.test(action.type);\n    }).filter(function (action) {\n      return !isEmpty(action.data.value);\n    }).map(function (_ref4) {\n      var type = _ref4.type,\n          data = _ref4.data;\n      var name = toCamels(type.substr(8).toLowerCase(), '_');\n      root.element.dataset[name] = data.value;\n      root.invalidateLayout();\n    });\n    if (root.rect.element.hidden) return;\n\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n      root.ref.widthPrevious = root.rect.element.width;\n      root.ref.widthUpdated();\n    } // get box bounds, we do this only once\n\n\n    var bounds = root.ref.bounds;\n\n    if (!bounds) {\n      bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root); // destroy measure element\n\n      root.element.removeChild(root.ref.measure);\n      root.ref.measure = null;\n    } // get quick references to various high level parts of the upload tool\n\n\n    var _root$ref = root.ref,\n        hopper = _root$ref.hopper,\n        label = _root$ref.label,\n        list = _root$ref.list,\n        panel = _root$ref.panel; // sets correct state to hopper scope\n\n    if (hopper) {\n      hopper.updateHopperState();\n    } // bool to indicate if we're full or not\n\n\n    var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    var isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;\n    var atMaxCapacity = totalItems === maxItems; // action used to add item\n\n    var addAction = actions.find(function (action) {\n      return action.type === 'DID_ADD_ITEM';\n    }); // if reached max capacity and we've just reached it\n\n    if (atMaxCapacity && addAction) {\n      // get interaction type\n      var interactionMethod = addAction.data.interactionMethod; // hide label\n\n      label.opacity = 0;\n\n      if (isMultiItem) {\n        label.translateY = -40;\n      } else {\n        if (interactionMethod === InteractionMethod.API) {\n          label.translateX = 40;\n        } else if (interactionMethod === InteractionMethod.BROWSE) {\n          label.translateY = 40;\n        } else {\n          label.translateY = 30;\n        }\n      }\n    } else if (!atMaxCapacity) {\n      label.opacity = 1;\n      label.translateX = 0;\n      label.translateY = 0;\n    }\n\n    var listItemMargin = calculateListItemMargin(root);\n    var listHeight = calculateListHeight(root);\n    var labelHeight = label.rect.element.height;\n    var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n    var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    var listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;\n    var visualHeight = currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    var boundsHeight = currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom; // link list to label bottom position\n\n    list.translateY = Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;\n\n    if (aspectRatio) {\n      // fixed aspect ratio\n      // calculate height based on width\n      var width = root.rect.element.width;\n      var height = width * aspectRatio; // clear history if aspect ratio has changed\n\n      if (aspectRatio !== root.ref.previousAspectRatio) {\n        root.ref.previousAspectRatio = aspectRatio;\n        root.ref.updateHistory = [];\n      } // remember this width\n\n\n      var history = root.ref.updateHistory;\n      history.push(width);\n      var MAX_BOUNCES = 2;\n\n      if (history.length > MAX_BOUNCES * 2) {\n        var l = history.length;\n        var bottom = l - 10;\n        var bounces = 0;\n\n        for (var i = l; i >= bottom; i--) {\n          if (history[i] === history[i - 2]) {\n            bounces++;\n          }\n\n          if (bounces >= MAX_BOUNCES) {\n            // dont adjust height\n            return;\n          }\n        }\n      } // fix height of panel so it adheres to aspect ratio\n\n\n      panel.scalable = false;\n      panel.height = height; // available height for list\n\n      var listAvailableHeight = // the height of the panel minus the label height\n      height - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0);\n\n      if (listHeight.visual > listAvailableHeight) {\n        list.overflow = listAvailableHeight;\n      } else {\n        list.overflow = null;\n      } // set container bounds (so pushes siblings downwards)\n\n\n      root.height = height;\n    } else if (bounds.fixedHeight) {\n      // fixed height\n      // fix height of panel\n      panel.scalable = false; // available height for list\n\n      var _listAvailableHeight = // the height of the panel minus the label height\n      bounds.fixedHeight - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0); // set list height\n\n\n      if (listHeight.visual > _listAvailableHeight) {\n        list.overflow = _listAvailableHeight;\n      } else {\n        list.overflow = null;\n      } // no need to set container bounds as these are handles by CSS fixed height\n\n    } else if (bounds.cappedHeight) {\n      // max-height\n      // not a fixed height panel\n      var isCappedHeight = visualHeight >= bounds.cappedHeight;\n      var panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n      panel.scalable = true;\n      panel.height = isCappedHeight ? panelHeight : panelHeight - listItemMargin.top - listItemMargin.bottom; // available height for list\n\n      var _listAvailableHeight2 = // the height of the panel minus the label height\n      panelHeight - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0); // set list height (if is overflowing)\n\n\n      if (visualHeight > bounds.cappedHeight && listHeight.visual > _listAvailableHeight2) {\n        list.overflow = _listAvailableHeight2;\n      } else {\n        list.overflow = null;\n      } // set container bounds (so pushes siblings downwards)\n\n\n      root.height = Math.min(bounds.cappedHeight, boundsHeight - listItemMargin.top - listItemMargin.bottom);\n    } else {\n      // flexible height\n      // not a fixed height panel\n      var itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n      panel.scalable = true;\n      panel.height = Math.max(labelHeight, visualHeight - itemMargin); // set container bounds (so pushes siblings downwards)\n\n      root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    }\n  };\n\n  var calculateListItemMargin = function calculateListItemMargin(root) {\n    var item = root.ref.list.childViews[0].childViews[0];\n    return item ? {\n      top: item.rect.element.marginTop,\n      bottom: item.rect.element.marginBottom\n    } : {\n      top: 0,\n      bottom: 0\n    };\n  };\n\n  var calculateListHeight = function calculateListHeight(root) {\n    var visual = 0;\n    var bounds = 0; // get file list reference\n\n    var scrollList = root.ref.list;\n    var itemList = scrollList.childViews[0];\n    var visibleChildren = itemList.childViews.filter(function (child) {\n      return child.rect.element.height;\n    });\n    var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n      return visibleChildren.find(function (child) {\n        return child.id === item.id;\n      });\n    }).filter(function (item) {\n      return item;\n    }); // no children, done!\n\n    if (children.length === 0) return {\n      visual: visual,\n      bounds: bounds\n    };\n    var horizontalSpace = itemList.rect.element.width;\n    var dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    var removedItem = children.find(function (child) {\n      return child.markedForRemoval && child.opacity < 0.45;\n    }) ? -1 : 0;\n    var verticalItemCount = children.length + newItem + removedItem;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      children.forEach(function (item) {\n        var height = item.rect.element.height + itemVerticalMargin;\n        bounds += height;\n        visual += height * item.opacity;\n      });\n    } // grid\n    else {\n        bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n        visual = bounds;\n      }\n\n    return {\n      visual: visual,\n      bounds: bounds\n    };\n  };\n\n  var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(root) {\n    var height = root.ref.measureHeight || null;\n    var cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    var fixedHeight = height === 0 ? null : height;\n    return {\n      cappedHeight: cappedHeight,\n      fixedHeight: fixedHeight\n    };\n  };\n\n  var exceedsMaxFiles = function exceedsMaxFiles(root, items) {\n    var allowReplace = root.query('GET_ALLOW_REPLACE');\n    var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = root.query('GET_MAX_FILES'); // total amount of items being dragged\n\n    var totalBrowseItems = items.length; // if does not allow multiple items and dragging more than one item\n\n    if (!allowMultiple && totalBrowseItems > 1) {\n      return true;\n    } // limit max items to one if not allowed to drop multiple items\n\n\n    maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1; // no more room?\n\n    var hasMaxItems = isInt(maxItems);\n\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n      root.dispatch('DID_THROW_MAX_FILES', {\n        source: items,\n        error: createResponse('warning', 0, 'Max files')\n      });\n      return true;\n    }\n\n    return false;\n  };\n\n  var getDragIndex = function getDragIndex(list, children, position) {\n    var itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, children, {\n      left: position.scopeLeft - itemList.rect.element.left,\n      top: position.scopeTop - (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop)\n    });\n  };\n  /**\n   * Enable or disable file drop functionality\n   */\n\n\n  var toggleDrop = function toggleDrop(root) {\n    var isAllowed = root.query('GET_ALLOW_DROP');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.hopper) {\n      var hopper = createHopper(root.element, function (items) {\n        // these files don't fit so stop here\n        if (exceedsMaxFiles(root, items)) return false; // allow quick validation of dropped items\n\n        var beforeDropFile = root.query('GET_BEFORE_DROP_FILE') || function () {\n          return true;\n        }; // all items should be validated by all filters as valid\n\n\n        var dropValidation = root.query('GET_DROP_VALIDATION');\n        return dropValidation ? items.every(function (item) {\n          return applyFilters('ALLOW_HOPPER_ITEM', item, {\n            query: root.query\n          }).every(function (result) {\n            return result === true;\n          }) && beforeDropFile(item);\n        }) : true;\n      }, {\n        filterItems: function filterItems(items) {\n          var ignoredFiles = root.query('GET_IGNORED_FILES');\n          return items.filter(function (item) {\n            if (isFile(item)) {\n              return !ignoredFiles.includes(item.name.toLowerCase());\n            }\n\n            return true;\n          });\n        },\n        catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n        requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT')\n      });\n\n      hopper.onload = function (items, position) {\n        // get item children elements and sort based on list sort\n        var list = root.ref.list.childViews[0];\n        var visibleChildren = list.childViews.filter(function (child) {\n          return child.rect.element.height;\n        });\n        var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n          return visibleChildren.find(function (child) {\n            return child.id === item.id;\n          });\n        }).filter(function (item) {\n          return item;\n        }); // go\n\n        root.dispatch('ADD_ITEMS', {\n          items: items,\n          index: getDragIndex(root.ref.list, children, position),\n          interactionMethod: InteractionMethod.DROP\n        });\n        root.dispatch('DID_DROP', {\n          position: position\n        });\n        root.dispatch('DID_END_DRAG', {\n          position: position\n        });\n      };\n\n      hopper.ondragstart = function (position) {\n        root.dispatch('DID_START_DRAG', {\n          position: position\n        });\n      };\n\n      hopper.ondrag = debounce(function (position) {\n        root.dispatch('DID_DRAG', {\n          position: position\n        });\n      });\n\n      hopper.ondragend = function (position) {\n        root.dispatch('DID_END_DRAG', {\n          position: position\n        });\n      };\n\n      root.ref.hopper = hopper;\n      root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n      root.ref.hopper.destroy();\n      root.ref.hopper = null;\n      root.removeChildView(root.ref.drip);\n    }\n  };\n  /**\n   * Enable or disable browse functionality\n   */\n\n\n  var toggleBrowse = function toggleBrowse(root, props) {\n    var isAllowed = root.query('GET_ALLOW_BROWSE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.browser) {\n      root.ref.browser = root.appendChildView(root.createChildView(browser, Object.assign({}, props, {\n        onload: function onload(items) {\n          // these files don't fit so stop here\n          if (exceedsMaxFiles(root, items)) return false; // add items!\n\n          root.dispatch('ADD_ITEMS', {\n            items: items,\n            index: -1,\n            interactionMethod: InteractionMethod.BROWSE\n          });\n        }\n      })), 0);\n    } else if (!enabled && root.ref.browser) {\n      root.removeChildView(root.ref.browser);\n      root.ref.browser = null;\n    }\n  };\n  /**\n   * Enable or disable paste functionality\n   */\n\n\n  var togglePaste = function togglePaste(root) {\n    var isAllowed = root.query('GET_ALLOW_PASTE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.paster) {\n      root.ref.paster = createPaster();\n\n      root.ref.paster.onload = function (items) {\n        root.dispatch('ADD_ITEMS', {\n          items: items,\n          index: -1,\n          interactionMethod: InteractionMethod.PASTE\n        });\n      };\n    } else if (!enabled && root.ref.paster) {\n      root.ref.paster.destroy();\n      root.ref.paster = null;\n    }\n  };\n  /**\n   * Route actions\n   */\n\n\n  var route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {\n      var root = _ref5.root,\n          props = _ref5.props;\n      toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {\n      var root = _ref6.root;\n      toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {\n      var root = _ref7.root;\n      togglePaste(root);\n    },\n    DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {\n      var root = _ref8.root,\n          props = _ref8.props;\n      toggleDrop(root);\n      togglePaste(root);\n      toggleBrowse(root, props);\n      var isDisabled = root.query('GET_DISABLED');\n\n      if (isDisabled) {\n        root.element.dataset.disabled = 'disabled';\n      } else {\n        // delete root.element.dataset.disabled; <= this does not work on iOS 10\n        root.element.removeAttribute('data-disabled');\n      }\n    }\n  });\n  var root = createView({\n    name: 'root',\n    read: function read(_ref9) {\n      var root = _ref9.root;\n\n      if (root.ref.measure) {\n        root.ref.measureHeight = root.ref.measure.offsetHeight;\n      }\n    },\n    create: create$e,\n    write: write$9,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n\n      if (root.ref.paster) {\n        root.ref.paster.destroy();\n      }\n\n      if (root.ref.hopper) {\n        root.ref.hopper.destroy();\n      }\n\n      root.element.removeEventListener('touchmove', prevent);\n      root.element.removeEventListener('gesturestart', prevent);\n    },\n    mixins: {\n      styles: ['height']\n    }\n  }); // creates the app\n\n  var createApp = function createApp() {\n    var initialOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // let element\n\n    var originalElement = null; // get default options\n\n    var defaultOptions = getOptions(); // create the data store, this will contain all our app info\n\n    var store = createStore( // initial state (should be serializable)\n    createInitialState(defaultOptions), // queries\n    [queries, createOptionQueries(defaultOptions)], // action handlers\n    [actions, createOptionActions(defaultOptions)]); // set initial options\n\n    store.dispatch('SET_OPTIONS', {\n      options: initialOptions\n    }); // kick thread if visibility changes\n\n    var visibilityHandler = function visibilityHandler() {\n      if (document.hidden) return;\n      store.dispatch('KICK');\n    };\n\n    document.addEventListener('visibilitychange', visibilityHandler); // re-render on window resize start and finish\n\n    var resizeDoneTimer = null;\n    var isResizing = false;\n    var isResizingHorizontally = false;\n    var initialWindowWidth = null;\n    var currentWindowWidth = null;\n\n    var resizeHandler = function resizeHandler() {\n      if (!isResizing) {\n        isResizing = true;\n      }\n\n      clearTimeout(resizeDoneTimer);\n      resizeDoneTimer = setTimeout(function () {\n        isResizing = false;\n        initialWindowWidth = null;\n        currentWindowWidth = null;\n\n        if (isResizingHorizontally) {\n          isResizingHorizontally = false;\n          store.dispatch('DID_STOP_RESIZE');\n        }\n      }, 500);\n    };\n\n    window.addEventListener('resize', resizeHandler); // render initial view\n\n    var view = root(store, {\n      id: getUniqueId()\n    }); //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n\n    var isResting = false;\n    var isHidden = false;\n    var readWriteApi = {\n      // necessary for update loop\n\n      /**\n       * Reads from dom (never call manually)\n       * @private\n       */\n      _read: function _read() {\n        // test if we're resizing horizontally\n        // TODO: see if we can optimize this by measuring root rect\n        if (isResizing) {\n          currentWindowWidth = window.innerWidth;\n\n          if (!initialWindowWidth) {\n            initialWindowWidth = currentWindowWidth;\n          }\n\n          if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {\n            store.dispatch('DID_START_RESIZE');\n            isResizingHorizontally = true;\n          }\n        }\n\n        if (isHidden && isResting) {\n          // test if is no longer hidden\n          isResting = view.element.offsetParent === null;\n        } // if resting, no need to read as numbers will still all be correct\n\n\n        if (isResting) return; // read view data\n\n        view._read(); // if is hidden we need to know so we exit rest mode when revealed\n\n\n        isHidden = view.rect.element.hidden;\n      },\n\n      /**\n       * Writes to dom (never call manually)\n       * @private\n       */\n      _write: function _write(ts) {\n        // get all actions from store\n        var actions = store.processActionQueue() // filter out set actions (these will automatically trigger DID_SET)\n        .filter(function (action) {\n          return !/^SET_/.test(action.type);\n        }); // if was idling and no actions stop here\n\n        if (isResting && !actions.length) return; // some actions might trigger events\n\n        routeActionsToEvents(actions); // update the view\n\n        isResting = view._write(ts, actions, isResizingHorizontally); // will clean up all archived items\n\n        removeReleasedItems(store.query('GET_ITEMS')); // now idling\n\n        if (isResting) {\n          store.processDispatchQueue();\n        }\n      }\n    }; //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n\n    var createEvent = function createEvent(name) {\n      return function (data) {\n        // create default event\n        var event = {\n          type: name\n        }; // no data to add\n\n        if (!data) {\n          return event;\n        } // copy relevant props\n\n\n        if (data.hasOwnProperty('error')) {\n          event.error = data.error ? Object.assign({}, data.error) : null;\n        }\n\n        if (data.status) {\n          event.status = Object.assign({}, data.status);\n        }\n\n        if (data.file) {\n          event.output = data.file;\n        } // only source is available, else add item if possible\n\n\n        if (data.source) {\n          event.file = data.source;\n        } else if (data.item || data.id) {\n          var item = data.item ? data.item : store.query('GET_ITEM', data.id);\n          event.file = item ? createItemAPI(item) : null;\n        } // map all items in a possible items array\n\n\n        if (data.items) {\n          event.items = data.items.map(createItemAPI);\n        } // if this is a progress event add the progress amount\n\n\n        if (/progress/.test(name)) {\n          event.progress = data.progress;\n        }\n\n        return event;\n      };\n    };\n\n    var eventRoutes = {\n      DID_DESTROY: createEvent('destroy'),\n      DID_INIT: createEvent('init'),\n      DID_THROW_MAX_FILES: createEvent('warning'),\n      DID_START_ITEM_LOAD: createEvent('addfilestart'),\n      DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n      DID_LOAD_ITEM: createEvent('addfile'),\n      DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n      DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n      DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],\n      DID_PREPARE_OUTPUT: createEvent('preparefile'),\n      DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n      DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n      DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n      DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n      DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n      DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],\n      DID_REMOVE_ITEM: createEvent('removefile'),\n      DID_UPDATE_ITEMS: createEvent('updatefiles'),\n      DID_ACTIVATE_ITEM: createEvent('activatefile'),\n      DID_REORDER_ITEMS: createEvent('reorderfiles')\n    };\n\n    var exposeEvent = function exposeEvent(event) {\n      // create event object to be dispatched\n      var detail = Object.assign({\n        pond: exports\n      }, event);\n      delete detail.type;\n      view.element.dispatchEvent(new CustomEvent('FilePond:' + event.type, {\n        // event info\n        detail: detail,\n        // event behaviour\n        bubbles: true,\n        cancelable: true,\n        composed: true // triggers listeners outside of shadow root\n\n      })); // event object to params used for `on()` event handlers and callbacks `oninit()`\n\n      var params = []; // if is possible error event, make it the first param\n\n      if (event.hasOwnProperty('error')) {\n        params.push(event.error);\n      } // file is always section\n\n\n      if (event.hasOwnProperty('file')) {\n        params.push(event.file);\n      } // append other props\n\n\n      var filtered = ['type', 'error', 'file'];\n      Object.keys(event).filter(function (key) {\n        return !filtered.includes(key);\n      }).forEach(function (key) {\n        return params.push(event[key]);\n      }); // on(type, () => { })\n\n      exports.fire.apply(exports, [event.type].concat(params)); // oninit = () => {}\n\n      var handler = store.query('GET_ON' + event.type.toUpperCase());\n\n      if (handler) {\n        handler.apply(void 0, params);\n      }\n    };\n\n    var routeActionsToEvents = function routeActionsToEvents(actions) {\n      if (!actions.length) {\n        return;\n      }\n\n      actions.forEach(function (action) {\n        if (!eventRoutes[action.type]) {\n          return;\n        }\n\n        var routes = eventRoutes[action.type];\n        (Array.isArray(routes) ? routes : [routes]).forEach(function (route) {\n          setTimeout(function () {\n            exposeEvent(route(action.data));\n          }, 0);\n        });\n      });\n    }; //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n\n\n    var setOptions = function setOptions(options) {\n      return store.dispatch('SET_OPTIONS', {\n        options: options\n      });\n    };\n\n    var getFile = function getFile(query) {\n      return store.query('GET_ACTIVE_ITEM', query);\n    };\n\n    var prepareFile = function prepareFile(query) {\n      return new Promise(function (resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PREPARE', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var addFile = function addFile(source) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new Promise(function (resolve, reject) {\n        addFiles([{\n          source: source,\n          options: options\n        }], {\n          index: options.index\n        }).then(function (items) {\n          return resolve(items && items[0]);\n        }).catch(reject);\n      });\n    };\n\n    var removeFile = function removeFile(query) {\n      // request item removal\n      store.dispatch('REMOVE_ITEM', {\n        query: query\n      }); // see if item has been removed\n\n      return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n\n    var addFiles = function addFiles() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return new Promise(function (resolve, reject) {\n        var sources = [];\n        var options = {}; // user passed a sources array\n\n        if (isArray(args[0])) {\n          sources.push.apply(sources, args[0]);\n          Object.assign(options, args[1] || {});\n        } else {\n          // user passed sources as arguments, last one might be options object\n          var lastArgument = args[args.length - 1];\n\n          if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {\n            Object.assign(options, args.pop());\n          } // add rest to sources\n\n\n          sources.push.apply(sources, args);\n        }\n\n        store.dispatch('ADD_ITEMS', {\n          items: sources,\n          index: options.index,\n          interactionMethod: InteractionMethod.API,\n          success: resolve,\n          failure: reject\n        });\n      });\n    };\n\n    var getFiles = function getFiles() {\n      return store.query('GET_ACTIVE_ITEMS');\n    };\n\n    var processFile = function processFile(query) {\n      return new Promise(function (resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PROCESSING', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var prepareFiles = function prepareFiles() {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var items = queries.length ? queries : getFiles();\n      return Promise.all(items.map(prepareFile));\n    };\n\n    var processFiles = function processFiles() {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n\n      if (!queries.length) {\n        var files = getFiles().filter(function (item) {\n          return !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) && item.status !== ItemStatus.PROCESSING && item.status !== ItemStatus.PROCESSING_COMPLETE && item.status !== ItemStatus.PROCESSING_REVERT_ERROR;\n        });\n        return Promise.all(files.map(processFile));\n      }\n\n      return Promise.all(queries.map(processFile));\n    };\n\n    var removeFiles = function removeFiles() {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var files = getFiles();\n\n      if (!queries.length) {\n        return Promise.all(files.map(removeFile));\n      } // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n\n\n      var mappedQueries = queries.map(function (query) {\n        return isNumber(query) ? files[query] ? files[query].id : null : query;\n      }).filter(function (query) {\n        return query;\n      });\n      return mappedQueries.map(removeFile);\n    };\n\n    var exports = Object.assign({}, on(), {}, readWriteApi, {}, createOptionAPI(store, defaultOptions), {\n      /**\n       * Override options defined in options object\n       * @param options\n       */\n      setOptions: setOptions,\n\n      /**\n       * Load the given file\n       * @param source - the source of the file (either a File, base64 data uri or url)\n       * @param options - object, { index: 0 }\n       */\n      addFile: addFile,\n\n      /**\n       * Load the given files\n       * @param sources - the sources of the files to load\n       * @param options - object, { index: 0 }\n       */\n      addFiles: addFiles,\n\n      /**\n       * Returns the file objects matching the given query\n       * @param query { string, number, null }\n       */\n      getFile: getFile,\n\n      /**\n       * Upload file with given name\n       * @param query { string, number, null  }\n       */\n      processFile: processFile,\n\n      /**\n       * Request prepare output for file with given name\n       * @param query { string, number, null  }\n       */\n      prepareFile: prepareFile,\n\n      /**\n       * Removes a file by its name\n       * @param query { string, number, null  }\n       */\n      removeFile: removeFile,\n\n      /**\n       * Moves a file to a new location in the files list\n       */\n      moveFile: function moveFile(query, index) {\n        return store.dispatch('MOVE_ITEM', {\n          query: query,\n          index: index\n        });\n      },\n\n      /**\n       * Returns all files (wrapped in public api)\n       */\n      getFiles: getFiles,\n\n      /**\n       * Starts uploading all files\n       */\n      processFiles: processFiles,\n\n      /**\n       * Clears all files from the files list\n       */\n      removeFiles: removeFiles,\n\n      /**\n       * Starts preparing output of all files\n       */\n      prepareFiles: prepareFiles,\n\n      /**\n       * Sort list of files\n       */\n      sort: function sort(compare) {\n        return store.dispatch('SORT', {\n          compare: compare\n        });\n      },\n\n      /**\n       * Browse the file system for a file\n       */\n      browse: function browse() {\n        // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n        var input = view.element.querySelector('input[type=file]');\n\n        if (input) {\n          input.click();\n        }\n      },\n\n      /**\n       * Destroys the app\n       */\n      destroy: function destroy() {\n        // request destruction\n        exports.fire('destroy', view.element); // stop active processes (file uploads, fetches, stuff like that)\n        // loop over items and depending on states call abort for ongoing processes\n\n        store.dispatch('ABORT_ALL'); // destroy view\n\n        view._destroy(); // stop listening to resize\n\n\n        window.removeEventListener('resize', resizeHandler); // stop listening to the visiblitychange event\n\n        document.removeEventListener('visibilitychange', visibilityHandler); // dispatch destroy\n\n        store.dispatch('DID_DESTROY');\n      },\n\n      /**\n       * Inserts the plugin before the target element\n       */\n      insertBefore: function insertBefore$1(element) {\n        return insertBefore(view.element, element);\n      },\n\n      /**\n       * Inserts the plugin after the target element\n       */\n      insertAfter: function insertAfter$1(element) {\n        return insertAfter(view.element, element);\n      },\n\n      /**\n       * Appends the plugin to the target element\n       */\n      appendTo: function appendTo(element) {\n        return element.appendChild(view.element);\n      },\n\n      /**\n       * Replaces an element with the app\n       */\n      replaceElement: function replaceElement(element) {\n        // insert the app before the element\n        insertBefore(view.element, element); // remove the original element\n\n        element.parentNode.removeChild(element); // remember original element\n\n        originalElement = element;\n      },\n\n      /**\n       * Restores the original element\n       */\n      restoreElement: function restoreElement() {\n        if (!originalElement) {\n          return; // no element to restore\n        } // restore original element\n\n\n        insertAfter(originalElement, view.element); // remove our element\n\n        view.element.parentNode.removeChild(view.element); // remove reference\n\n        originalElement = null;\n      },\n\n      /**\n       * Returns true if the app root is attached to given element\n       * @param element\n       */\n      isAttachedTo: function isAttachedTo(element) {\n        return view.element === element || originalElement === element;\n      },\n\n      /**\n       * Returns the root element\n       */\n      element: {\n        get: function get() {\n          return view.element;\n        }\n      },\n\n      /**\n       * Returns the current pond status\n       */\n      status: {\n        get: function get() {\n          return store.query('GET_STATUS');\n        }\n      }\n    }); // Done!\n\n    store.dispatch('DID_INIT'); // create actual api object\n\n    return createObject(exports);\n  };\n\n  var createAppObject = function createAppObject() {\n    var customOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // default options\n\n    var defaultOptions = {};\n    forin(getOptions(), function (key, value) {\n      defaultOptions[key] = value[0];\n    }); // set app options\n\n    var app = createApp(Object.assign({}, defaultOptions, {}, customOptions)); // return the plugin instance\n\n    return app;\n  };\n\n  var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {\n    return string.charAt(0).toLowerCase() + string.slice(1);\n  };\n\n  var attributeNameToPropertyName = function attributeNameToPropertyName(attributeName) {\n    return toCamels(attributeName.replace(/^data-/, ''));\n  };\n\n  var mapObject = function mapObject(object, propertyMap) {\n    // remove unwanted\n    forin(propertyMap, function (selector, mapping) {\n      forin(object, function (property, value) {\n        // create regexp shortcut\n        var selectorRegExp = new RegExp(selector); // tests if\n\n        var matches = selectorRegExp.test(property); // no match, skip\n\n        if (!matches) {\n          return;\n        } // if there's a mapping, the original property is always removed\n\n\n        delete object[property]; // should only remove, we done!\n\n        if (mapping === false) {\n          return;\n        } // move value to new property\n\n\n        if (isString(mapping)) {\n          object[mapping] = value;\n          return;\n        } // move to group\n\n\n        var group = mapping.group;\n\n        if (isObject(mapping) && !object[group]) {\n          object[group] = {};\n        }\n\n        object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;\n      }); // do submapping\n\n      if (mapping.mapping) {\n        mapObject(object[mapping.group], mapping.mapping);\n      }\n    });\n  };\n\n  var getAttributesAsObject = function getAttributesAsObject(node) {\n    var attributeMapping = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // turn attributes into object\n\n    var attributes = [];\n    forin(node.attributes, function (index) {\n      attributes.push(node.attributes[index]);\n    });\n    var output = attributes.filter(function (attribute) {\n      return attribute.name;\n    }).reduce(function (obj, attribute) {\n      var value = attr(node, attribute.name);\n      obj[attributeNameToPropertyName(attribute.name)] = value === attribute.name ? true : value;\n      return obj;\n    }, {}); // do mapping of object properties\n\n    mapObject(output, attributeMapping);\n    return output;\n  };\n\n  var createAppAtElement = function createAppAtElement(element) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // how attributes of the input element are mapped to the options for the plugin\n\n    var attributeMapping = {\n      // translate to other name\n      '^class$': 'className',\n      '^multiple$': 'allowMultiple',\n      '^capture$': 'captureMethod',\n      '^webkitdirectory$': 'allowDirectoriesOnly',\n      // group under single property\n      '^server': {\n        group: 'server',\n        mapping: {\n          '^process': {\n            group: 'process'\n          },\n          '^revert': {\n            group: 'revert'\n          },\n          '^fetch': {\n            group: 'fetch'\n          },\n          '^restore': {\n            group: 'restore'\n          },\n          '^load': {\n            group: 'load'\n          }\n        }\n      },\n      // don't include in object\n      '^type$': false,\n      '^files$': false\n    }; // add additional option translators\n\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping); // create final options object by setting options object and then overriding options supplied on element\n\n    var mergedOptions = Object.assign({}, options);\n    var attributeOptions = getAttributesAsObject(element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element, attributeMapping); // merge with options object\n\n    Object.keys(attributeOptions).forEach(function (key) {\n      if (isObject(attributeOptions[key])) {\n        if (!isObject(mergedOptions[key])) {\n          mergedOptions[key] = {};\n        }\n\n        Object.assign(mergedOptions[key], attributeOptions[key]);\n      } else {\n        mergedOptions[key] = attributeOptions[key];\n      }\n    }); // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n\n    mergedOptions.files = (options.files || []).concat(Array.from(element.querySelectorAll('input:not([type=file])')).map(function (input) {\n      return {\n        source: input.value,\n        options: {\n          type: input.dataset.type\n        }\n      };\n    })); // build plugin\n\n    var app = createAppObject(mergedOptions); // add already selected files\n\n    if (element.files) {\n      Array.from(element.files).forEach(function (file) {\n        app.addFile(file);\n      });\n    } // replace the target element\n\n\n    app.replaceElement(element); // expose\n\n    return app;\n  }; // if an element is passed, we create the instance at that element, if not, we just create an up object\n\n\n  var createApp$1 = function createApp() {\n    return isNode(arguments.length <= 0 ? undefined : arguments[0]) ? createAppAtElement.apply(void 0, arguments) : createAppObject.apply(void 0, arguments);\n  };\n\n  var PRIVATE_METHODS = ['fire', '_read', '_write'];\n\n  var createAppAPI = function createAppAPI(app) {\n    var api = {};\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n    return api;\n  };\n  /**\n   * Replaces placeholders in given string with replacements\n   * @param string - \"Foo {bar}\"\"\n   * @param replacements - { \"bar\": 10 }\n   */\n\n\n  var replaceInString = function replaceInString(string, replacements) {\n    return string.replace(/(?:{([a-zA-Z]+)})/g, function (match, group) {\n      return replacements[group];\n    });\n  };\n\n  var createWorker = function createWorker(fn) {\n    var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n      type: 'application/javascript'\n    });\n    var workerURL = URL.createObjectURL(workerBlob);\n    var worker = new Worker(workerURL);\n    return {\n      transfer: function transfer(message, cb) {},\n      post: function post(message, cb, transferList) {\n        var id = getUniqueId();\n\n        worker.onmessage = function (e) {\n          if (e.data.id === id) {\n            cb(e.data.message);\n          }\n        };\n\n        worker.postMessage({\n          id: id,\n          message: message\n        }, transferList);\n      },\n      terminate: function terminate() {\n        worker.terminate();\n        URL.revokeObjectURL(workerURL);\n      }\n    };\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n\n      img.onload = function () {\n        resolve(img);\n      };\n\n      img.onerror = function (e) {\n        reject(e);\n      };\n\n      img.src = url;\n    });\n  };\n\n  var renameFile = function renameFile(file, name) {\n    var renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n  };\n\n  var copyFile = function copyFile(file) {\n    return renameFile(file, file.name);\n  }; // already registered plugins (can't register twice)\n\n\n  var registeredPlugins = []; // pass utils to plugin\n\n  var createAppPlugin = function createAppPlugin(plugin) {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n      return;\n    } // remember this plugin\n\n\n    registeredPlugins.push(plugin); // setup!\n\n    var pluginOutline = plugin({\n      addFilter: addFilter,\n      utils: {\n        Type: Type,\n        forin: forin,\n        isString: isString,\n        isFile: isFile,\n        toNaturalFileSize: toNaturalFileSize,\n        replaceInString: replaceInString,\n        getExtensionFromFilename: getExtensionFromFilename,\n        getFilenameWithoutExtension: getFilenameWithoutExtension,\n        guesstimateMimeType: guesstimateMimeType,\n        getFileFromBlob: getFileFromBlob,\n        getFilenameFromURL: getFilenameFromURL,\n        createRoute: createRoute,\n        createWorker: createWorker,\n        createView: createView,\n        createItemAPI: createItemAPI,\n        loadImage: loadImage,\n        copyFile: copyFile,\n        renameFile: renameFile,\n        createBlob: createBlob,\n        applyFilterChain: applyFilterChain,\n        text: text,\n        getNumericAspectRatioFromString: getNumericAspectRatioFromString\n      },\n      views: {\n        fileActionButton: fileActionButton\n      }\n    }); // add plugin options to default options\n\n    extendDefaultOptions(pluginOutline.options);\n  }; // feature detection used by supported() method\n\n\n  var isOperaMini = function isOperaMini() {\n    return Object.prototype.toString.call(window.operamini) === '[object OperaMini]';\n  };\n\n  var hasPromises = function hasPromises() {\n    return 'Promise' in window;\n  };\n\n  var hasBlobSlice = function hasBlobSlice() {\n    return 'slice' in Blob.prototype;\n  };\n\n  var hasCreateObjectURL = function hasCreateObjectURL() {\n    return 'URL' in window && 'createObjectURL' in window.URL;\n  };\n\n  var hasVisibility = function hasVisibility() {\n    return 'visibilityState' in document;\n  };\n\n  var hasTiming = function hasTiming() {\n    return 'performance' in window;\n  }; // iOS 8.x\n\n\n  var supported = function () {\n    // Runs immidiately and then remembers result for subsequent calls\n    var isSupported = // Has to be a browser\n    isBrowser() && // Can't run on Opera Mini due to lack of everything\n    !isOperaMini() && // Require these APIs to feature detect a modern browser\n    hasVisibility() && hasPromises() && hasBlobSlice() && hasCreateObjectURL() && hasTiming();\n    return function () {\n      return isSupported;\n    };\n  }();\n  /**\n   * Plugin internal state (over all instances)\n   */\n\n\n  var state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: []\n  }; // plugin name\n\n  var name = 'filepond';\n  /**\n   * Public Plugin methods\n   */\n\n  var fn = function fn() {};\n\n  exports.Status = {};\n  exports.FileStatus = {};\n  exports.FileOrigin = {};\n  exports.OptionTypes = {};\n  exports.create = fn;\n  exports.destroy = fn;\n  exports.parse = fn;\n  exports.find = fn;\n  exports.registerPlugin = fn;\n  exports.getOptions = fn;\n  exports.setOptions = fn; // if not supported, no API\n\n  if (supported()) {\n    // start painter and fire load event\n    createPainter(function () {\n      state.apps.forEach(function (app) {\n        return app._read();\n      });\n    }, function (ts) {\n      state.apps.forEach(function (app) {\n        return app._write(ts);\n      });\n    }); // fire loaded event so we know when FilePond is available\n\n    var dispatch = function dispatch() {\n      // let others know we have area ready\n      document.dispatchEvent(new CustomEvent('FilePond:loaded', {\n        detail: {\n          supported: supported,\n          create: exports.create,\n          destroy: exports.destroy,\n          parse: exports.parse,\n          find: exports.find,\n          registerPlugin: exports.registerPlugin,\n          setOptions: exports.setOptions\n        }\n      })); // clean up event\n\n      document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n\n    if (document.readyState !== 'loading') {\n      // move to back of execution queue, FilePond should have been exported by then\n      setTimeout(function () {\n        return dispatch();\n      }, 0);\n    } else {\n      document.addEventListener('DOMContentLoaded', dispatch);\n    } // updates the OptionTypes object based on the current options\n\n\n    var updateOptionTypes = function updateOptionTypes() {\n      return forin(getOptions(), function (key, value) {\n        exports.OptionTypes[key] = value[1];\n      });\n    };\n\n    exports.Status = Object.assign({}, Status);\n    exports.FileOrigin = Object.assign({}, FileOrigin);\n    exports.FileStatus = Object.assign({}, ItemStatus);\n    exports.OptionTypes = {};\n    updateOptionTypes(); // create method, creates apps and adds them to the app array\n\n    exports.create = function create() {\n      var app = createApp$1.apply(void 0, arguments);\n      app.on('destroy', exports.destroy);\n      state.apps.push(app);\n      return createAppAPI(app);\n    }; // destroys apps and removes them from the app array\n\n\n    exports.destroy = function destroy(hook) {\n      // returns true if the app was destroyed successfully\n      var indexToRemove = state.apps.findIndex(function (app) {\n        return app.isAttachedTo(hook);\n      });\n\n      if (indexToRemove >= 0) {\n        // remove from apps\n        var app = state.apps.splice(indexToRemove, 1)[0]; // restore original dom element\n\n        app.restoreElement();\n        return true;\n      }\n\n      return false;\n    }; // parses the given context for plugins (does not include the context element itself)\n\n\n    exports.parse = function parse(context) {\n      // get all possible hooks\n      var matchedHooks = Array.from(context.querySelectorAll('.' + name)); // filter out already active hooks\n\n      var newHooks = matchedHooks.filter(function (newHook) {\n        return !state.apps.find(function (app) {\n          return app.isAttachedTo(newHook);\n        });\n      }); // create new instance for each hook\n\n      return newHooks.map(function (hook) {\n        return exports.create(hook);\n      });\n    }; // returns an app based on the given element hook\n\n\n    exports.find = function find(hook) {\n      var app = state.apps.find(function (app) {\n        return app.isAttachedTo(hook);\n      });\n\n      if (!app) {\n        return null;\n      }\n\n      return createAppAPI(app);\n    }; // adds a plugin extension\n\n\n    exports.registerPlugin = function registerPlugin() {\n      for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {\n        plugins[_key] = arguments[_key];\n      } // register plugins\n\n\n      plugins.forEach(createAppPlugin); // update OptionTypes, each plugin might have extended the default options\n\n      updateOptionTypes();\n    };\n\n    exports.getOptions = function getOptions$1() {\n      var opts = {};\n      forin(getOptions(), function (key, value) {\n        opts[key] = value[0];\n      });\n      return opts;\n    };\n\n    exports.setOptions = function setOptions$1(opts) {\n      if (isObject(opts)) {\n        // update existing plugins\n        state.apps.forEach(function (app) {\n          app.setOptions(opts);\n        }); // override defaults\n\n        setOptions(opts);\n      } // return new options\n\n\n      return exports.getOptions();\n    };\n  }\n\n  exports.supported = supported;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["/Users/annamatic/Desktop/webtest/node_modules/filepond/dist/filepond.js"],"names":["global","factory","exports","module","define","amd","self","FilePond","isNode","value","HTMLElement","createStore","initialState","queries","arguments","length","undefined","actions","state","Object","assign","actionQueue","dispatchQueue","getState","processActionQueue","queue","concat","processDispatchQueue","forEach","_ref","type","data","dispatch","isBlocking","document","hidden","push","actionHandlers","query","str","_queryHandles","_len","args","Array","_key","queryHandles","apply","api","action","defineProperty","obj","property","definition","forin","cb","key","hasOwnProperty","createObject","attr","node","name","getAttribute","hasAttribute","setAttribute","ns","svgElements","isSVGElement","tag","includes","createElement","className","attributes","element","createElementNS","appendChild","parent","child","index","children","insertBefore","appendChildView","childViews","view","splice","removeChildView","indexOf","parentNode","removeChild","IS_BROWSER","window","isBrowser","testElement","getChildCount","el","childNodes","getViewRect","elementRect","offset","scale","left","top","right","width","bottom","height","rect","inner","outer","filter","childView","isRectIgnored","map","childViewRect","expandRect","calculateRectSize","marginBottom","marginRight","isNumber","thereYet","position","destination","velocity","errorMargin","Math","abs","spring","_ref$stiffness","stiffness","_ref$damping","damping","_ref$mass","mass","target","resting","interpolate","ts","skipToEndState","f","onupdate","oncomplete","setTarget","set","get","easeLinear","t","easeInOutQuad","tween","_ref$duration","duration","_ref$easing","easing","_ref$delay","delay","start","p","reverse","animator","createAnimator","category","def","props","addGetSet","keys","overwrite","isArray","o","getter","setter","animations","mixinConfig","viewProps","viewInternalAPI","viewExternalAPI","initialProps","animation","prop","write","destroy","addEvent","fn","addEventListener","removeEvent","removeEventListener","listeners","viewState","events","add","remove","on","off","findIndex","event","apis","isDefined","defaults","opacity","scaleX","scaleY","translateX","translateY","rotateX","rotateY","rotateZ","originX","originY","styles","currentProps","getOffset","getScale","getRect","propsHaveChanged","applyStyles","newProps","_ref2","perspective","transforms","elementCurrentStyle","style","cssText","Mixins","updateRect","layoutCalculated","paddingTop","parseInt","marginTop","marginLeft","offsetLeft","offsetTop","offsetWidth","offsetHeight","scrollTop","offsetParent","createView","_ref$tag","_ref$name","_ref$attributes","_ref$read","read","_ref$write","_ref$create","create","_ref$destroy","_ref$filterFrameActio","filterFrameActionsForChild","_ref$didCreateView","didCreateView","_ref$didWriteView","didWriteView","_ref$ignoreRect","ignoreRect","_ref$ignoreRectUpdate","ignoreRectUpdate","_ref$mixins","mixins","store","getComputedStyle","frameRect","isResting","activeMixins","ref","writers","readers","destroyers","getElement","getChildViews","getReference","createChildView","getStyle","_read","shouldUpdate","root","internalAPI","reader","_write","frameActions","shouldOptimize","writer","writerResting","timestamp","mixin","mixinResting","childResting","_destroy","destroyer","sharedAPIDefinition","internalAPIDefinition","is","needle","linkView","unlinkView","registerWriter","registerReader","registerDestroyer","invalidateLayout","externalAPIDefinition","mixinAPIDefinition","sort","a","b","mixinAPI","childCount","createPainter","fps","painter","interval","last","id","requestTick","cancelTick","setTimerType","setTimeout","tick","performance","now","clearTimeout","requestAnimationFrame","cancelAnimationFrame","delta","pause","createRoute","routes","_ref$actions","newNode","referenceNode","insertAfter","nextSibling","isEmpty","trim","toString","toArray","splitter","split","isBoolean","toBoolean","isString","toNumber","replace","toInt","toFloat","parseFloat","isInt","isFinite","floor","toBytes","naturalFileSize","test","isFunction","toFunctionReference","string","levels","level","shift","methods","process","patch","revert","fetch","restore","load","createServerAPI","outline","url","timeout","headers","createAction","method","withCredentials","onload","ondata","onerror","parts","header","toServerAPI","isNull","isObject","isAPI","getType","replaceSingleQuotes","conversionTable","array","boolean","int","number","float","bytes","function","_function","serverapi","object","JSON","parse","e","convertTo","getValueByType","newValue","defaultValue","valueType","newValueType","convertedValue","option","createOption","currentValue","enumerable","createOptions","options","optionDefinition","createInitialState","items","listUpdateTimeout","itemUpdateTimeout","processingQueue","fromCamels","separator","part","toLowerCase","join","createOptionAPI","toUpperCase","createOptionActions","createOptionQueries","InteractionMethod","API","DROP","BROWSE","PASTE","NONE","getUniqueId","random","substr","arrayRemove","arr","_fire","fire","Promise","resolve","then","listener","onOnce","_cb","copyObjectPropertiesToObject","src","excluded","getOwnPropertyNames","getOwnPropertyDescriptor","PRIVATE","createItemAPI","item","removeReleasedItems","released","ItemStatus","INIT","IDLE","PROCESSING_QUEUED","PROCESSING","PROCESSING_COMPLETE","PROCESSING_ERROR","PROCESSING_REVERT_ERROR","LOADING","LOAD_ERROR","FileOrigin","INPUT","LIMBO","LOCAL","getNonNumeric","exec","getDecimalSeparator","toLocaleString","getThousandsSeparator","decimalSeparator","thousandsStringWithSeparator","thousandsStringWithoutSeparator","Type","BOOLEAN","INT","NUMBER","STRING","ARRAY","OBJECT","FUNCTION","ACTION","SERVER_API","REGEX","filters","applyFilterChain","utils","reject","matchingFilters","initialFilter","reduce","current","next","catch","error","applyFilters","addFilter","extendDefaultOptions","additionalOptions","defaultOptions","getOptions","setOptions","opts","disabled","required","captureMethod","allowDrop","allowBrowse","allowPaste","allowMultiple","allowReplace","allowRevert","allowReorder","allowDirectoriesOnly","forceRevert","maxFiles","checkValidity","itemInsertLocationFreedom","itemInsertLocation","itemInsertInterval","dropOnPage","dropOnElement","dropValidation","ignoredFiles","instantUpload","maxParallelUploads","chunkUploads","chunkForce","chunkSize","chunkRetryDelays","server","labelDecimalSeparator","labelThousandsSeparator","labelIdle","labelInvalidField","labelFileWaitingForSize","labelFileSizeNotAvailable","labelFileCountSingular","labelFileCountPlural","labelFileLoading","labelFileAdded","labelFileLoadError","labelFileRemoved","labelFileRemoveError","labelFileProcessing","labelFileProcessingComplete","labelFileProcessingAborted","labelFileProcessingError","labelFileProcessingRevertError","labelTapToCancel","labelTapToRetry","labelTapToUndo","labelButtonRemoveItem","labelButtonAbortItemLoad","labelButtonRetryItemLoad","labelButtonAbortItemProcessing","labelButtonUndoItemProcessing","labelButtonRetryItemProcessing","labelButtonProcessItem","iconRemove","iconProcess","iconRetry","iconUndo","iconDone","oninit","onwarning","onactivatefile","onaddfilestart","onaddfileprogress","onaddfile","onprocessfilestart","onprocessfileprogress","onprocessfileabort","onprocessfilerevert","onprocessfile","onprocessfiles","onremovefile","onpreparefile","onupdatefiles","onreorderfiles","beforeDropFile","beforeAddFile","beforeRemoveFile","stylePanelLayout","stylePanelAspectRatio","styleItemPanelAspectRatio","styleButtonRemoveItemPosition","styleButtonProcessItemPosition","styleLoadIndicatorPosition","styleProgressIndicatorPosition","styleButtonRemoveItemAlign","files","getItemByQuery","find","getNumericAspectRatioFromString","aspectRatio","getActiveItems","archived","Status","EMPTY","ERROR","BUSY","READY","ITEM_ERROR","ITEM_BUSY","ITEM_READY","isItemInErrorState","status","isItemInBusyState","isItemInReadyState","GET_STATUS","some","GET_ITEM","GET_ACTIVE_ITEM","GET_ACTIVE_ITEMS","GET_ITEMS","GET_ITEM_NAME","filename","GET_ITEM_SIZE","fileSize","GET_STYLES","GET_PANEL_ASPECT_RATIO","isShapeCircle","GET_ITEM_PANEL_ASPECT_RATIO","GET_ITEMS_BY_STATUS","GET_TOTAL_ITEMS","IS_ASYNC","hasRoomForItem","count","maxFileCount","limit","min","max","arrayInsert","insertItem","isBase64DataURI","getFilenameFromURL","pop","getExtensionFromFilename","guesstimateExtension","subtype","leftPad","padding","slice","getDateString","date","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getFileFromBlob","blob","extension","file","size","lastModifiedDate","_relativePath","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","createBlob","arrayBuffer","mimeType","BB","bb","append","getBlob","Blob","getBlobFromByteStringWithMimeType","byteString","ab","ArrayBuffer","ia","Uint8Array","i","charCodeAt","getMimeTypeFromBase64DataURI","dataURI","getBase64DataFromBase64DataURI","getByteStringFromBase64DataURI","atob","getBlobFromBase64DataURI","getFileFromBase64DataURI","getFileNameFromHeader","matches","decodeURI","getFileSizeFromHeader","match","getTranfserIdFromHeader","getFileInfoFromHeaders","info","source","rows","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","Symbol","iterator","_step","done","err","return","createFileLoader","fetchFn","complete","progress","request","getProgress","abort","File","loadURL","body","code","response","computable","total","fileinfo","setSource","isGet","sendRequest","onheaders","onprogress","ontimeout","onabort","aborted","xhr","headersReceived","encodeURI","encodeURIComponent","stringify","XMLHttpRequest","upload","lengthComputable","loaded","onreadystatechange","readyState","open","unescape","setRequestHeader","responseType","send","createResponse","createTimeoutResponse","getAllResponseHeaders","hasQS","buildURL","createFetchFunction","apiUrl","res","statusText","_typeof","constructor","prototype","REACT_ELEMENT_TYPE","_jsx","defaultProps","childrenLength","propName","childArray","$$typeof","_owner","_asyncIterator","iterable","asyncIterator","call","TypeError","_AwaitValue","wrapped","_AsyncGenerator","gen","front","back","arg","resume","result","wrappedAwait","settle","_invoke","throw","_wrapAsyncGenerator","_awaitAsyncGenerator","_asyncGeneratorDelegate","awaitWrap","iter","waiting","pump","asyncGeneratorStep","_next","_throw","_asyncToGenerator","_classCallCheck","instance","Constructor","_defineProperties","descriptor","configurable","writable","_createClass","protoProps","staticProps","_defineEnumerableProperties","descs","desc","getOwnPropertySymbols","objectSymbols","sym","_defaults","_defineProperty","_extends","_objectSpread","ownKeys","enumerableOnly","symbols","_objectSpread2","getOwnPropertyDescriptors","defineProperties","_inherits","subClass","superClass","_setPrototypeOf","_inheritsLoose","__proto__","_getPrototypeOf","setPrototypeOf","getPrototypeOf","isNativeReflectConstruct","Reflect","construct","sham","Proxy","_construct","Parent","Class","Function","bind","_isNativeFunction","_wrapNativeSuper","_cache","Map","has","Wrapper","_instanceof","hasInstance","_interopRequireDefault","__esModule","default","_interopRequireWildcard","newObj","_newArrowCheck","innerThis","boundThis","_objectDestructuringEmpty","_objectWithoutPropertiesLoose","sourceKeys","_objectWithoutProperties","sourceSymbolKeys","propertyIsEnumerable","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_superPropBase","_get","receiver","base","_set","isStrict","s","Error","_taggedTemplateLiteral","strings","raw","freeze","_taggedTemplateLiteralLoose","_temporalRef","val","_temporalUndefined","_readOnlyError","_classNameTDZError","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_slicedToArrayLoose","_iterableToArrayLimitLoose","_toArray","_iterableToArray","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","arr2","from","_arr","_n","_d","_e","_i","_s","_skipFirstGeneratorNext","it","_toPrimitive","input","hint","prim","toPrimitive","String","Number","_toPropertyKey","_initializerWarningHelper","context","_initializerDefineProperty","initializer","_applyDecoratedDescriptor","decorators","decorator","_classPrivateFieldLooseKey","_classPrivateFieldLooseBase","privateKey","_classPrivateFieldGet","privateMap","_classPrivateFieldSet","_classPrivateFieldDestructureSet","__destrObj","v","_classStaticPrivateFieldSpecGet","classConstructor","_classStaticPrivateFieldSpecSet","_classStaticPrivateMethodGet","_classStaticPrivateMethodSet","_decorate","_getDecoratorsApi","r","initialize","O","initializeInstanceElements","decorated","elements","decorateClass","_coalesceClassElements","d","_createElementDescriptor","initializeClassElements","F","runClassFinishers","finishers","elementsDefinitionOrder","kind","placement","defineClassElement","proto","newElements","placements","static","own","addElementPlacement","_hasDecorators","elementFinishersExtras","decorateElement","extras","decorateConstructor","silent","elementObject","fromElementDescriptor","elementFinisherExtras","toElementFinisherExtras","finisher","newExtras","j","fromClassDescriptor","elementsAndFinisher","toClassDescriptor","k","toStringTag","toElementDescriptors","elementObjects","toElementDescriptor","disallowProperty","_optionalCallableProperty","newConstructor","objectType","_coalesceGetterSetter","other","isSameElement","_isDataDescriptor","_classPrivateMethodGet","privateSet","_classPrivateMethodSet","_wrapRegExp","re","groups","BabelRegExp","_RegExp","RegExp","_super","_groups","WeakMap","_this","buildGroups","substitution","_","g","ChunkStatus","QUEUED","COMPLETE","WAITING","processFileChunked","metadata","transfer","chunks","chunkTransferId","chunkServer","serverId","fd","getResponseHeader","requestTransferId","formData","FormData","requestParams","requestTransferOffset","requestUrl","lastChunkIndex","retries","completeProcessingChunks","canProcessChunk","chunk","processChunk","every","processChunks","updateTotalProgress","retryProcessChunk","totalBytesTransfered","totalSize","totalProcessing","abortChunks","createFileProcessorFunction","canChunkUpload","shouldChunkUpload","willChunkUpload","createProcessorFunction","params","createRevertFunction","uniqueFileId","getRandomNumber","createPerceivedPerformanceUpdater","tickMin","tickMax","runtime","clear","createFileProcessor","processFn","perceivedProgress","perceivedPerformanceUpdater","perceivedDuration","progressFn","completeFn","transferId","reset","getDuration","getFilenameWithoutExtension","lastIndexOf","createFileStub","isFile","deepCloneObject","createItem","origin","serverFileReference","frozen","processingAborted","activeLoader","activeProcessor","abortProcessingRequestComplete","setStatus","getFileExtension","getFileType","getFileSize","getFile","loader","meta","success","retryLoad","abortLoad","processor","onprocess","console","requestProcessing","abortProcessing","revertFileUpload","_setMetadata","setMetadata","getMetadata","filenameWithoutExtension","fileExtension","fileType","relativePath","extend","handler","itemAPI","release","archive","getItemIndexByQuery","getItemById","itemId","fetchLocal","getDomainFromURL","location","protocol","isExternalURL","href","dynamicLabel","label","isMockItem","listUpdated","optionalPromise","sortItems","compare","getItemByQueryFromState","itemHandler","_ref$success","_ref$failure","failure","ABORT_ALL","DID_SET_FILES","_ref2$value","activeItems","interactionMethod","DID_UPDATE_ITEM_METADATA","_ref3","shouldPrepareOutput","doUpload","MOVE_ITEM","_ref4","currentIndex","SORT","_ref5","ADD_ITEMS","_ref6","_ref6$success","_ref6$failure","insertLocation","totalItems","isValidFile","validItems","promises","all","ADD_ITEM","_ref7","_ref7$index","_ref7$success","_ref7$failure","_ref7$options","_item","mainStatus","main","sub","handleAdd","shouldAdd","change","loadComplete","_ref8","REQUEST_PREPARE_OUTPUT","_ref9","_ref9$failure","COMPLETE_LOAD_ITEM","_ref10","RETRY_ITEM_LOAD","REQUEST_ITEM_PREPARE","_success","output","REQUEST_ITEM_PROCESSING","itemCanBeQueuedForProcessing","processNow","PROCESS_ITEM","totalCurrentUploads","processNext","queueEntry","itemReference","allItemsProcessed","RETRY_ITEM_PROCESSING","REQUEST_REMOVE_ITEM","shouldRemove","RELEASE_ITEM","REMOVE_ITEM","removeFromView","ABORT_ITEM_LOAD","ABORT_ITEM_PROCESSING","REQUEST_REVERT_ITEM_PROCESSING","handleRevert","shouldRevert","requestRemoveResult","REVERT_ITEM_PROCESSING","SET_OPTIONS","_ref11","formatFilename","createElement$1","tagName","text","textNode","createTextNode","nodeValue","polarToCartesian","centerX","centerY","radius","angleInDegrees","angleInRadians","PI","x","cos","y","sin","describeArc","startAngle","endAngle","arcSweep","end","percentageArc","to","spin","svg","path","align","dataset","ringStrokeWidth","ringFrom","ringTo","coordinates","progressIndicator","create$1","innerHTML","icon","isDisabled","write$1","shouldDisable","removeAttribute","fileActionButton","toNaturalFileSize","round","MB","KB","GB","removeDecimalsWhenZero","decimalCount","toFixed","create$2","fileName","updateFile","updateFileSizeOnError","fileInfo","DID_LOAD_ITEM","DID_UPDATE_ITEM_META","DID_THROW_ITEM_LOAD_ERROR","DID_THROW_ITEM_INVALID","toPercentage","create$3","didSetItemLoadProgress","title","didSetItemProcessProgress","didRequestItemProcessing","didAbortItemProcessing","didCompleteItemProcessing","fileStatus","DID_REVERT_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_ABORT_ITEM_PROCESSING","DID_COMPLETE_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_UPDATE_ITEM_LOAD_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR","DID_THROW_ITEM_PROCESSING_REVERT_ERROR","DID_THROW_ITEM_REMOVE_ERROR","Buttons","AbortItemLoad","RetryItemLoad","RemoveItem","ProcessItem","AbortItemProcessing","RetryItemProcessing","RevertItemProcessing","ButtonKeys","calculateFileInfoOffset","buttonRect","buttonRemoveItem","calculateFileVerticalCenterOffset","calculateFileHorizontalCenterOffset","getLoadIndicatorAlignment","getProcessIndicatorAlignment","getRemoveIndicatorAligment","DefaultStyle","buttonAbortItemLoad","buttonRetryItemLoad","buttonProcessItem","buttonAbortItemProcessing","buttonRetryItemProcessing","buttonRevertItemProcessing","loadProgressIndicator","processProgressIndicator","processingCompleteIndicator","IdleStyle","ProcessingStyle","StyleMap","DID_START_ITEM_LOAD","DID_START_ITEM_REMOVE","DID_LOAD_LOCAL_ITEM","DID_START_ITEM_PROCESSING","processingCompleteIndicatorView","create$4","isAsync","alignRemoveItemButton","enabledButtons","_map","buttonView","classList","stopPropagation","loadIndicatorView","progressIndicatorView","activeStyles","write$2","route","stylesToApply","defaultStyles","control","DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING","DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD","DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL","buttonAbortItemRemoval","_ref12","create$5","didLoadItem","fileWrapper","PANEL_SPRING_PROPS","create$6","section","createSection","scalable","viewConstructor","write$3","topRect","bottomRect","center","panel","ITEM_TRANSLATE_SPRING","ITEM_SCALE_SPRING","StateMap","create$7","handleClick","container","markedForRemoval","dragState","grab","isPrimary","removedActivateListener","pageX","pageY","dragOrigin","dragCenter","offsetX","offsetY","drag","preventDefault","dragOffset","dist","drop","route$1","DID_UPDATE_PANEL_HEIGHT","write$4","DID_GRAB_ITEM","DID_DRAG_ITEM","DID_DROP_ITEM","currentState","filepondItemState","getItemIndexByPosition","positionInView","horizontalSpace","l","itemRect","itemHorizontalMargin","itemWidth","itemsPerRow","childMid","itemVerticalMargin","itemHeight","_index","indexX","indexY","itemTop","itemRight","itemBottom","create$8","lastItemSpanwDate","addItemView","addIndex","spawnDate","cooldown","moveItem","vx","vy","introItemView","removeItemView","getItemHeight","dragItem","dragPosition","visibleChildren","targetIndex","childHeight","childBottom","childTop","dragHeight","route$2","DID_ADD_ITEM","DID_REMOVE_ITEM","write$5","dragCoordinates","dragIndex","dragIndexOffset","removeIndexOffset","addIndexOffset","childRect","visualHeight","prevX","prevY","visualIndex","vectorX","sign","vectorY","filterSetItemActions","list","create$9","overflowing","storeDragCoordinates","scopeLeft","scopeTop","clearDragCoordinates","route$3","DID_DRAG","DID_END_DRAG","write$6","overflow","newHeight","listScroller","attrToggle","enabledValue","resetFileInput","form","create$a","setAcceptedFileTypes","toggleAllowMultiple","toggleDirectoryFilter","toggleDisabled","toggleRequired","setCaptureMethod","handleChange","webkitRelativePath","doesAllowBrowse","disableField","updateRequiredStatus","shouldCheckValidity","setCustomValidity","updateFieldValidityStatus","browser","DID_SET_DISABLED","DID_SET_ALLOW_BROWSE","DID_SET_ALLOW_DIRECTORIES_ONLY","DID_SET_ALLOW_MULTIPLE","DID_SET_ACCEPTED_FILE_TYPES","DID_SET_CAPTURE_METHOD","DID_SET_REQUIRED","Key","ENTER","SPACE","create$b","handleKeyDown","isActivationKey","keyCode","click","isLabelClick","contains","updateLabelValue","caption","clickable","querySelector","dropLabel","DID_SET_LABEL_IDLE","addBlob","moveBlob","hideBlob","explodeBlob","write$7","route$4","DID_DROP","drip","create$c","fields","getField","syncFieldPositionssWithItems","didReorderItems","didAddItem","dataContainer","didLoadItem$1","field","didSetDisabled","didRemoveItem","didDefineValue","write$8","DID_DEFINE_VALUE","DID_REORDER_ITEMS","DID_SORT_ITEMS","getRootNode","images","text$1","zip","epub","guesstimateMimeType","requestDataTransferItems","dataTransfer","links","getLinks","hasFiles","getFiles","promisedFiles","isFileSystemItem","getFilesFromItem","returnedFileGroups","group","isEntry","entry","getAsEntry","isDirectory","isDirectoryEntry","getFilesInDirectory","getAsFile","dirCounter","fileCounter","resolveIfDone","readEntries","dirEntry","directoryReader","createReader","readBatch","entries","correctedFile","correctMissingFileType","fullPath","webkitGetAsEntry","getLinksFromTransferMetaData","getLinksFromTransferURLData","getData","dragNDropObservers","eventPosition","pageLeft","pageTop","layerX","layerY","createDragNDropClient","scopeToObserve","filterElement","observer","getDragNDropObserver","client","ondrop","onenter","ondrag","onexit","allowdrop","addListener","newObserver","createDragNDropObserver","clients","dragenter","dragover","dragleave","handlers","createHandler","elementFromPoint","point","isEventTarget","elementAtPosition","pageXOffset","pageYOffset","initialTarget","setDropEffect","effect","dropEffect","overDropTarget","allowsTransfer","createHopper","scope","validateItems","catchesDropsOnPage","requiresDropOnElement","_options$filterItems","filterItems","documentElement","lastState","filteredItems","ondragend","ondragstart","updateHopperState","hopperState","listening","listeners$1","handlePaste","clipboardData","listen","unlisten","createPaster","create$d","addFilesNotificationTimeout","notificationClearTimeout","filenames","assist","message","textContent","clear$1","listModified","isUsingFilePond","activeElement","itemAdded","itemRemoved","itemProcessed","itemProcessedUndo","itemError","assistant","toCamels","charAt","debounce","func","immidiateOnly","MAX_FILES_LIMIT","prevent","create$e","measure","bounds","widthPrevious","widthUpdated","updateHistory","previousAspectRatio","canHover","matchMedia","hasPointerEvents","passive","write$9","route$5","calculateRootBoundingBoxHeight","_root$ref","hopper","isMultiItem","maxItems","atMaxCapacity","addAction","listItemMargin","calculateListItemMargin","listHeight","calculateListHeight","labelHeight","currentLabelHeight","listMarginTop","listMarginBottom","visual","boundsHeight","history","MAX_BOUNCES","bounces","listAvailableHeight","fixedHeight","_listAvailableHeight","cappedHeight","isCappedHeight","panelHeight","_listAvailableHeight2","itemMargin","scrollList","itemList","newItem","removedItem","verticalItemCount","ceil","measureHeight","maxHeight","exceedsMaxFiles","totalBrowseItems","hasMaxItems","getDragIndex","toggleDrop","isAllowed","enabled","toggleBrowse","togglePaste","paster","DID_SET_ALLOW_DROP","DID_SET_ALLOW_PASTE","createApp","initialOptions","originalElement","visibilityHandler","resizeDoneTimer","isResizing","isResizingHorizontally","initialWindowWidth","currentWindowWidth","resizeHandler","isHidden","readWriteApi","innerWidth","routeActionsToEvents","createEvent","eventRoutes","DID_DESTROY","DID_INIT","DID_THROW_MAX_FILES","DID_PREPARE_OUTPUT","DID_COMPLETE_ITEM_PROCESSING_ALL","DID_UPDATE_ITEMS","DID_ACTIVATE_ITEM","exposeEvent","detail","pond","dispatchEvent","CustomEvent","bubbles","cancelable","composed","filtered","prepareFile","addFile","addFiles","removeFile","sources","lastArgument","processFile","prepareFiles","_len2","_key2","processFiles","_len3","_key3","removeFiles","_len4","_key4","mappedQueries","moveFile","browse","insertBefore$1","insertAfter$1","appendTo","replaceElement","restoreElement","isAttachedTo","createAppObject","customOptions","app","lowerCaseFirstLetter","attributeNameToPropertyName","attributeName","mapObject","propertyMap","selector","mapping","selectorRegExp","getAttributesAsObject","attributeMapping","attribute","createAppAtElement","mergedOptions","attributeOptions","nodeName","querySelectorAll","createApp$1","PRIVATE_METHODS","createAppAPI","replaceInString","replacements","createWorker","workerBlob","workerURL","URL","createObjectURL","worker","Worker","post","transferList","onmessage","postMessage","terminate","revokeObjectURL","loadImage","img","Image","renameFile","renamedFile","copyFile","registeredPlugins","createAppPlugin","plugin","pluginOutline","views","isOperaMini","operamini","hasPromises","hasBlobSlice","hasCreateObjectURL","hasVisibility","hasTiming","supported","isSupported","apps","FileStatus","OptionTypes","registerPlugin","updateOptionTypes","hook","indexToRemove","matchedHooks","newHooks","newHook","plugins","getOptions$1","setOptions$1"],"mappings":"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","sourcesContent":["/*!\n * FilePond 4.13.6\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined'\n    ? factory(exports)\n    : typeof define === 'function' && define.amd\n    ? define(['exports'], factory)\n    : ((global = global || self), factory((global.FilePond = {})));\n})(this, function(exports) {\n  'use strict';\n\n  var isNode = function isNode(value) {\n    return value instanceof HTMLElement;\n  };\n\n  var createStore = function createStore(initialState) {\n    var queries =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var actions =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    // internal state\n    var state = Object.assign({}, initialState);\n\n    // contains all actions for next frame, is clear when actions are requested\n    var actionQueue = [];\n    var dispatchQueue = [];\n\n    // returns a duplicate of the current state\n    var getState = function getState() {\n      return Object.assign({}, state);\n    };\n\n    // returns a duplicate of the actions array and clears the actions array\n    var processActionQueue = function processActionQueue() {\n      // create copy of actions queue\n      var queue = [].concat(actionQueue);\n\n      // clear actions queue (we don't want no double actions)\n      actionQueue.length = 0;\n\n      return queue;\n    };\n\n    // processes actions that might block the main UI thread\n    var processDispatchQueue = function processDispatchQueue() {\n      // create copy of actions queue\n      var queue = [].concat(dispatchQueue);\n\n      // clear actions queue (we don't want no double actions)\n      dispatchQueue.length = 0;\n\n      // now dispatch these actions\n      queue.forEach(function(_ref) {\n        var type = _ref.type,\n          data = _ref.data;\n        dispatch(type, data);\n      });\n    };\n\n    // adds a new action, calls its handler and\n    var dispatch = function dispatch(type, data, isBlocking) {\n      // is blocking action (should never block if document is hidden)\n      if (isBlocking && !document.hidden) {\n        dispatchQueue.push({ type: type, data: data });\n        return;\n      }\n\n      // if this action has a handler, handle the action\n      if (actionHandlers[type]) {\n        actionHandlers[type](data);\n      }\n\n      // now add action\n      actionQueue.push({\n        type: type,\n        data: data\n      });\n    };\n\n    var query = function query(str) {\n      var _queryHandles;\n      for (\n        var _len = arguments.length,\n          args = new Array(_len > 1 ? _len - 1 : 0),\n          _key = 1;\n        _key < _len;\n        _key++\n      ) {\n        args[_key - 1] = arguments[_key];\n      }\n      return queryHandles[str]\n        ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args)\n        : null;\n    };\n\n    var api = {\n      getState: getState,\n      processActionQueue: processActionQueue,\n      processDispatchQueue: processDispatchQueue,\n      dispatch: dispatch,\n      query: query\n    };\n\n    var queryHandles = {};\n    queries.forEach(function(query) {\n      queryHandles = Object.assign({}, query(state), {}, queryHandles);\n    });\n\n    var actionHandlers = {};\n    actions.forEach(function(action) {\n      actionHandlers = Object.assign(\n        {},\n        action(dispatch, query, state),\n        {},\n        actionHandlers\n      );\n    });\n\n    return api;\n  };\n\n  var defineProperty = function defineProperty(obj, property, definition) {\n    if (typeof definition === 'function') {\n      obj[property] = definition;\n      return;\n    }\n    Object.defineProperty(obj, property, Object.assign({}, definition));\n  };\n\n  var forin = function forin(obj, cb) {\n    for (var key in obj) {\n      if (!obj.hasOwnProperty(key)) {\n        continue;\n      }\n\n      cb(key, obj[key]);\n    }\n  };\n\n  var createObject = function createObject(definition) {\n    var obj = {};\n    forin(definition, function(property) {\n      defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n  };\n\n  var attr = function attr(node, name) {\n    var value =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    if (value === null) {\n      return node.getAttribute(name) || node.hasAttribute(name);\n    }\n    node.setAttribute(name, value);\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svgElements = ['svg', 'path']; // only svg elements used\n\n  var isSVGElement = function isSVGElement(tag) {\n    return svgElements.includes(tag);\n  };\n\n  var createElement = function createElement(tag, className) {\n    var attributes =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    if (typeof className === 'object') {\n      attributes = className;\n      className = null;\n    }\n    var element = isSVGElement(tag)\n      ? document.createElementNS(ns, tag)\n      : document.createElement(tag);\n    if (className) {\n      if (isSVGElement(tag)) {\n        attr(element, 'class', className);\n      } else {\n        element.className = className;\n      }\n    }\n    forin(attributes, function(name, value) {\n      attr(element, name, value);\n    });\n    return element;\n  };\n\n  var appendChild = function appendChild(parent) {\n    return function(child, index) {\n      if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n      } else {\n        parent.appendChild(child);\n      }\n    };\n  };\n\n  var appendChildView = function appendChildView(parent, childViews) {\n    return function(view, index) {\n      if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n      } else {\n        childViews.push(view);\n      }\n\n      return view;\n    };\n  };\n\n  var removeChildView = function removeChildView(parent, childViews) {\n    return function(view) {\n      // remove from child views\n      childViews.splice(childViews.indexOf(view), 1);\n\n      // remove the element\n      if (view.element.parentNode) {\n        parent.removeChild(view.element);\n      }\n\n      return view;\n    };\n  };\n\n  var IS_BROWSER = (function() {\n    return (\n      typeof window !== 'undefined' && typeof window.document !== 'undefined'\n    );\n  })();\n  var isBrowser = function isBrowser() {\n    return IS_BROWSER;\n  };\n\n  var testElement = isBrowser() ? createElement('svg') : {};\n  var getChildCount =\n    'children' in testElement\n      ? function(el) {\n          return el.children.length;\n        }\n      : function(el) {\n          return el.childNodes.length;\n        };\n\n  var getViewRect = function getViewRect(\n    elementRect,\n    childViews,\n    offset,\n    scale\n  ) {\n    var left = offset[0] || elementRect.left;\n    var top = offset[1] || elementRect.top;\n    var right = left + elementRect.width;\n    var bottom = top + elementRect.height * (scale[1] || 1);\n\n    var rect = {\n      // the rectangle of the element itself\n      element: Object.assign({}, elementRect),\n\n      // the rectangle of the element expanded to contain its children, does not include any margins\n      inner: {\n        left: elementRect.left,\n        top: elementRect.top,\n        right: elementRect.right,\n        bottom: elementRect.bottom\n      },\n\n      // the rectangle of the element expanded to contain its children including own margin and child margins\n      // margins will be added after we've recalculated the size\n      outer: {\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      }\n    };\n\n    // expand rect to fit all child rectangles\n    childViews\n      .filter(function(childView) {\n        return !childView.isRectIgnored();\n      })\n      .map(function(childView) {\n        return childView.rect;\n      })\n      .forEach(function(childViewRect) {\n        expandRect(rect.inner, Object.assign({}, childViewRect.inner));\n        expandRect(rect.outer, Object.assign({}, childViewRect.outer));\n      });\n\n    // calculate inner width and height\n    calculateRectSize(rect.inner);\n\n    // append additional margin (top and left margins are included in top and left automatically)\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight;\n\n    // calculate outer width and height\n    calculateRectSize(rect.outer);\n\n    return rect;\n  };\n\n  var expandRect = function expandRect(parent, child) {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n\n    if (child.bottom > parent.bottom) {\n      parent.bottom = child.bottom;\n    }\n\n    if (child.right > parent.right) {\n      parent.right = child.right;\n    }\n  };\n\n  var calculateRectSize = function calculateRectSize(rect) {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n  };\n\n  var isNumber = function isNumber(value) {\n    return typeof value === 'number';\n  };\n\n  /**\n   * Determines if position is at destination\n   * @param position\n   * @param destination\n   * @param velocity\n   * @param errorMargin\n   * @returns {boolean}\n   */\n  var thereYet = function thereYet(position, destination, velocity) {\n    var errorMargin =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;\n    return (\n      Math.abs(position - destination) < errorMargin &&\n      Math.abs(velocity) < errorMargin\n    );\n  };\n\n  /**\n   * Spring animation\n   */\n  var spring =\n    // default options\n    function spring() // method definition\n    {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$stiffness = _ref.stiffness,\n        stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,\n        _ref$damping = _ref.damping,\n        damping = _ref$damping === void 0 ? 0.75 : _ref$damping,\n        _ref$mass = _ref.mass,\n        mass = _ref$mass === void 0 ? 10 : _ref$mass;\n      var target = null;\n      var position = null;\n      var velocity = 0;\n      var resting = false;\n\n      // updates spring state\n      var interpolate = function interpolate(ts, skipToEndState) {\n        // in rest, don't animate\n        if (resting) return;\n\n        // need at least a target or position to do springy things\n        if (!(isNumber(target) && isNumber(position))) {\n          resting = true;\n          velocity = 0;\n          return;\n        }\n\n        // calculate spring force\n        var f = -(position - target) * stiffness;\n\n        // update velocity by adding force based on mass\n        velocity += f / mass;\n\n        // update position by adding velocity\n        position += velocity;\n\n        // slow down based on amount of damping\n        velocity *= damping;\n\n        // we've arrived if we're near target and our velocity is near zero\n        if (thereYet(position, target, velocity) || skipToEndState) {\n          position = target;\n          velocity = 0;\n          resting = true;\n\n          // we done\n          api.onupdate(position);\n          api.oncomplete(position);\n        } else {\n          // progress update\n          api.onupdate(position);\n        }\n      };\n\n      /**\n       * Set new target value\n       * @param value\n       */\n      var setTarget = function setTarget(value) {\n        // if currently has no position, set target and position to this value\n        if (isNumber(value) && !isNumber(position)) {\n          position = value;\n        }\n\n        // next target value will not be animated to\n        if (target === null) {\n          target = value;\n          position = value;\n        }\n\n        // let start moving to target\n        target = value;\n\n        // already at target\n        if (position === target || typeof target === 'undefined') {\n          // now resting as target is current position, stop moving\n          resting = true;\n          velocity = 0;\n\n          // done!\n          api.onupdate(position);\n          api.oncomplete(position);\n\n          return;\n        }\n\n        resting = false;\n      };\n\n      // need 'api' to call onupdate callback\n      var api = createObject({\n        interpolate: interpolate,\n        target: {\n          set: setTarget,\n          get: function get() {\n            return target;\n          }\n        },\n\n        resting: {\n          get: function get() {\n            return resting;\n          }\n        },\n\n        onupdate: function onupdate(value) {},\n        oncomplete: function oncomplete(value) {}\n      });\n\n      return api;\n    };\n\n  var easeLinear = function easeLinear(t) {\n    return t;\n  };\n  var easeInOutQuad = function easeInOutQuad(t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n  };\n\n  var tween =\n    // default values\n    function tween() // method definition\n    {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$duration = _ref.duration,\n        duration = _ref$duration === void 0 ? 500 : _ref$duration,\n        _ref$easing = _ref.easing,\n        easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,\n        _ref$delay = _ref.delay,\n        delay = _ref$delay === void 0 ? 0 : _ref$delay;\n      var start = null;\n      var t;\n      var p;\n      var resting = true;\n      var reverse = false;\n      var target = null;\n\n      var interpolate = function interpolate(ts, skipToEndState) {\n        if (resting || target === null) return;\n\n        if (start === null) {\n          start = ts;\n        }\n\n        if (ts - start < delay) return;\n\n        t = ts - start - delay;\n\n        if (t >= duration || skipToEndState) {\n          t = 1;\n          p = reverse ? 0 : 1;\n          api.onupdate(p * target);\n          api.oncomplete(p * target);\n          resting = true;\n        } else {\n          p = t / duration;\n          api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n        }\n      };\n\n      // need 'api' to call onupdate callback\n      var api = createObject({\n        interpolate: interpolate,\n        target: {\n          get: function get() {\n            return reverse ? 0 : target;\n          },\n          set: function set(value) {\n            // is initial value\n            if (target === null) {\n              target = value;\n              api.onupdate(value);\n              api.oncomplete(value);\n              return;\n            }\n\n            // want to tween to a smaller value and have a current value\n            if (value < target) {\n              target = 1;\n              reverse = true;\n            } else {\n              // not tweening to a smaller value\n              reverse = false;\n              target = value;\n            }\n\n            // let's go!\n            resting = false;\n            start = null;\n          }\n        },\n\n        resting: {\n          get: function get() {\n            return resting;\n          }\n        },\n\n        onupdate: function onupdate(value) {},\n        oncomplete: function oncomplete(value) {}\n      });\n\n      return api;\n    };\n\n  var animator = {\n    spring: spring,\n    tween: tween\n  };\n\n  /*\n                       { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n                       { translation: { type: 'spring', ... }, ... }\n                       { translation: { x: { type: 'spring', ... } } }\n                      */\n  var createAnimator = function createAnimator(definition, category, property) {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    var def =\n      definition[category] && typeof definition[category][property] === 'object'\n        ? definition[category][property]\n        : definition[category] || definition;\n\n    var type = typeof def === 'string' ? def : def.type;\n    var props = typeof def === 'object' ? Object.assign({}, def) : {};\n\n    return animator[type] ? animator[type](props) : null;\n  };\n\n  var addGetSet = function addGetSet(keys, obj, props) {\n    var overwrite =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(function(o) {\n      keys.forEach(function(key) {\n        var name = key;\n        var getter = function getter() {\n          return props[key];\n        };\n        var setter = function setter(value) {\n          return (props[key] = value);\n        };\n\n        if (typeof key === 'object') {\n          name = key.key;\n          getter = key.getter || getter;\n          setter = key.setter || setter;\n        }\n\n        if (o[name] && !overwrite) {\n          return;\n        }\n\n        o[name] = {\n          get: getter,\n          set: setter\n        };\n      });\n    });\n  };\n\n  // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // setup animators\n\n  var animations = function animations(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI;\n    // initial properties\n    var initialProps = Object.assign({}, viewProps);\n\n    // list of all active animations\n    var animations = [];\n\n    // setup animators\n    forin(mixinConfig, function(property, animation) {\n      var animator = createAnimator(animation);\n      if (!animator) {\n        return;\n      }\n\n      // when the animator updates, update the view state value\n      animator.onupdate = function(value) {\n        viewProps[property] = value;\n      };\n\n      // set animator target\n      animator.target = initialProps[property];\n\n      // when value is set, set the animator target value\n      var prop = {\n        key: property,\n        setter: function setter(value) {\n          // if already at target, we done!\n          if (animator.target === value) {\n            return;\n          }\n\n          animator.target = value;\n        },\n        getter: function getter() {\n          return viewProps[property];\n        }\n      };\n\n      // add getters and setters\n      addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);\n\n      // add it to the list for easy updating from the _write method\n      animations.push(animator);\n    });\n\n    // expose internal write api\n    return {\n      write: function write(ts) {\n        var skipToEndState = document.hidden;\n        var resting = true;\n        animations.forEach(function(animation) {\n          if (!animation.resting) resting = false;\n          animation.interpolate(ts, skipToEndState);\n        });\n        return resting;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var addEvent = function addEvent(element) {\n    return function(type, fn) {\n      element.addEventListener(type, fn);\n    };\n  };\n\n  var removeEvent = function removeEvent(element) {\n    return function(type, fn) {\n      element.removeEventListener(type, fn);\n    };\n  };\n\n  // mixin\n  var listeners = function listeners(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      viewState = _ref.viewState,\n      view = _ref.view;\n    var events = [];\n\n    var add = addEvent(view.element);\n    var remove = removeEvent(view.element);\n\n    viewExternalAPI.on = function(type, fn) {\n      events.push({\n        type: type,\n        fn: fn\n      });\n\n      add(type, fn);\n    };\n\n    viewExternalAPI.off = function(type, fn) {\n      events.splice(\n        events.findIndex(function(event) {\n          return event.type === type && event.fn === fn;\n        }),\n        1\n      );\n\n      remove(type, fn);\n    };\n\n    return {\n      write: function write() {\n        // not busy\n        return true;\n      },\n      destroy: function destroy() {\n        events.forEach(function(event) {\n          remove(event.type, event.fn);\n        });\n      }\n    };\n  };\n\n  // add to external api and link to props\n\n  var apis = function apis(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewExternalAPI = _ref.viewExternalAPI;\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n\n  // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // set initial state based on props in viewProps\n  // apply as transforms each frame\n\n  var defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0\n  };\n\n  var styles = function styles(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      view = _ref.view;\n    // initial props\n    var initialProps = Object.assign({}, viewProps);\n\n    // current props\n    var currentProps = {};\n\n    // we will add those properties to the external API and link them to the viewState\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);\n\n    // override rect on internal and external rect getter so it takes in account transforms\n    var getOffset = function getOffset() {\n      return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    };\n\n    var getScale = function getScale() {\n      return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    };\n    var getRect = function getRect() {\n      return view.rect\n        ? getViewRect(view.rect, view.childViews, getOffset(), getScale())\n        : null;\n    };\n    viewInternalAPI.rect = { get: getRect };\n    viewExternalAPI.rect = { get: getRect };\n\n    // apply view props\n    mixinConfig.forEach(function(key) {\n      viewProps[key] =\n        typeof initialProps[key] === 'undefined'\n          ? defaults[key]\n          : initialProps[key];\n    });\n\n    // expose api\n    return {\n      write: function write() {\n        // see if props have changed\n        if (!propsHaveChanged(currentProps, viewProps)) {\n          return;\n        }\n\n        // moves element to correct position on screen\n        applyStyles(view.element, viewProps);\n\n        // store new transforms\n        Object.assign(currentProps, Object.assign({}, viewProps));\n\n        // no longer busy\n        return true;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n      return true;\n    }\n\n    // lets analyze the individual props\n    for (var prop in newProps) {\n      if (newProps[prop] !== currentProps[prop]) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var applyStyles = function applyStyles(element, _ref2) {\n    var opacity = _ref2.opacity,\n      perspective = _ref2.perspective,\n      translateX = _ref2.translateX,\n      translateY = _ref2.translateY,\n      scaleX = _ref2.scaleX,\n      scaleY = _ref2.scaleY,\n      rotateX = _ref2.rotateX,\n      rotateY = _ref2.rotateY,\n      rotateZ = _ref2.rotateZ,\n      originX = _ref2.originX,\n      originY = _ref2.originY,\n      width = _ref2.width,\n      height = _ref2.height;\n\n    var transforms = '';\n    var styles = '';\n\n    // handle transform origin\n    if (isDefined(originX) || isDefined(originY)) {\n      styles +=\n        'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';\n    }\n\n    // transform order is relevant\n    // 0. perspective\n    if (isDefined(perspective)) {\n      transforms += 'perspective(' + perspective + 'px) ';\n    }\n\n    // 1. translate\n    if (isDefined(translateX) || isDefined(translateY)) {\n      transforms +=\n        'translate3d(' +\n        (translateX || 0) +\n        'px, ' +\n        (translateY || 0) +\n        'px, 0) ';\n    }\n\n    // 2. scale\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n      transforms +=\n        'scale3d(' +\n        (isDefined(scaleX) ? scaleX : 1) +\n        ', ' +\n        (isDefined(scaleY) ? scaleY : 1) +\n        ', 1) ';\n    }\n\n    // 3. rotate\n    if (isDefined(rotateZ)) {\n      transforms += 'rotateZ(' + rotateZ + 'rad) ';\n    }\n\n    if (isDefined(rotateX)) {\n      transforms += 'rotateX(' + rotateX + 'rad) ';\n    }\n\n    if (isDefined(rotateY)) {\n      transforms += 'rotateY(' + rotateY + 'rad) ';\n    }\n\n    // add transforms\n    if (transforms.length) {\n      styles += 'transform:' + transforms + ';';\n    }\n\n    // add opacity\n    if (isDefined(opacity)) {\n      styles += 'opacity:' + opacity + ';';\n\n      // if we reach zero, we make the element inaccessible\n      if (opacity === 0) {\n        styles += 'visibility:hidden;';\n      }\n\n      // if we're below 100% opacity this element can't be clicked\n      if (opacity < 1) {\n        styles += 'pointer-events:none;';\n      }\n    }\n\n    // add height\n    if (isDefined(height)) {\n      styles += 'height:' + height + 'px;';\n    }\n\n    // add width\n    if (isDefined(width)) {\n      styles += 'width:' + width + 'px;';\n    }\n\n    // apply styles\n    var elementCurrentStyle = element.elementCurrentStyle || '';\n\n    // if new styles does not match current styles, lets update!\n    if (\n      styles.length !== elementCurrentStyle.length ||\n      styles !== elementCurrentStyle\n    ) {\n      element.style.cssText = styles;\n      // store current styles so we can compare them to new styles later on\n      // _not_ getting the style value is faster\n      element.elementCurrentStyle = styles;\n    }\n  };\n\n  var Mixins = {\n    styles: styles,\n    listeners: listeners,\n    animations: animations,\n    apis: apis\n  };\n\n  var updateRect = function updateRect() {\n    var rect =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var element =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var style =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!element.layoutCalculated) {\n      rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n      rect.marginTop = parseInt(style.marginTop, 10) || 0;\n      rect.marginRight = parseInt(style.marginRight, 10) || 0;\n      rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n      rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n      element.layoutCalculated = true;\n    }\n\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n\n    rect.scrollTop = element.scrollTop;\n\n    rect.hidden = element.offsetParent === null;\n\n    return rect;\n  };\n\n  var createView =\n    // default view definition\n    function createView() {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$tag = _ref.tag,\n        tag = _ref$tag === void 0 ? 'div' : _ref$tag,\n        _ref$name = _ref.name,\n        name = _ref$name === void 0 ? null : _ref$name,\n        _ref$attributes = _ref.attributes,\n        attributes = _ref$attributes === void 0 ? {} : _ref$attributes,\n        _ref$read = _ref.read,\n        read = _ref$read === void 0 ? function() {} : _ref$read,\n        _ref$write = _ref.write,\n        write = _ref$write === void 0 ? function() {} : _ref$write,\n        _ref$create = _ref.create,\n        create = _ref$create === void 0 ? function() {} : _ref$create,\n        _ref$destroy = _ref.destroy,\n        destroy = _ref$destroy === void 0 ? function() {} : _ref$destroy,\n        _ref$filterFrameActio = _ref.filterFrameActionsForChild,\n        filterFrameActionsForChild =\n          _ref$filterFrameActio === void 0\n            ? function(child, actions) {\n                return actions;\n              }\n            : _ref$filterFrameActio,\n        _ref$didCreateView = _ref.didCreateView,\n        didCreateView =\n          _ref$didCreateView === void 0 ? function() {} : _ref$didCreateView,\n        _ref$didWriteView = _ref.didWriteView,\n        didWriteView =\n          _ref$didWriteView === void 0 ? function() {} : _ref$didWriteView,\n        _ref$ignoreRect = _ref.ignoreRect,\n        ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,\n        _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,\n        ignoreRectUpdate =\n          _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,\n        _ref$mixins = _ref.mixins,\n        mixins = _ref$mixins === void 0 ? [] : _ref$mixins;\n      return function(\n        // each view requires reference to store\n        store\n      ) {\n        var props =\n          arguments.length > 1 && arguments[1] !== undefined\n            ? arguments[1]\n            : {};\n        // root element should not be changed\n        var element = createElement(tag, 'filepond--' + name, attributes);\n\n        // style reference should also not be changed\n        var style = window.getComputedStyle(element, null);\n\n        // element rectangle\n        var rect = updateRect();\n        var frameRect = null;\n\n        // rest state\n        var isResting = false;\n\n        // pretty self explanatory\n        var childViews = [];\n\n        // loaded mixins\n        var activeMixins = [];\n\n        // references to created children\n        var ref = {};\n\n        // state used for each instance\n        var state = {};\n\n        // list of writers that will be called to update this view\n        var writers = [\n          write // default writer\n        ];\n\n        var readers = [\n          read // default reader\n        ];\n\n        var destroyers = [\n          destroy // default destroy\n        ];\n\n        // core view methods\n        var getElement = function getElement() {\n          return element;\n        };\n        var getChildViews = function getChildViews() {\n          return childViews.concat();\n        };\n        var getReference = function getReference() {\n          return ref;\n        };\n        var createChildView = function createChildView(store) {\n          return function(view, props) {\n            return view(store, props);\n          };\n        };\n        var getRect = function getRect() {\n          if (frameRect) {\n            return frameRect;\n          }\n          frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n          return frameRect;\n        };\n        var getStyle = function getStyle() {\n          return style;\n        };\n\n        /**\n         * Read data from DOM\n         * @private\n         */\n        var _read = function _read() {\n          frameRect = null;\n\n          // read child views\n          childViews.forEach(function(child) {\n            return child._read();\n          });\n\n          var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n          if (shouldUpdate) {\n            updateRect(rect, element, style);\n          }\n\n          // readers\n          var api = { root: internalAPI, props: props, rect: rect };\n          readers.forEach(function(reader) {\n            return reader(api);\n          });\n        };\n\n        /**\n         * Write data to DOM\n         * @private\n         */\n        var _write = function _write(ts, frameActions, shouldOptimize) {\n          // if no actions, we assume that the view is resting\n          var resting = frameActions.length === 0;\n\n          // writers\n          writers.forEach(function(writer) {\n            var writerResting = writer({\n              props: props,\n              root: internalAPI,\n              actions: frameActions,\n              timestamp: ts,\n              shouldOptimize: shouldOptimize\n            });\n\n            if (writerResting === false) {\n              resting = false;\n            }\n          });\n\n          // run mixins\n          activeMixins.forEach(function(mixin) {\n            // if one of the mixins is still busy after write operation, we are not resting\n            var mixinResting = mixin.write(ts);\n            if (mixinResting === false) {\n              resting = false;\n            }\n          });\n\n          // updates child views that are currently attached to the DOM\n          childViews\n            .filter(function(child) {\n              return !!child.element.parentNode;\n            })\n            .forEach(function(child) {\n              // if a child view is not resting, we are not resting\n              var childResting = child._write(\n                ts,\n                filterFrameActionsForChild(child, frameActions),\n                shouldOptimize\n              );\n\n              if (!childResting) {\n                resting = false;\n              }\n            });\n\n          // append new elements to DOM and update those\n          childViews\n            //.filter(child => !child.element.parentNode)\n            .forEach(function(child, index) {\n              // skip\n              if (child.element.parentNode) {\n                return;\n              }\n\n              // append to DOM\n              internalAPI.appendChild(child.element, index);\n\n              // call read (need to know the size of these elements)\n              child._read();\n\n              // re-call write\n              child._write(\n                ts,\n                filterFrameActionsForChild(child, frameActions),\n                shouldOptimize\n              );\n\n              // we just added somthing to the dom, no rest\n              resting = false;\n            });\n\n          // update resting state\n          isResting = resting;\n\n          didWriteView({\n            props: props,\n            root: internalAPI,\n            actions: frameActions,\n            timestamp: ts\n          });\n\n          // let parent know if we are resting\n          return resting;\n        };\n\n        var _destroy = function _destroy() {\n          activeMixins.forEach(function(mixin) {\n            return mixin.destroy();\n          });\n          destroyers.forEach(function(destroyer) {\n            destroyer({ root: internalAPI, props: props });\n          });\n          childViews.forEach(function(child) {\n            return child._destroy();\n          });\n        };\n\n        // sharedAPI\n        var sharedAPIDefinition = {\n          element: {\n            get: getElement\n          },\n\n          style: {\n            get: getStyle\n          },\n\n          childViews: {\n            get: getChildViews\n          }\n        };\n\n        // private API definition\n        var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n          rect: {\n            get: getRect\n          },\n\n          // access to custom children references\n          ref: {\n            get: getReference\n          },\n\n          // dom modifiers\n          is: function is(needle) {\n            return name === needle;\n          },\n          appendChild: appendChild(element),\n          createChildView: createChildView(store),\n          linkView: function linkView(view) {\n            childViews.push(view);\n            return view;\n          },\n          unlinkView: function unlinkView(view) {\n            childViews.splice(childViews.indexOf(view), 1);\n          },\n          appendChildView: appendChildView(element, childViews),\n          removeChildView: removeChildView(element, childViews),\n          registerWriter: function registerWriter(writer) {\n            return writers.push(writer);\n          },\n          registerReader: function registerReader(reader) {\n            return readers.push(reader);\n          },\n          registerDestroyer: function registerDestroyer(destroyer) {\n            return destroyers.push(destroyer);\n          },\n          invalidateLayout: function invalidateLayout() {\n            return (element.layoutCalculated = false);\n          },\n\n          // access to data store\n          dispatch: store.dispatch,\n          query: store.query\n        });\n\n        // public view API methods\n        var externalAPIDefinition = {\n          element: {\n            get: getElement\n          },\n\n          childViews: {\n            get: getChildViews\n          },\n\n          rect: {\n            get: getRect\n          },\n\n          resting: {\n            get: function get() {\n              return isResting;\n            }\n          },\n\n          isRectIgnored: function isRectIgnored() {\n            return ignoreRect;\n          },\n          _read: _read,\n          _write: _write,\n          _destroy: _destroy\n        };\n\n        // mixin API methods\n        var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n          rect: {\n            get: function get() {\n              return rect;\n            }\n          }\n        });\n\n        // add mixin functionality\n        Object.keys(mixins)\n          .sort(function(a, b) {\n            // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n            if (a === 'styles') {\n              return 1;\n            } else if (b === 'styles') {\n              return -1;\n            }\n            return 0;\n          })\n          .forEach(function(key) {\n            var mixinAPI = Mixins[key]({\n              mixinConfig: mixins[key],\n              viewProps: props,\n              viewState: state,\n              viewInternalAPI: internalAPIDefinition,\n              viewExternalAPI: externalAPIDefinition,\n              view: createObject(mixinAPIDefinition)\n            });\n\n            if (mixinAPI) {\n              activeMixins.push(mixinAPI);\n            }\n          });\n\n        // construct private api\n        var internalAPI = createObject(internalAPIDefinition);\n\n        // create the view\n        create({\n          root: internalAPI,\n          props: props\n        });\n\n        // append created child views to root node\n        var childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\n        childViews.forEach(function(child, index) {\n          internalAPI.appendChild(child.element, childCount + index);\n        });\n\n        // call did create\n        didCreateView(internalAPI);\n\n        // expose public api\n        return createObject(externalAPIDefinition);\n      };\n    };\n\n  var createPainter = function createPainter(read, write) {\n    var fps =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;\n\n    var name = '__framePainter';\n\n    // set global painter\n    if (window[name]) {\n      window[name].readers.push(read);\n      window[name].writers.push(write);\n      return;\n    }\n\n    window[name] = {\n      readers: [read],\n      writers: [write]\n    };\n\n    var painter = window[name];\n\n    var interval = 1000 / fps;\n    var last = null;\n    var id = null;\n    var requestTick = null;\n    var cancelTick = null;\n\n    var setTimerType = function setTimerType() {\n      if (document.hidden) {\n        requestTick = function requestTick() {\n          return window.setTimeout(function() {\n            return tick(performance.now());\n          }, interval);\n        };\n        cancelTick = function cancelTick() {\n          return window.clearTimeout(id);\n        };\n      } else {\n        requestTick = function requestTick() {\n          return window.requestAnimationFrame(tick);\n        };\n        cancelTick = function cancelTick() {\n          return window.cancelAnimationFrame(id);\n        };\n      }\n    };\n\n    document.addEventListener('visibilitychange', function() {\n      if (cancelTick) cancelTick();\n      setTimerType();\n      tick(performance.now());\n    });\n\n    var tick = function tick(ts) {\n      // queue next tick\n      id = requestTick(tick);\n\n      // limit fps\n      if (!last) {\n        last = ts;\n      }\n\n      var delta = ts - last;\n\n      if (delta <= interval) {\n        // skip frame\n        return;\n      }\n\n      // align next frame\n      last = ts - (delta % interval);\n\n      // update view\n      painter.readers.forEach(function(read) {\n        return read();\n      });\n      painter.writers.forEach(function(write) {\n        return write(ts);\n      });\n    };\n\n    setTimerType();\n    tick(performance.now());\n\n    return {\n      pause: function pause() {\n        cancelTick(id);\n      }\n    };\n  };\n\n  var createRoute = function createRoute(routes, fn) {\n    return function(_ref) {\n      var root = _ref.root,\n        props = _ref.props,\n        _ref$actions = _ref.actions,\n        actions = _ref$actions === void 0 ? [] : _ref$actions,\n        timestamp = _ref.timestamp,\n        shouldOptimize = _ref.shouldOptimize;\n      actions\n        .filter(function(action) {\n          return routes[action.type];\n        })\n        .forEach(function(action) {\n          return routes[action.type]({\n            root: root,\n            props: props,\n            action: action.data,\n            timestamp: timestamp,\n            shouldOptimize: shouldOptimize\n          });\n        });\n\n      if (fn) {\n        fn({\n          root: root,\n          props: props,\n          actions: actions,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      }\n    };\n  };\n\n  var insertBefore = function insertBefore(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode);\n  };\n\n  var insertAfter = function insertAfter(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(\n      newNode,\n      referenceNode.nextSibling\n    );\n  };\n\n  var isArray = function isArray(value) {\n    return Array.isArray(value);\n  };\n\n  var isEmpty = function isEmpty(value) {\n    return value == null;\n  };\n\n  var trim = function trim(str) {\n    return str.trim();\n  };\n\n  var toString = function toString(value) {\n    return '' + value;\n  };\n\n  var toArray = function toArray(value) {\n    var splitter =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n    if (isEmpty(value)) {\n      return [];\n    }\n    if (isArray(value)) {\n      return value;\n    }\n    return toString(value)\n      .split(splitter)\n      .map(trim)\n      .filter(function(str) {\n        return str.length;\n      });\n  };\n\n  var isBoolean = function isBoolean(value) {\n    return typeof value === 'boolean';\n  };\n\n  var toBoolean = function toBoolean(value) {\n    return isBoolean(value) ? value : value === 'true';\n  };\n\n  var isString = function isString(value) {\n    return typeof value === 'string';\n  };\n\n  var toNumber = function toNumber(value) {\n    return isNumber(value)\n      ? value\n      : isString(value)\n      ? toString(value).replace(/[a-z]+/gi, '')\n      : 0;\n  };\n\n  var toInt = function toInt(value) {\n    return parseInt(toNumber(value), 10);\n  };\n\n  var toFloat = function toFloat(value) {\n    return parseFloat(toNumber(value));\n  };\n\n  var isInt = function isInt(value) {\n    return isNumber(value) && isFinite(value) && Math.floor(value) === value;\n  };\n\n  var toBytes = function toBytes(value) {\n    // is in bytes\n    if (isInt(value)) {\n      return value;\n    }\n\n    // is natural file size\n    var naturalFileSize = toString(value).trim();\n\n    // if is value in megabytes\n    if (/MB$/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n      return toInt(naturalFileSize) * 1000 * 1000;\n    }\n\n    // if is value in kilobytes\n    if (/KB/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n      return toInt(naturalFileSize) * 1000;\n    }\n\n    return toInt(naturalFileSize);\n  };\n\n  var isFunction = function isFunction(value) {\n    return typeof value === 'function';\n  };\n\n  var toFunctionReference = function toFunctionReference(string) {\n    var ref = self;\n    var levels = string.split('.');\n    var level = null;\n    while ((level = levels.shift())) {\n      ref = ref[level];\n      if (!ref) {\n        return null;\n      }\n    }\n    return ref;\n  };\n\n  var methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET'\n  };\n\n  var createServerAPI = function createServerAPI(outline) {\n    var api = {};\n\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n\n    forin(methods, function(key) {\n      api[key] = createAction(\n        key,\n        outline[key],\n        methods[key],\n        api.timeout,\n        api.headers\n      );\n    });\n\n    // special treatment for remove\n    api.remove = outline.remove || null;\n\n    // remove generic headers from api object\n    delete api.headers;\n\n    return api;\n  };\n\n  var createAction = function createAction(\n    name,\n    outline,\n    method,\n    timeout,\n    headers\n  ) {\n    // is explicitely set to null so disable\n    if (outline === null) {\n      return null;\n    }\n\n    // if is custom function, done! Dev handles everything.\n    if (typeof outline === 'function') {\n      return outline;\n    }\n\n    // build action object\n    var action = {\n      url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',\n      method: method,\n      headers: headers,\n      withCredentials: false,\n      timeout: timeout,\n      onload: null,\n      ondata: null,\n      onerror: null\n    };\n\n    // is a single url\n    if (isString(outline)) {\n      action.url = outline;\n      return action;\n    }\n\n    // overwrite\n    Object.assign(action, outline);\n\n    // see if should reformat headers;\n    if (isString(action.headers)) {\n      var parts = action.headers.split(/:(.+)/);\n      action.headers = {\n        header: parts[0],\n        value: parts[1]\n      };\n    }\n\n    // if is bool withCredentials\n    action.withCredentials = toBoolean(action.withCredentials);\n\n    return action;\n  };\n\n  var toServerAPI = function toServerAPI(value) {\n    return createServerAPI(value);\n  };\n\n  var isNull = function isNull(value) {\n    return value === null;\n  };\n\n  var isObject = function isObject(value) {\n    return typeof value === 'object' && value !== null;\n  };\n\n  var isAPI = function isAPI(value) {\n    return (\n      isObject(value) &&\n      isString(value.url) &&\n      isObject(value.process) &&\n      isObject(value.revert) &&\n      isObject(value.restore) &&\n      isObject(value.fetch)\n    );\n  };\n\n  var getType = function getType(value) {\n    if (isArray(value)) {\n      return 'array';\n    }\n\n    if (isNull(value)) {\n      return 'null';\n    }\n\n    if (isInt(value)) {\n      return 'int';\n    }\n\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n      return 'bytes';\n    }\n\n    if (isAPI(value)) {\n      return 'api';\n    }\n\n    return typeof value;\n  };\n\n  var replaceSingleQuotes = function replaceSingleQuotes(str) {\n    return str\n      .replace(/{\\s*'/g, '{\"')\n      .replace(/'\\s*}/g, '\"}')\n      .replace(/'\\s*:/g, '\":')\n      .replace(/:\\s*'/g, ':\"')\n      .replace(/,\\s*'/g, ',\"')\n      .replace(/'\\s*,/g, '\",');\n  };\n\n  var conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: function int(value) {\n      return getType(value) === 'bytes' ? toBytes(value) : toInt(value);\n    },\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: function string(value) {\n      return isFunction(value) ? value : toString(value);\n    },\n    function: function _function(value) {\n      return toFunctionReference(value);\n    },\n    serverapi: toServerAPI,\n    object: function object(value) {\n      try {\n        return JSON.parse(replaceSingleQuotes(value));\n      } catch (e) {\n        return null;\n      }\n    }\n  };\n\n  var convertTo = function convertTo(value, type) {\n    return conversionTable[type](value);\n  };\n\n  var getValueByType = function getValueByType(\n    newValue,\n    defaultValue,\n    valueType\n  ) {\n    // can always assign default value\n    if (newValue === defaultValue) {\n      return newValue;\n    }\n\n    // get the type of the new value\n    var newValueType = getType(newValue);\n\n    // is valid type?\n    if (newValueType !== valueType) {\n      // is string input, let's attempt to convert\n      var convertedValue = convertTo(newValue, valueType);\n\n      // what is the type now\n      newValueType = getType(convertedValue);\n\n      // no valid conversions found\n      if (convertedValue === null) {\n        throw 'Trying to assign value with incorrect type to \"' +\n          option +\n          '\", allowed type: \"' +\n          valueType +\n          '\"';\n      } else {\n        newValue = convertedValue;\n      }\n    }\n\n    // assign new value\n    return newValue;\n  };\n\n  var createOption = function createOption(defaultValue, valueType) {\n    var currentValue = defaultValue;\n    return {\n      enumerable: true,\n      get: function get() {\n        return currentValue;\n      },\n      set: function set(newValue) {\n        currentValue = getValueByType(newValue, defaultValue, valueType);\n      }\n    };\n  };\n\n  var createOptions = function createOptions(options) {\n    var obj = {};\n    forin(options, function(prop) {\n      var optionDefinition = options[prop];\n      obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n  };\n\n  var createInitialState = function createInitialState(options) {\n    return {\n      // model\n      items: [],\n\n      // timeout used for calling update items\n      listUpdateTimeout: null,\n\n      // timeout used for stacking metadata updates\n      itemUpdateTimeout: null,\n\n      // queue of items waiting to be processed\n      processingQueue: [],\n\n      // options\n      options: createOptions(options)\n    };\n  };\n\n  var fromCamels = function fromCamels(string) {\n    var separator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string\n      .split(/(?=[A-Z])/)\n      .map(function(part) {\n        return part.toLowerCase();\n      })\n      .join(separator);\n  };\n\n  var createOptionAPI = function createOptionAPI(store, options) {\n    var obj = {};\n    forin(options, function(key) {\n      obj[key] = {\n        get: function get() {\n          return store.getState().options[key];\n        },\n        set: function set(value) {\n          store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        }\n      };\n    });\n    return obj;\n  };\n\n  var createOptionActions = function createOptionActions(options) {\n    return function(dispatch, query, state) {\n      var obj = {};\n      forin(options, function(key) {\n        var name = fromCamels(key, '_').toUpperCase();\n\n        obj['SET_' + name] = function(action) {\n          try {\n            state.options[key] = action.value;\n          } catch (e) {} // nope, failed\n\n          // we successfully set the value of this option\n          dispatch('DID_SET_' + name, { value: state.options[key] });\n        };\n      });\n      return obj;\n    };\n  };\n\n  var createOptionQueries = function createOptionQueries(options) {\n    return function(state) {\n      var obj = {};\n      forin(options, function(key) {\n        obj['GET_' + fromCamels(key, '_').toUpperCase()] = function(action) {\n          return state.options[key];\n        };\n      });\n      return obj;\n    };\n  };\n\n  var InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5\n  };\n\n  var getUniqueId = function getUniqueId() {\n    return Math.random()\n      .toString(36)\n      .substr(2, 9);\n  };\n\n  var arrayRemove = function arrayRemove(arr, index) {\n    return arr.splice(index, 1);\n  };\n\n  var _fire = function fire(cb) {\n    if (document.hidden) {\n      Promise.resolve(1).then(cb);\n    } else {\n      setTimeout(cb, 0);\n    }\n  };\n\n  var on = function on() {\n    var listeners = [];\n    var off = function off(event, cb) {\n      arrayRemove(\n        listeners,\n        listeners.findIndex(function(listener) {\n          return listener.event === event && (listener.cb === cb || !cb);\n        })\n      );\n    };\n    return {\n      fire: function fire(event) {\n        for (\n          var _len = arguments.length,\n            args = new Array(_len > 1 ? _len - 1 : 0),\n            _key = 1;\n          _key < _len;\n          _key++\n        ) {\n          args[_key - 1] = arguments[_key];\n        }\n        listeners\n          .filter(function(listener) {\n            return listener.event === event;\n          })\n          .map(function(listener) {\n            return listener.cb;\n          })\n          .forEach(function(cb) {\n            return _fire(function() {\n              return cb.apply(void 0, args);\n            });\n          });\n      },\n      on: function on(event, cb) {\n        listeners.push({ event: event, cb: cb });\n      },\n      onOnce: function onOnce(event, _cb) {\n        listeners.push({\n          event: event,\n          cb: function cb() {\n            off(event, _cb);\n            _cb.apply(void 0, arguments);\n          }\n        });\n      },\n      off: off\n    };\n  };\n\n  var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(\n    src,\n    target,\n    excluded\n  ) {\n    Object.getOwnPropertyNames(src)\n      .filter(function(property) {\n        return !excluded.includes(property);\n      })\n      .forEach(function(key) {\n        return Object.defineProperty(\n          target,\n          key,\n          Object.getOwnPropertyDescriptor(src, key)\n        );\n      });\n  };\n\n  var PRIVATE = [\n    'fire',\n    'process',\n    'revert',\n    'load',\n    'on',\n    'off',\n    'onOnce',\n    'retryLoad',\n    'extend',\n    'archive',\n    'archived',\n    'release',\n    'released',\n    'requestProcessing',\n    'freeze'\n  ];\n\n  var createItemAPI = function createItemAPI(item) {\n    var api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n  };\n\n  var removeReleasedItems = function removeReleasedItems(items) {\n    items.forEach(function(item, index) {\n      if (item.released) {\n        arrayRemove(items, index);\n      }\n    });\n  };\n\n  var ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8\n  };\n\n  var FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3\n  };\n\n  var getNonNumeric = function getNonNumeric(str) {\n    return /[^0-9]+/.exec(str);\n  };\n\n  var getDecimalSeparator = function getDecimalSeparator() {\n    return getNonNumeric((1.1).toLocaleString())[0];\n  };\n\n  var getThousandsSeparator = function getThousandsSeparator() {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    var decimalSeparator = getDecimalSeparator();\n    var thousandsStringWithSeparator = (1000.0).toLocaleString();\n    var thousandsStringWithoutSeparator = (1000.0).toString();\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n      return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n    return decimalSeparator === '.' ? ',' : '.';\n  };\n\n  var Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex'\n  };\n\n  // all registered filters\n  var filters = [];\n\n  // loops over matching filters and passes options to each filter, returning the mapped results\n  var applyFilterChain = function applyFilterChain(key, value, utils) {\n    return new Promise(function(resolve, reject) {\n      // find matching filters for this key\n      var matchingFilters = filters\n        .filter(function(f) {\n          return f.key === key;\n        })\n        .map(function(f) {\n          return f.cb;\n        });\n\n      // resolve now\n      if (matchingFilters.length === 0) {\n        resolve(value);\n        return;\n      }\n\n      // first filter to kick things of\n      var initialFilter = matchingFilters.shift();\n\n      // chain filters\n      matchingFilters\n        .reduce(\n          // loop over promises passing value to next promise\n          function(current, next) {\n            return current.then(function(value) {\n              return next(value, utils);\n            });\n          },\n\n          // call initial filter, will return a promise\n          initialFilter(value, utils)\n\n          // all executed\n        )\n        .then(function(value) {\n          return resolve(value);\n        })\n        .catch(function(error) {\n          return reject(error);\n        });\n    });\n  };\n\n  var applyFilters = function applyFilters(key, value, utils) {\n    return filters\n      .filter(function(f) {\n        return f.key === key;\n      })\n      .map(function(f) {\n        return f.cb(value, utils);\n      });\n  };\n\n  // adds a new filter to the list\n  var addFilter = function addFilter(key, cb) {\n    return filters.push({ key: key, cb: cb });\n  };\n\n  var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {\n    return Object.assign(defaultOptions, additionalOptions);\n  };\n\n  var getOptions = function getOptions() {\n    return Object.assign({}, defaultOptions);\n  };\n\n  var setOptions = function setOptions(opts) {\n    forin(opts, function(key, value) {\n      // key does not exist, so this option cannot be set\n      if (!defaultOptions[key]) {\n        return;\n      }\n      defaultOptions[key][0] = getValueByType(\n        value,\n        defaultOptions[key][0],\n        defaultOptions[key][1]\n      );\n    });\n  };\n\n  // default options on app\n  var defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n\n    // input field name to use\n    name: ['filepond', Type.STRING],\n\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n\n    // is the field required\n    required: [false, Type.BOOLEAN],\n\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN], // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN], // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN], // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN], // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN], // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN], // Allows user to revert file upload\n    allowReorder: [false, Type.BOOLEAN], // Allow reordering of files\n    allowDirectoriesOnly: [false, Type.BOOLEAN], // Allow only selecting directories with browse (no support for filtering dnd at this point)\n\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN], // Set to 'force' to require the file to be reverted before removal\n\n    // Input requirements\n    maxFiles: [null, Type.INT], // Max number of files\n    checkValidity: [false, Type.BOOLEAN], // Enables custom validity messages\n\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN], // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING], // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN], // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN], // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN], // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN], // Should upload files immidiately on drop\n    maxParallelUploads: [2, Type.INT], // Maximum files to upload in parallel\n\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN], // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN], // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT], // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.Array], // Amount of times to retry upload of a chunk when it fails\n\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n\n    // Labels and status messages\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING], // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING], // Default is locale separator\n\n    labelIdle: [\n      'Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>',\n      Type.STRING\n    ],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING], // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING], // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconProcess: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>',\n      Type.STRING\n    ],\n\n    iconRetry: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconUndo: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconDone: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n    onreorderfiles: [null, Type.FUNCTION],\n\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n\n    // styles\n    stylePanelLayout: [null, Type.STRING], // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING], // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n    styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\n\n    // custom initial files array\n    files: [[], Type.ARRAY]\n  };\n\n  var getItemByQuery = function getItemByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return items[0] || null;\n    }\n\n    // query is index\n    if (isInt(query)) {\n      return items[query] || null;\n    }\n\n    // if query is item, get the id\n    if (typeof query === 'object') {\n      query = query.id;\n    }\n\n    // assume query is a string and return item by id\n    return (\n      items.find(function(item) {\n        return item.id === query;\n      }) || null\n    );\n  };\n\n  var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(\n    aspectRatio\n  ) {\n    if (isEmpty(aspectRatio)) {\n      return aspectRatio;\n    }\n    if (/:/.test(aspectRatio)) {\n      var parts = aspectRatio.split(':');\n      return parts[1] / parts[0];\n    }\n    return parseFloat(aspectRatio);\n  };\n\n  var getActiveItems = function getActiveItems(items) {\n    return items.filter(function(item) {\n      return !item.archived;\n    });\n  };\n\n  var Status = {\n    EMPTY: 0,\n    IDLE: 1, // waiting\n    ERROR: 2, // a file is in error state\n    BUSY: 3, // busy processing or loading\n    READY: 4 // all files uploaded\n  };\n\n  var ITEM_ERROR = [\n    ItemStatus.LOAD_ERROR,\n    ItemStatus.PROCESSING_ERROR,\n    ItemStatus.PROCESSING_REVERT_ERROR\n  ];\n  var ITEM_BUSY = [\n    ItemStatus.LOADING,\n    ItemStatus.PROCESSING,\n    ItemStatus.PROCESSING_QUEUED,\n    ItemStatus.INIT\n  ];\n  var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\n  var isItemInErrorState = function isItemInErrorState(item) {\n    return ITEM_ERROR.includes(item.status);\n  };\n  var isItemInBusyState = function isItemInBusyState(item) {\n    return ITEM_BUSY.includes(item.status);\n  };\n  var isItemInReadyState = function isItemInReadyState(item) {\n    return ITEM_READY.includes(item.status);\n  };\n\n  var queries = function queries(state) {\n    return {\n      GET_STATUS: function GET_STATUS() {\n        var items = getActiveItems(state.items);\n        var EMPTY = Status.EMPTY,\n          ERROR = Status.ERROR,\n          BUSY = Status.BUSY,\n          IDLE = Status.IDLE,\n          READY = Status.READY;\n\n        if (items.length === 0) return EMPTY;\n\n        if (items.some(isItemInErrorState)) return ERROR;\n\n        if (items.some(isItemInBusyState)) return BUSY;\n\n        if (items.some(isItemInReadyState)) return READY;\n\n        return IDLE;\n      },\n\n      GET_ITEM: function GET_ITEM(query) {\n        return getItemByQuery(state.items, query);\n      },\n\n      GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {\n        return getItemByQuery(getActiveItems(state.items), query);\n      },\n\n      GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {\n        return getActiveItems(state.items);\n      },\n\n      GET_ITEMS: function GET_ITEMS() {\n        return state.items;\n      },\n\n      GET_ITEM_NAME: function GET_ITEM_NAME(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n      },\n\n      GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n      },\n\n      GET_STYLES: function GET_STYLES() {\n        return Object.keys(state.options)\n          .filter(function(key) {\n            return /^style/.test(key);\n          })\n          .map(function(option) {\n            return {\n              name: option,\n              value: state.options[option]\n            };\n          });\n      },\n\n      GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {\n        var isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        var aspectRatio = isShapeCircle\n          ? 1\n          : getNumericAspectRatioFromString(\n              state.options.stylePanelAspectRatio\n            );\n        return aspectRatio;\n      },\n\n      GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {\n        return state.options.styleItemPanelAspectRatio;\n      },\n\n      GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {\n        return getActiveItems(state.items).filter(function(item) {\n          return item.status === status;\n        });\n      },\n\n      GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {\n        return getActiveItems(state.items).length;\n      },\n\n      IS_ASYNC: function IS_ASYNC() {\n        return (\n          isObject(state.options.server) &&\n          (isObject(state.options.server.process) ||\n            isFunction(state.options.server.process))\n        );\n      }\n    };\n  };\n\n  var hasRoomForItem = function hasRoomForItem(state) {\n    var count = getActiveItems(state.items).length;\n\n    // if cannot have multiple items, to add one item it should currently not contain items\n    if (!state.options.allowMultiple) {\n      return count === 0;\n    }\n\n    // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n    var maxFileCount = state.options.maxFiles;\n    if (maxFileCount === null) {\n      return true;\n    }\n\n    // we check if the current count is smaller than the max count, if so, another file can still be added\n    if (count < maxFileCount) {\n      return true;\n    }\n\n    // no more room for another file\n    return false;\n  };\n\n  var limit = function limit(value, min, max) {\n    return Math.max(Math.min(max, value), min);\n  };\n\n  var arrayInsert = function arrayInsert(arr, index, item) {\n    return arr.splice(index, 0, item);\n  };\n\n  var insertItem = function insertItem(items, item, index) {\n    if (isEmpty(item)) {\n      return null;\n    }\n\n    // if index is undefined, append\n    if (typeof index === 'undefined') {\n      items.push(item);\n      return item;\n    }\n\n    // limit the index to the size of the items array\n    index = limit(index, 0, items.length);\n\n    // add item to array\n    arrayInsert(items, index, item);\n\n    // expose\n    return item;\n  };\n\n  var isBase64DataURI = function isBase64DataURI(str) {\n    return /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(\n      str\n    );\n  };\n\n  var getFilenameFromURL = function getFilenameFromURL(url) {\n    return url\n      .split('/')\n      .pop()\n      .split('?')\n      .shift();\n  };\n\n  var getExtensionFromFilename = function getExtensionFromFilename(name) {\n    return name.split('.').pop();\n  };\n\n  var guesstimateExtension = function guesstimateExtension(type) {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n      return '';\n    }\n\n    // get subtype\n    var subtype = type.split('/').pop();\n\n    // is svg subtype\n    if (/svg/.test(subtype)) {\n      return 'svg';\n    }\n\n    if (/zip|compressed/.test(subtype)) {\n      return 'zip';\n    }\n\n    if (/plain/.test(subtype)) {\n      return 'txt';\n    }\n\n    if (/msword/.test(subtype)) {\n      return 'doc';\n    }\n\n    // if is valid subtype\n    if (/[a-z]+/.test(subtype)) {\n      // always use jpg extension\n      if (subtype === 'jpeg') {\n        return 'jpg';\n      }\n\n      // return subtype\n      return subtype;\n    }\n\n    return '';\n  };\n\n  var leftPad = function leftPad(value) {\n    var padding =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    return (padding + value).slice(-padding.length);\n  };\n\n  var getDateString = function getDateString() {\n    var date =\n      arguments.length > 0 && arguments[0] !== undefined\n        ? arguments[0]\n        : new Date();\n    return (\n      date.getFullYear() +\n      '-' +\n      leftPad(date.getMonth() + 1, '00') +\n      '-' +\n      leftPad(date.getDate(), '00') +\n      '_' +\n      leftPad(date.getHours(), '00') +\n      '-' +\n      leftPad(date.getMinutes(), '00') +\n      '-' +\n      leftPad(date.getSeconds(), '00')\n    );\n  };\n\n  var getFileFromBlob = function getFileFromBlob(blob, filename) {\n    var type =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var extension =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    var file =\n      typeof type === 'string'\n        ? blob.slice(0, blob.size, type)\n        : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date();\n\n    // copy relative path\n    if (blob._relativePath) file._relativePath = blob._relativePath;\n\n    // if blob has name property, use as filename if no filename supplied\n    if (!isString(filename)) {\n      filename = getDateString();\n    }\n\n    // if filename supplied but no extension and filename has extension\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n      file.name = filename;\n    } else {\n      extension = extension || guesstimateExtension(file.type);\n      file.name = filename + (extension ? '.' + extension : '');\n    }\n\n    return file;\n  };\n\n  var getBlobBuilder = function getBlobBuilder() {\n    return (window.BlobBuilder =\n      window.BlobBuilder ||\n      window.WebKitBlobBuilder ||\n      window.MozBlobBuilder ||\n      window.MSBlobBuilder);\n  };\n\n  var createBlob = function createBlob(arrayBuffer, mimeType) {\n    var BB = getBlobBuilder();\n\n    if (BB) {\n      var bb = new BB();\n      bb.append(arrayBuffer);\n      return bb.getBlob(mimeType);\n    }\n\n    return new Blob([arrayBuffer], {\n      type: mimeType\n    });\n  };\n\n  var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(\n    byteString,\n    mimeType\n  ) {\n    var ab = new ArrayBuffer(byteString.length);\n    var ia = new Uint8Array(ab);\n\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n\n    return createBlob(ab, mimeType);\n  };\n\n  var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(\n    dataURI\n  ) {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n  };\n\n  var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(\n    dataURI\n  ) {\n    // get data part of string (remove data:image/jpeg...,)\n    var data = dataURI.split(',')[1];\n\n    // remove any whitespace as that causes InvalidCharacterError in IE\n    return data.replace(/\\s/g, '');\n  };\n\n  var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(\n    dataURI\n  ) {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n  };\n\n  var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {\n    var mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    var byteString = getByteStringFromBase64DataURI(dataURI);\n\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n  };\n\n  var getFileFromBase64DataURI = function getFileFromBase64DataURI(\n    dataURI,\n    filename,\n    extension\n  ) {\n    return getFileFromBlob(\n      getBlobFromBase64DataURI(dataURI),\n      filename,\n      null,\n      extension\n    );\n  };\n\n  var getFileNameFromHeader = function getFileNameFromHeader(header) {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null;\n\n    // get filename parts\n    var matches = header\n      .split(/filename=|filename\\*=.+''/)\n      .splice(1)\n      .map(function(name) {\n        return name.trim().replace(/^[\"']|[;\"']{0,2}$/g, '');\n      })\n      .filter(function(name) {\n        return name.length;\n      });\n\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n  };\n\n  var getFileSizeFromHeader = function getFileSizeFromHeader(header) {\n    if (/content-length:/i.test(header)) {\n      var size = header.match(/[0-9]+/)[0];\n      return size ? parseInt(size, 10) : null;\n    }\n    return null;\n  };\n\n  var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {\n    if (/x-content-transfer-id:/i.test(header)) {\n      var id = (header.split(':')[1] || '').trim();\n      return id || null;\n    }\n    return null;\n  };\n\n  var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {\n    var info = {\n      source: null,\n      name: null,\n      size: null\n    };\n\n    var rows = headers.split('\\n');\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n    try {\n      for (\n        var _iterator = rows[Symbol.iterator](), _step;\n        !(_iteratorNormalCompletion = (_step = _iterator.next()).done);\n        _iteratorNormalCompletion = true\n      ) {\n        var header = _step.value;\n\n        var name = getFileNameFromHeader(header);\n        if (name) {\n          info.name = name;\n          continue;\n        }\n\n        var size = getFileSizeFromHeader(header);\n        if (size) {\n          info.size = size;\n          continue;\n        }\n\n        var source = getTranfserIdFromHeader(header);\n        if (source) {\n          info.source = source;\n          continue;\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    return info;\n  };\n\n  var createFileLoader = function createFileLoader(fetchFn) {\n    var state = {\n      source: null,\n      complete: false,\n      progress: 0,\n      size: null,\n      timestamp: null,\n      duration: 0,\n      request: null\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress;\n    };\n    var abort = function abort() {\n      if (state.request && state.request.abort) {\n        state.request.abort();\n      }\n    };\n\n    // load source\n    var load = function load() {\n      // get quick reference\n      var source = state.source;\n\n      api.fire('init', source);\n\n      // Load Files\n      if (source instanceof File) {\n        api.fire('load', source);\n      } else if (source instanceof Blob) {\n        // Load blobs, set default name to current date\n        api.fire('load', getFileFromBlob(source, source.name));\n      } else if (isBase64DataURI(source)) {\n        // Load base 64, set default name to current date\n        api.fire('load', getFileFromBase64DataURI(source));\n      } else {\n        // Deal as if is external URL, let's load it!\n        loadURL(source);\n      }\n    };\n\n    // loads a url\n    var loadURL = function loadURL(url) {\n      // is remote url and no fetch method supplied\n      if (!fetchFn) {\n        api.fire('error', {\n          type: 'error',\n          body: \"Can't load URL\",\n          code: 400\n        });\n\n        return;\n      }\n\n      // set request start\n      state.timestamp = Date.now();\n\n      // load file\n      state.request = fetchFn(\n        url,\n        function(response) {\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // done!\n          state.complete = true;\n\n          // turn blob response into a file\n          if (response instanceof Blob) {\n            response = getFileFromBlob(\n              response,\n              response.name || getFilenameFromURL(url)\n            );\n          }\n\n          api.fire(\n            'load',\n            // if has received blob, we go with blob, if no response, we return null\n            response instanceof Blob\n              ? response\n              : response\n              ? response.body\n              : null\n          );\n        },\n        function(error) {\n          api.fire(\n            'error',\n            typeof error === 'string'\n              ? {\n                  type: 'error',\n                  code: 0,\n                  body: error\n                }\n              : error\n          );\n        },\n        function(computable, current, total) {\n          // collected some meta data already\n          if (total) {\n            state.size = total;\n          }\n\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // if we can't compute progress, we're not going to fire progress events\n          if (!computable) {\n            state.progress = null;\n            return;\n          }\n\n          // update progress percentage\n          state.progress = current / total;\n\n          // expose\n          api.fire('progress', state.progress);\n        },\n        function() {\n          api.fire('abort');\n        },\n        function(response) {\n          var fileinfo = getFileInfoFromHeaders(\n            typeof response === 'string' ? response : response.headers\n          );\n          api.fire('meta', {\n            size: state.size || fileinfo.size,\n            filename: fileinfo.name,\n            source: fileinfo.source\n          });\n        }\n      );\n    };\n\n    var api = Object.assign({}, on(), {\n      setSource: function setSource(source) {\n        return (state.source = source);\n      },\n      getProgress: getProgress, // file load progress\n      abort: abort, // abort file load\n      load: load // start load\n    });\n\n    return api;\n  };\n\n  var isGet = function isGet(method) {\n    return /GET|HEAD/.test(method);\n  };\n\n  var sendRequest = function sendRequest(data, url, options) {\n    var api = {\n      onheaders: function onheaders() {},\n      onprogress: function onprogress() {},\n      onload: function onload() {},\n      ontimeout: function ontimeout() {},\n      onerror: function onerror() {},\n      onabort: function onabort() {},\n      abort: function abort() {\n        aborted = true;\n        xhr.abort();\n      }\n    };\n\n    // timeout identifier, only used when timeout is defined\n    var aborted = false;\n    var headersReceived = false;\n\n    // set default options\n    options = Object.assign(\n      {\n        method: 'POST',\n        headers: {},\n        withCredentials: false\n      },\n      options\n    );\n\n    // encode url\n    url = encodeURI(url);\n\n    // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n      url =\n        '' +\n        url +\n        encodeURIComponent(\n          typeof data === 'string' ? data : JSON.stringify(data)\n        );\n    }\n\n    // create request\n    var xhr = new XMLHttpRequest();\n\n    // progress of load\n    var process = isGet(options.method) ? xhr : xhr.upload;\n    process.onprogress = function(e) {\n      // no progress event when aborted ( onprogress is called once after abort() )\n      if (aborted) {\n        return;\n      }\n\n      api.onprogress(e.lengthComputable, e.loaded, e.total);\n    };\n\n    // tries to get header info to the app as fast as possible\n    xhr.onreadystatechange = function() {\n      // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n      if (xhr.readyState < 2) {\n        return;\n      }\n\n      // no server response\n      if (xhr.readyState === 4 && xhr.status === 0) {\n        return;\n      }\n\n      if (headersReceived) {\n        return;\n      }\n\n      headersReceived = true;\n\n      // we've probably received some useful data in response headers\n      api.onheaders(xhr);\n    };\n\n    // load successful\n    xhr.onload = function() {\n      // is classified as valid response\n      if (xhr.status >= 200 && xhr.status < 300) {\n        api.onload(xhr);\n      } else {\n        api.onerror(xhr);\n      }\n    };\n\n    // error during load\n    xhr.onerror = function() {\n      return api.onerror(xhr);\n    };\n\n    // request aborted\n    xhr.onabort = function() {\n      aborted = true;\n      api.onabort();\n    };\n\n    // request timeout\n    xhr.ontimeout = function() {\n      return api.ontimeout(xhr);\n    };\n\n    // open up open up!\n    xhr.open(options.method, url, true);\n\n    // set timeout if defined (do it after open so IE11 plays ball)\n    if (isInt(options.timeout)) {\n      xhr.timeout = options.timeout;\n    }\n\n    // add headers\n    Object.keys(options.headers).forEach(function(key) {\n      var value = unescape(encodeURIComponent(options.headers[key]));\n      xhr.setRequestHeader(key, value);\n    });\n\n    // set type of response\n    if (options.responseType) {\n      xhr.responseType = options.responseType;\n    }\n\n    // set credentials\n    if (options.withCredentials) {\n      xhr.withCredentials = true;\n    }\n\n    // let's send our data\n    xhr.send(data);\n\n    return api;\n  };\n\n  var createResponse = function createResponse(type, code, body, headers) {\n    return {\n      type: type,\n      code: code,\n      body: body,\n      headers: headers\n    };\n  };\n\n  var createTimeoutResponse = function createTimeoutResponse(cb) {\n    return function(xhr) {\n      cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n    };\n  };\n\n  var hasQS = function hasQS(str) {\n    return /\\?/.test(str);\n  };\n  var buildURL = function buildURL() {\n    var url = '';\n    for (\n      var _len = arguments.length, parts = new Array(_len), _key = 0;\n      _key < _len;\n      _key++\n    ) {\n      parts[_key] = arguments[_key];\n    }\n    parts.forEach(function(part) {\n      url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\n    });\n    return url;\n  };\n\n  var createFetchFunction = function createFetchFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') {\n      return action;\n    }\n\n    // no action supplied\n    if (!action || !isString(action.url)) {\n      return null;\n    }\n\n    // set onload hanlder\n    var onload =\n      action.onload ||\n      function(res) {\n        return res;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // internal handler\n    return function(url, load, error, progress, abort, headers) {\n      // do local or remote request based on if the url is external\n      var request = sendRequest(\n        url,\n        buildURL(apiUrl, action.url),\n        Object.assign({}, action, {\n          responseType: 'blob'\n        })\n      );\n\n      request.onload = function(xhr) {\n        // get headers\n        var headers = xhr.getAllResponseHeaders();\n\n        // get filename\n        var filename =\n          getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n        // create response\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            action.method === 'HEAD'\n              ? null\n              : getFileFromBlob(onload(xhr.response), filename),\n            headers\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onheaders = function(xhr) {\n        headers(\n          createResponse(\n            'headers',\n            xhr.status,\n            null,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort;\n\n      // should return request\n      return request;\n    };\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function(obj) {\n        return obj &&\n          typeof Symbol === 'function' &&\n          obj.constructor === Symbol &&\n          obj !== Symbol.prototype\n          ? 'symbol'\n          : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE =\n        (typeof Symbol === 'function' &&\n          Symbol['for'] &&\n          Symbol['for']('react.element')) ||\n        0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol !== 'undefined') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function(resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n          function(arg) {\n            if (wrappedAwait) {\n              resume('next', arg);\n              return;\n            }\n\n            settle(result.done ? 'return' : 'normal', arg);\n          },\n          function(err) {\n            resume('throw', err);\n          }\n        );\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function(arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function(arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function(arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function() {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function(resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function() {\n        return this;\n      };\n    }\n\n    iter.next = function(value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function(value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function(value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function() {\n      var self = this,\n        args = arguments;\n      return new Promise(function(resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(\n            gen,\n            resolve,\n            reject,\n            _next,\n            _throw,\n            'next',\n            value\n          );\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends =\n      Object.assign ||\n      function(target) {\n        for (var i = 1; i < arguments.length; i++) {\n          var source = arguments[i];\n\n          for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n              target[key] = source[key];\n            }\n          }\n        }\n\n        return target;\n      };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(\n          Object.getOwnPropertySymbols(source).filter(function(sym) {\n            return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n          })\n        );\n      }\n\n      ownKeys.forEach(function(key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly)\n        symbols = symbols.filter(function(sym) {\n          return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n        });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(source, true).forEach(function(key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(\n          target,\n          Object.getOwnPropertyDescriptors(source)\n        );\n      } else {\n        ownKeys(source).forEach(function(key) {\n          Object.defineProperty(\n            target,\n            key,\n            Object.getOwnPropertyDescriptor(source, key)\n          );\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf\n      ? Object.getPrototypeOf\n      : function _getPrototypeOf(o) {\n          return o.__proto__ || Object.getPrototypeOf(o);\n        };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf =\n      Object.setPrototypeOf ||\n      function _setPrototypeOf(o, p) {\n        o.__proto__ = p;\n        return o;\n      };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError(\n          'Super expression must either be null or a function'\n        );\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (\n      right != null &&\n      typeof Symbol !== 'undefined' &&\n      right[Symbol.hasInstance]\n    ) {\n      return !!right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule\n      ? obj\n      : {\n          default: obj\n        };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc =\n              Object.defineProperty && Object.getOwnPropertyDescriptor\n                ? Object.getOwnPropertyDescriptor(obj, key)\n                : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\n        \"this hasn't been initialised - super() hasn't been called\"\n      );\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(\n      Object.defineProperties(strings, {\n        raw: {\n          value: Object.freeze(raw)\n        }\n      })\n    );\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error(\n      'Class \"' + name + '\" cannot be referenced in computed property keys.'\n    );\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimit(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimitLoose(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return (\n      _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread()\n    );\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)\n        arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (\n      Symbol.iterator in Object(iter) ||\n      Object.prototype.toString.call(iter) === '[object Arguments]'\n    )\n      return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (\n        var _i = arr[Symbol.iterator](), _s;\n        !(_n = (_s = _i.next()).done);\n        _n = true\n      ) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (\n      var _iterator = arr[Symbol.iterator](), _step;\n      !(_step = _iterator.next()).done;\n\n    ) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function() {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error(\n      'Decorating class property failed. Please ensure that ' +\n        'proposal-class-properties is enabled and set to use loose mode. ' +\n        'To use proposal-class-properties in spec mode with decorators, wait for ' +\n        'the next major version of decorators in stage 2.'\n    );\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer\n        ? descriptor.initializer.call(context)\n        : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(\n    target,\n    property,\n    decorators,\n    descriptor,\n    context\n  ) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function(key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators\n      .slice()\n      .reverse()\n      .reduce(function(desc, decorator) {\n        return decorator(target, property, desc) || desc;\n      }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classPrivateFieldDestructureSet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      if (!('__destrObj' in descriptor)) {\n        descriptor.__destrObj = {\n          set value(v) {\n            descriptor.set.call(receiver, v);\n          }\n        };\n      }\n\n      return descriptor.__destrObj;\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      return descriptor;\n    }\n  }\n\n  function _classStaticPrivateFieldSpecGet(\n    receiver,\n    classConstructor,\n    descriptor\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(\n    receiver,\n    classConstructor,\n    descriptor,\n    value\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(\n      _coalesceClassElements(r.d.map(_createElementDescriptor)),\n      decorators\n    );\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function() {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function(O, elements) {\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function(F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            var placement = element.placement;\n\n            if (\n              element.kind === kind &&\n              (placement === 'static' || placement === 'prototype')\n            ) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function(receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function(elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function(element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function(element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(\n            element,\n            placements\n          );\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function(element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function(element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (\n          var decorators = element.decorators, i = decorators.length - 1;\n          i >= 0;\n          i--\n        ) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras(\n            (0, decorators[i])(elementObject) || elementObject\n          );\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function(elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor(\n            (0, decorators[i])(obj) || obj\n          );\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (\n                  elements[j].key === elements[k].key &&\n                  elements[j].placement === elements[k].placement\n                ) {\n                  throw new TypeError(\n                    'Duplicated element (' + elements[j].key + ')'\n                  );\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function(element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function(elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function(elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(\n            elementObject,\n            'finisher',\n            'An element descriptor'\n          );\n          this.disallowProperty(\n            elementObject,\n            'extras',\n            'An element descriptor'\n          );\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function(elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError(\n            'An element descriptor\\'s .kind property must be either \"method\" or' +\n              ' \"field\", but a decorator created an element descriptor with' +\n              ' .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (\n          placement !== 'static' &&\n          placement !== 'prototype' &&\n          placement !== 'own'\n        ) {\n          throw new TypeError(\n            'An element descriptor\\'s .placement property must be one of \"static\",' +\n              ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n              ' with .placement \"' +\n              placement +\n              '\"'\n          );\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(\n          elementObject,\n          'elements',\n          'An element descriptor'\n        );\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(\n            elementObject,\n            'initializer',\n            'A method descriptor'\n          );\n        } else {\n          this.disallowProperty(\n            descriptor,\n            'get',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'set',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'value',\n            'The property descriptor of a field descriptor'\n          );\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function(elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function(elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function(obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError(\n            'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n              ' created a class descriptor with .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function(constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function(obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(\n            objectType + \" can't have a .\" + name + ' property.'\n          );\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static\n        ? 'static'\n        : def.kind === 'field'\n        ? 'own'\n        : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function(other) {\n      return (\n        other.kind === 'method' &&\n        other.key === element.key &&\n        other.placement === element.placement\n      );\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (\n        element.kind === 'method' &&\n        (other = newElements.find(isSameElement))\n      ) {\n        if (\n          _isDataDescriptor(element.descriptor) ||\n          _isDataDescriptor(other.descriptor)\n        ) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError(\n              'Duplicated methods (' + element.key + \") can't be decorated.\"\n            );\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\n                \"Decorators can't be placed on different accessors with for \" +\n                  'the same property (' +\n                  element.key +\n                  ').'\n              );\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return (\n      desc !== undefined &&\n      !(desc.value === undefined && desc.writable === undefined)\n    );\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function(re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function(str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(\n          this,\n          str,\n          substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n            return '$' + groups[name];\n          })\n        );\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function() {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function(groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4\n  };\n\n  /*\n                                                       function signature:\n                                                         (file, metadata, load, error, progress, abort, transfer, options) => {\n                                                           return {\n                                                           abort:() => {}\n                                                         }\n                                                       }\n                                                       */\n\n  // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\n  var processFileChunked = function processFileChunked(\n    apiUrl,\n    action,\n    name,\n    file,\n    metadata,\n    load,\n    error,\n    progress,\n    abort,\n    transfer,\n    options\n  ) {\n    // all chunks\n    var chunks = [];\n    var chunkTransferId = options.chunkTransferId,\n      chunkServer = options.chunkServer,\n      chunkSize = options.chunkSize,\n      chunkRetryDelays = options.chunkRetryDelays;\n\n    // default state\n    var state = {\n      serverId: chunkTransferId,\n      aborted: false\n    };\n\n    // set onload handlers\n    var ondata =\n      action.ondata ||\n      function(fd) {\n        return fd;\n      };\n    var onload =\n      action.onload ||\n      function(xhr, method) {\n        return method === 'HEAD'\n          ? xhr.getResponseHeader('Upload-Offset')\n          : xhr.response;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // create server hook\n    var requestTransferId = function requestTransferId(cb) {\n      var formData = new FormData();\n\n      // add metadata under same name\n      if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n\n      var headers =\n        typeof action.headers === 'function'\n          ? action.headers(file, metadata)\n          : Object.assign({}, action.headers, {\n              'Upload-Length': file.size\n            });\n\n      var requestParams = Object.assign({}, action, {\n        headers: headers\n      });\n\n      // send request object\n      var request = sendRequest(\n        ondata(formData),\n        buildURL(apiUrl, action.url),\n        requestParams\n      );\n\n      request.onload = function(xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function(xhr) {\n        return error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    var requestTransferOffset = function requestTransferOffset(cb) {\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n      var headers =\n        typeof action.headers === 'function'\n          ? action.headers(state.serverId)\n          : Object.assign({}, action.headers);\n\n      var requestParams = {\n        headers: headers,\n        method: 'HEAD'\n      };\n\n      var request = sendRequest(null, requestUrl, requestParams);\n\n      request.onload = function(xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function(xhr) {\n        return error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    // create chunks\n    var lastChunkIndex = Math.floor(file.size / chunkSize);\n    for (var i = 0; i <= lastChunkIndex; i++) {\n      var offset = i * chunkSize;\n      var data = file.slice(\n        offset,\n        offset + chunkSize,\n        'application/offset+octet-stream'\n      );\n      chunks[i] = {\n        index: i,\n        size: data.size,\n        offset: offset,\n        data: data,\n        file: file,\n        progress: 0,\n        retries: _toConsumableArray(chunkRetryDelays),\n        status: ChunkStatus.QUEUED,\n        error: null,\n        request: null,\n        timeout: null\n      };\n    }\n\n    var completeProcessingChunks = function completeProcessingChunks() {\n      return load(state.serverId);\n    };\n\n    var canProcessChunk = function canProcessChunk(chunk) {\n      return (\n        chunk.status === ChunkStatus.QUEUED ||\n        chunk.status === ChunkStatus.ERROR\n      );\n    };\n\n    var processChunk = function processChunk(chunk) {\n      // processing is paused, wait here\n      if (state.aborted) return;\n\n      // get next chunk to process\n      chunk = chunk || chunks.find(canProcessChunk);\n\n      // no more chunks to process\n      if (!chunk) {\n        // all done?\n        if (\n          chunks.every(function(chunk) {\n            return chunk.status === ChunkStatus.COMPLETE;\n          })\n        ) {\n          completeProcessingChunks();\n        }\n\n        // no chunk to handle\n        return;\n      }\n\n      // now processing this chunk\n      chunk.status = ChunkStatus.PROCESSING;\n      chunk.progress = null;\n\n      // allow parsing of formdata\n      var ondata =\n        chunkServer.ondata ||\n        function(fd) {\n          return fd;\n        };\n      var onerror =\n        chunkServer.onerror ||\n        function(res) {\n          return null;\n        };\n\n      // send request object\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n      var headers =\n        typeof chunkServer.headers === 'function'\n          ? chunkServer.headers(chunk)\n          : Object.assign({}, chunkServer.headers, {\n              'Content-Type': 'application/offset+octet-stream',\n              'Upload-Offset': chunk.offset,\n              'Upload-Length': file.size,\n              'Upload-Name': file.name\n            });\n\n      var request = (chunk.request = sendRequest(\n        ondata(chunk.data),\n        requestUrl,\n        Object.assign({}, chunkServer, {\n          headers: headers\n        })\n      ));\n\n      request.onload = function() {\n        // done!\n        chunk.status = ChunkStatus.COMPLETE;\n\n        // remove request reference\n        chunk.request = null;\n\n        // start processing more chunks\n        processChunks();\n      };\n\n      request.onprogress = function(lengthComputable, loaded, total) {\n        chunk.progress = lengthComputable ? loaded : null;\n        updateTotalProgress();\n      };\n\n      request.onerror = function(xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        chunk.error = onerror(xhr.response) || xhr.statusText;\n        if (!retryProcessChunk(chunk)) {\n          error(\n            createResponse(\n              'error',\n              xhr.status,\n              onerror(xhr.response) || xhr.statusText,\n              xhr.getAllResponseHeaders()\n            )\n          );\n        }\n      };\n\n      request.ontimeout = function(xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        if (!retryProcessChunk(chunk)) {\n          createTimeoutResponse(error)(xhr);\n        }\n      };\n\n      request.onabort = function() {\n        chunk.status = ChunkStatus.QUEUED;\n        chunk.request = null;\n        abort();\n      };\n    };\n\n    var retryProcessChunk = function retryProcessChunk(chunk) {\n      // no more retries left\n      if (chunk.retries.length === 0) return false;\n\n      // new retry\n      chunk.status = ChunkStatus.WAITING;\n      clearTimeout(chunk.timeout);\n      chunk.timeout = setTimeout(function() {\n        processChunk(chunk);\n      }, chunk.retries.shift());\n\n      // we're going to retry\n      return true;\n    };\n\n    var updateTotalProgress = function updateTotalProgress() {\n      // calculate total progress fraction\n      var totalBytesTransfered = chunks.reduce(function(p, chunk) {\n        if (p === null || chunk.progress === null) return null;\n        return p + chunk.progress;\n      }, 0);\n\n      // can't compute progress\n      if (totalBytesTransfered === null) return progress(false, 0, 0);\n\n      // calculate progress values\n      var totalSize = chunks.reduce(function(total, chunk) {\n        return total + chunk.size;\n      }, 0);\n\n      // can update progress indicator\n      progress(true, totalBytesTransfered, totalSize);\n    };\n\n    // process new chunks\n    var processChunks = function processChunks() {\n      var totalProcessing = chunks.filter(function(chunk) {\n        return chunk.status === ChunkStatus.PROCESSING;\n      }).length;\n      if (totalProcessing >= 1) return;\n      processChunk();\n    };\n\n    var abortChunks = function abortChunks() {\n      chunks.forEach(function(chunk) {\n        clearTimeout(chunk.timeout);\n        if (chunk.request) {\n          chunk.request.abort();\n        }\n      });\n    };\n\n    // let's go!\n    if (!state.serverId) {\n      requestTransferId(function(serverId) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return;\n\n        // pass back to item so we can use it if something goes wrong\n        transfer(serverId);\n\n        // store internally\n        state.serverId = serverId;\n        processChunks();\n      });\n    } else {\n      requestTransferOffset(function(offset) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return;\n\n        // mark chunks with lower offset as complete\n        chunks\n          .filter(function(chunk) {\n            return chunk.offset < offset;\n          })\n          .forEach(function(chunk) {\n            chunk.status = ChunkStatus.COMPLETE;\n            chunk.progress = chunk.size;\n          });\n\n        // continue processing\n        processChunks();\n      });\n    }\n\n    return {\n      abort: function abort() {\n        state.aborted = true;\n        abortChunks();\n      }\n    };\n  };\n\n  /*\n                                                               function signature:\n                                                                 (file, metadata, load, error, progress, abort) => {\n                                                                   return {\n                                                                   abort:() => {}\n                                                                 }\n                                                               }\n                                                               */\n  var createFileProcessorFunction = function createFileProcessorFunction(\n    apiUrl,\n    action,\n    name,\n    options\n  ) {\n    return function(file, metadata, load, error, progress, abort, transfer) {\n      // no file received\n      if (!file) return;\n\n      // if was passed a file, and we can chunk it, exit here\n      var canChunkUpload = options.chunkUploads;\n      var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n      var willChunkUpload =\n        canChunkUpload && (shouldChunkUpload || options.chunkForce);\n      if (file instanceof Blob && willChunkUpload)\n        return processFileChunked(\n          apiUrl,\n          action,\n          name,\n          file,\n          metadata,\n          load,\n          error,\n          progress,\n          abort,\n          transfer,\n          options\n        );\n\n      // set handlers\n      var ondata =\n        action.ondata ||\n        function(fd) {\n          return fd;\n        };\n      var onload =\n        action.onload ||\n        function(res) {\n          return res;\n        };\n      var onerror =\n        action.onerror ||\n        function(res) {\n          return null;\n        };\n\n      // create formdata object\n      var formData = new FormData();\n\n      // add metadata under same name\n      if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n      }\n\n      // Turn into an array of objects so no matter what the input, we can handle it the same way\n      (file instanceof Blob ? [{ name: null, file: file }] : file).forEach(\n        function(item) {\n          formData.append(\n            name,\n            item.file,\n            item.name === null\n              ? item.file.name\n              : '' + item.name + item.file.name\n          );\n        }\n      );\n\n      // send request object\n      var request = sendRequest(\n        ondata(formData),\n        buildURL(apiUrl, action.url),\n        action\n      );\n      request.onload = function(xhr) {\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            onload(xhr.response),\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort;\n\n      // should return request\n      return request;\n    };\n  };\n\n  var createProcessorFunction = function createProcessorFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    var name = arguments.length > 2 ? arguments[2] : undefined;\n    var options = arguments.length > 3 ? arguments[3] : undefined;\n\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function')\n      return function() {\n        for (\n          var _len = arguments.length, params = new Array(_len), _key = 0;\n          _key < _len;\n          _key++\n        ) {\n          params[_key] = arguments[_key];\n        }\n        return action.apply(void 0, [name].concat(params, [options]));\n      };\n\n    // no action supplied\n    if (!action || !isString(action.url)) return null;\n\n    // internal handler\n    return createFileProcessorFunction(apiUrl, action, name, options);\n  };\n\n  /*\n                                                      function signature:\n                                                      (uniqueFileId, load, error) => { }\n                                                      */\n  var createRevertFunction = function createRevertFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    // is custom implementation\n    if (typeof action === 'function') {\n      return action;\n    }\n\n    // no action supplied, return stub function, interface will work, but file won't be removed\n    if (!action || !isString(action.url)) {\n      return function(uniqueFileId, load) {\n        return load();\n      };\n    }\n\n    // set onload hanlder\n    var onload =\n      action.onload ||\n      function(res) {\n        return res;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // internal implementation\n    return function(uniqueFileId, load, error) {\n      var request = sendRequest(\n        uniqueFileId,\n        apiUrl + action.url,\n        action // contains method, headers and withCredentials properties\n      );\n      request.onload = function(xhr) {\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            onload(xhr.response),\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n\n      return request;\n    };\n  };\n\n  var getRandomNumber = function getRandomNumber() {\n    var min =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var max =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return min + Math.random() * (max - min);\n  };\n\n  var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(\n    cb\n  ) {\n    var duration =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    var offset =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var tickMin =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;\n    var tickMax =\n      arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n    var timeout = null;\n    var start = Date.now();\n\n    var tick = function tick() {\n      var runtime = Date.now() - start;\n      var delay = getRandomNumber(tickMin, tickMax);\n\n      if (runtime + delay > duration) {\n        delay = runtime + delay - duration;\n      }\n\n      var progress = runtime / duration;\n      if (progress >= 1 || document.hidden) {\n        cb(1);\n        return;\n      }\n\n      cb(progress);\n\n      timeout = setTimeout(tick, delay);\n    };\n\n    tick();\n\n    return {\n      clear: function clear() {\n        clearTimeout(timeout);\n      }\n    };\n  };\n\n  var createFileProcessor = function createFileProcessor(processFn) {\n    var state = {\n      complete: false,\n      perceivedProgress: 0,\n      perceivedPerformanceUpdater: null,\n      progress: null,\n      timestamp: null,\n      perceivedDuration: 0,\n      duration: 0,\n      request: null,\n      response: null\n    };\n\n    var process = function process(file, metadata) {\n      var progressFn = function progressFn() {\n        // we've not yet started the real download, stop here\n        // the request might not go through, for instance, there might be some server trouble\n        // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n        if (state.duration === 0 || state.progress === null) {\n          return;\n        }\n\n        // as we're now processing, fire the progress event\n        api.fire('progress', api.getProgress());\n      };\n\n      var completeFn = function completeFn() {\n        state.complete = true;\n        api.fire('load-perceived', state.response.body);\n      };\n\n      // let's start processing\n      api.fire('start');\n\n      // set request start\n      state.timestamp = Date.now();\n\n      // create perceived performance progress indicator\n      state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(\n        function(progress) {\n          state.perceivedProgress = progress;\n          state.perceivedDuration = Date.now() - state.timestamp;\n\n          progressFn();\n\n          // if fake progress is done, and a response has been received,\n          // and we've not yet called the complete method\n          if (\n            state.response &&\n            state.perceivedProgress === 1 &&\n            !state.complete\n          ) {\n            // we done!\n            completeFn();\n          }\n        },\n        // random delay as in a list of files you start noticing\n        // files uploading at the exact same speed\n        getRandomNumber(750, 1500)\n      );\n\n      // remember request so we can abort it later\n      state.request = processFn(\n        // the file to process\n        file,\n\n        // the metadata to send along\n        metadata,\n\n        // callbacks (load, error, progress, abort, transfer)\n        // load expects the body to be a server id if\n        // you want to make use of revert\n        function(response) {\n          // we put the response in state so we can access\n          // it outside of this method\n          state.response = isObject(response)\n            ? response\n            : {\n                type: 'load',\n                code: 200,\n                body: '' + response,\n                headers: {}\n              };\n\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // force progress to 1 as we're now done\n          state.progress = 1;\n\n          // actual load is done let's share results\n          api.fire('load', state.response.body);\n\n          // we are really done\n          // if perceived progress is 1 ( wait for perceived progress to complete )\n          // or if server does not support progress ( null )\n          if (state.perceivedProgress === 1) {\n            completeFn();\n          }\n        },\n\n        // error is expected to be an object with type, code, body\n        function(error) {\n          // cancel updater\n          state.perceivedPerformanceUpdater.clear();\n\n          // update others about this error\n          api.fire(\n            'error',\n            isObject(error)\n              ? error\n              : {\n                  type: 'error',\n                  code: 0,\n                  body: '' + error\n                }\n          );\n        },\n\n        // actual processing progress\n        function(computable, current, total) {\n          // update actual duration\n          state.duration = Date.now() - state.timestamp;\n\n          // update actual progress\n          state.progress = computable ? current / total : null;\n\n          progressFn();\n        },\n\n        // abort does not expect a value\n        function() {\n          // stop updater\n          state.perceivedPerformanceUpdater.clear();\n\n          // fire the abort event so we can switch visuals\n          api.fire('abort', state.response ? state.response.body : null);\n        },\n\n        // register the id for this transfer\n        function(transferId) {\n          api.fire('transfer', transferId);\n        }\n      );\n    };\n\n    var abort = function abort() {\n      // no request running, can't abort\n      if (!state.request) return;\n\n      // stop updater\n      state.perceivedPerformanceUpdater.clear();\n\n      // abort actual request\n      state.request.abort();\n\n      // if has response object, we've completed the request\n      state.complete = true;\n    };\n\n    var reset = function reset() {\n      abort();\n      state.complete = false;\n      state.perceivedProgress = 0;\n      state.progress = 0;\n      state.timestamp = null;\n      state.perceivedDuration = 0;\n      state.duration = 0;\n      state.request = null;\n      state.response = null;\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress\n        ? Math.min(state.progress, state.perceivedProgress)\n        : null;\n    };\n    var getDuration = function getDuration() {\n      return Math.min(state.duration, state.perceivedDuration);\n    };\n\n    var api = Object.assign({}, on(), {\n      process: process, // start processing file\n      abort: abort, // abort active process request\n      getProgress: getProgress,\n      getDuration: getDuration,\n      reset: reset\n    });\n\n    return api;\n  };\n\n  var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n    return name.substr(0, name.lastIndexOf('.')) || name;\n  };\n\n  var createFileStub = function createFileStub(source) {\n    var data = [source.name, source.size, source.type];\n\n    // is blob or base64, then we need to set the name\n    if (source instanceof Blob || isBase64DataURI(source)) {\n      data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n      // if is base64 data uri we need to determine the average size and type\n      data[1] = source.length;\n      data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n      // url\n      data[0] = getFilenameFromURL(source);\n      data[1] = 0;\n      data[2] = 'application/octet-stream';\n    }\n\n    return {\n      name: data[0],\n      size: data[1],\n      type: data[2]\n    };\n  };\n\n  var isFile = function isFile(value) {\n    return !!(value instanceof File || (value instanceof Blob && value.name));\n  };\n\n  var deepCloneObject = function deepCloneObject(src) {\n    if (!isObject(src)) return src;\n    var target = isArray(src) ? [] : {};\n    for (var key in src) {\n      if (!src.hasOwnProperty(key)) continue;\n      var v = src[key];\n      target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n    return target;\n  };\n\n  var createItem = function createItem() {\n    var origin =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var serverFileReference =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var file =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    // unique id for this item, is used to identify the item across views\n    var id = getUniqueId();\n\n    /**\n     * Internal item state\n     */\n    var state = {\n      // is archived\n      archived: false,\n\n      // if is frozen, no longer fires events\n      frozen: false,\n\n      // removed from view\n      released: false,\n\n      // original source\n      source: null,\n\n      // file model reference\n      file: file,\n\n      // id of file on server\n      serverFileReference: serverFileReference,\n\n      // id of file transfer on server\n      transferId: null,\n\n      // is aborted\n      processingAborted: false,\n\n      // current item status\n      status: serverFileReference\n        ? ItemStatus.PROCESSING_COMPLETE\n        : ItemStatus.INIT,\n\n      // active processes\n      activeLoader: null,\n      activeProcessor: null\n    };\n\n    // callback used when abort processing is called to link back to the resolve method\n    var abortProcessingRequestComplete = null;\n\n    /**\n     * Externally added item metadata\n     */\n    var metadata = {};\n\n    // item data\n    var setStatus = function setStatus(status) {\n      return (state.status = status);\n    };\n\n    // fire event unless the item has been archived\n    var fire = function fire(event) {\n      if (state.released || state.frozen) return;\n      for (\n        var _len = arguments.length,\n          params = new Array(_len > 1 ? _len - 1 : 0),\n          _key = 1;\n        _key < _len;\n        _key++\n      ) {\n        params[_key - 1] = arguments[_key];\n      }\n      api.fire.apply(api, [event].concat(params));\n    };\n\n    // file data\n    var getFileExtension = function getFileExtension() {\n      return getExtensionFromFilename(state.file.name);\n    };\n    var getFileType = function getFileType() {\n      return state.file.type;\n    };\n    var getFileSize = function getFileSize() {\n      return state.file.size;\n    };\n    var getFile = function getFile() {\n      return state.file;\n    };\n\n    //\n    // logic to load a file\n    //\n    var load = function load(source, loader, onload) {\n      // remember the original item source\n      state.source = source;\n\n      // file stub is already there\n      if (state.file) {\n        fire('load-skip');\n        return;\n      }\n\n      // set a stub file object while loading the actual data\n      state.file = createFileStub(source);\n\n      // starts loading\n      loader.on('init', function() {\n        fire('load-init');\n      });\n\n      // we'eve received a size indication, let's update the stub\n      loader.on('meta', function(meta) {\n        // set size of file stub\n        state.file.size = meta.size;\n\n        // set name of file stub\n        state.file.filename = meta.filename;\n\n        // if has received source, we done\n        if (meta.source) {\n          origin = FileOrigin.LIMBO;\n          state.serverFileReference = meta.source;\n          state.status = ItemStatus.PROCESSING_COMPLETE;\n        }\n\n        // size has been updated\n        fire('load-meta');\n      });\n\n      // the file is now loading we need to update the progress indicators\n      loader.on('progress', function(progress) {\n        setStatus(ItemStatus.LOADING);\n\n        fire('load-progress', progress);\n      });\n\n      // an error was thrown while loading the file, we need to switch to error state\n      loader.on('error', function(error) {\n        setStatus(ItemStatus.LOAD_ERROR);\n\n        fire('load-request-error', error);\n      });\n\n      // user or another process aborted the file load (cannot retry)\n      loader.on('abort', function() {\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n      });\n\n      // done loading\n      loader.on('load', function(file) {\n        // as we've now loaded the file the loader is no longer required\n        state.activeLoader = null;\n\n        // called when file has loaded succesfully\n        var success = function success(result) {\n          // set (possibly) transformed file\n          state.file = isFile(result) ? result : state.file;\n\n          // file received\n          if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n          } else {\n            setStatus(ItemStatus.IDLE);\n          }\n\n          fire('load');\n        };\n\n        var error = function error(result) {\n          // set original file\n          state.file = file;\n          fire('load-meta');\n\n          setStatus(ItemStatus.LOAD_ERROR);\n          fire('load-file-error', result);\n        };\n\n        // if we already have a server file reference, we don't need to call the onload method\n        if (state.serverFileReference) {\n          success(file);\n          return;\n        }\n\n        // no server id, let's give this file the full treatment\n        onload(file, success, error);\n      });\n\n      // set loader source data\n      loader.setSource(source);\n\n      // set as active loader\n      state.activeLoader = loader;\n\n      // load the source data\n      loader.load();\n    };\n\n    var retryLoad = function retryLoad() {\n      if (!state.activeLoader) {\n        return;\n      }\n      state.activeLoader.load();\n    };\n\n    var abortLoad = function abortLoad() {\n      if (state.activeLoader) {\n        state.activeLoader.abort();\n        return;\n      }\n      setStatus(ItemStatus.INIT);\n      fire('load-abort');\n    };\n\n    //\n    // logic to process a file\n    //\n    var process = function process(processor, onprocess) {\n      // processing was aborted\n      if (state.processingAborted) {\n        state.processingAborted = false;\n        return;\n      }\n\n      // now processing\n      setStatus(ItemStatus.PROCESSING);\n\n      // reset abort callback\n      abortProcessingRequestComplete = null;\n\n      // if no file loaded we'll wait for the load event\n      if (!(state.file instanceof Blob)) {\n        api.on('load', function() {\n          process(processor, onprocess);\n        });\n        return;\n      }\n\n      // setup processor\n      processor.on('load', function(serverFileReference) {\n        // need this id to be able to revert the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n      });\n\n      // register transfer id\n      processor.on('transfer', function(transferId) {\n        // need this id to be able to revert the upload\n        state.transferId = transferId;\n      });\n\n      processor.on('load-perceived', function(serverFileReference) {\n        // no longer required\n        state.activeProcessor = null;\n\n        // need this id to be able to rever the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n\n        setStatus(ItemStatus.PROCESSING_COMPLETE);\n        fire('process-complete', serverFileReference);\n      });\n\n      processor.on('start', function() {\n        fire('process-start');\n      });\n\n      processor.on('error', function(error) {\n        state.activeProcessor = null;\n        setStatus(ItemStatus.PROCESSING_ERROR);\n        fire('process-error', error);\n      });\n\n      processor.on('abort', function(serverFileReference) {\n        state.activeProcessor = null;\n\n        // if file was uploaded but processing was cancelled during perceived processor time store file reference\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n\n        setStatus(ItemStatus.IDLE);\n        fire('process-abort');\n\n        // has timeout so doesn't interfere with remove action\n        if (abortProcessingRequestComplete) {\n          abortProcessingRequestComplete();\n        }\n      });\n\n      processor.on('progress', function(progress) {\n        fire('process-progress', progress);\n      });\n\n      // when successfully transformed\n      var success = function success(file) {\n        // if was archived in the mean time, don't process\n        if (state.archived) return;\n\n        // process file!\n        processor.process(file, Object.assign({}, metadata));\n      };\n\n      // something went wrong during transform phase\n      var error = console.error;\n\n      // start processing the file\n      onprocess(state.file, success, error);\n\n      // set as active processor\n      state.activeProcessor = processor;\n    };\n\n    var requestProcessing = function requestProcessing() {\n      state.processingAborted = false;\n      setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n\n    var abortProcessing = function abortProcessing() {\n      return new Promise(function(resolve) {\n        if (!state.activeProcessor) {\n          state.processingAborted = true;\n\n          setStatus(ItemStatus.IDLE);\n          fire('process-abort');\n\n          resolve();\n          return;\n        }\n\n        abortProcessingRequestComplete = function abortProcessingRequestComplete() {\n          resolve();\n        };\n\n        state.activeProcessor.abort();\n      });\n    };\n\n    //\n    // logic to revert a processed file\n    //\n    var revert = function revert(revertFileUpload, forceRevert) {\n      return new Promise(function(resolve, reject) {\n        // cannot revert without a server id for this process\n        if (state.serverFileReference === null) {\n          resolve();\n          return;\n        }\n\n        // revert the upload (fire and forget)\n        revertFileUpload(\n          state.serverFileReference,\n          function() {\n            // reset file server id as now it's no available on the server\n            state.serverFileReference = null;\n            resolve();\n          },\n          function(error) {\n            // don't set error state when reverting is optional, it will always resolve\n            if (!forceRevert) {\n              resolve();\n              return;\n            }\n\n            // oh no errors\n            setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n            fire('process-revert-error');\n            reject(error);\n          }\n        );\n\n        // fire event\n        setStatus(ItemStatus.IDLE);\n        fire('process-revert');\n      });\n    };\n\n    // exposed methods\n    var _setMetadata = function setMetadata(key, value, silent) {\n      var keys = key.split('.');\n      var root = keys[0];\n      var last = keys.pop();\n      var data = metadata;\n      keys.forEach(function(key) {\n        return (data = data[key]);\n      });\n\n      // compare old value against new value, if they're the same, we're not updating\n      if (JSON.stringify(data[last]) === JSON.stringify(value)) return;\n\n      // update value\n      data[last] = value;\n\n      // don't fire update\n      if (silent) return;\n\n      // fire update\n      fire('metadata-update', {\n        key: root,\n        value: metadata[root]\n      });\n    };\n\n    var getMetadata = function getMetadata(key) {\n      return deepCloneObject(key ? metadata[key] : metadata);\n    };\n\n    var api = Object.assign(\n      {\n        id: {\n          get: function get() {\n            return id;\n          }\n        },\n        origin: {\n          get: function get() {\n            return origin;\n          }\n        },\n        serverId: {\n          get: function get() {\n            return state.serverFileReference;\n          }\n        },\n        transferId: {\n          get: function get() {\n            return state.transferId;\n          }\n        },\n        status: {\n          get: function get() {\n            return state.status;\n          }\n        },\n        filename: {\n          get: function get() {\n            return state.file.name;\n          }\n        },\n        filenameWithoutExtension: {\n          get: function get() {\n            return getFilenameWithoutExtension(state.file.name);\n          }\n        },\n        fileExtension: { get: getFileExtension },\n        fileType: { get: getFileType },\n        fileSize: { get: getFileSize },\n        file: { get: getFile },\n        relativePath: {\n          get: function get() {\n            return state.file._relativePath;\n          }\n        },\n\n        source: {\n          get: function get() {\n            return state.source;\n          }\n        },\n\n        getMetadata: getMetadata,\n        setMetadata: function setMetadata(key, value, silent) {\n          if (isObject(key)) {\n            var data = key;\n            Object.keys(data).forEach(function(key) {\n              _setMetadata(key, data[key], value);\n            });\n            return key;\n          }\n          _setMetadata(key, value, silent);\n          return value;\n        },\n\n        extend: function extend(name, handler) {\n          return (itemAPI[name] = handler);\n        },\n\n        abortLoad: abortLoad,\n        retryLoad: retryLoad,\n        requestProcessing: requestProcessing,\n        abortProcessing: abortProcessing,\n\n        load: load,\n        process: process,\n        revert: revert\n      },\n\n      on(),\n      {\n        freeze: function freeze() {\n          return (state.frozen = true);\n        },\n\n        release: function release() {\n          return (state.released = true);\n        },\n        released: {\n          get: function get() {\n            return state.released;\n          }\n        },\n\n        archive: function archive() {\n          return (state.archived = true);\n        },\n        archived: {\n          get: function get() {\n            return state.archived;\n          }\n        }\n      }\n    );\n\n    // create it here instead of returning it instantly so we can extend it later\n    var itemAPI = createObject(api);\n\n    return itemAPI;\n  };\n\n  var getItemIndexByQuery = function getItemIndexByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return 0;\n    }\n\n    // invalid queries\n    if (!isString(query)) {\n      return -1;\n    }\n\n    // return item by id (or -1 if not found)\n    return items.findIndex(function(item) {\n      return item.id === query;\n    });\n  };\n\n  var getItemById = function getItemById(items, itemId) {\n    var index = getItemIndexByQuery(items, itemId);\n    if (index < 0) {\n      return;\n    }\n    return items[index] || null;\n  };\n\n  var fetchLocal = function fetchLocal(\n    url,\n    load,\n    error,\n    progress,\n    abort,\n    headers\n  ) {\n    var request = sendRequest(null, url, {\n      method: 'GET',\n      responseType: 'blob'\n    });\n\n    request.onload = function(xhr) {\n      // get headers\n      var headers = xhr.getAllResponseHeaders();\n\n      // get filename\n      var filename =\n        getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n      // create response\n      load(\n        createResponse(\n          'load',\n          xhr.status,\n          getFileFromBlob(xhr.response, filename),\n          headers\n        )\n      );\n    };\n\n    request.onerror = function(xhr) {\n      error(\n        createResponse(\n          'error',\n          xhr.status,\n          xhr.statusText,\n          xhr.getAllResponseHeaders()\n        )\n      );\n    };\n\n    request.onheaders = function(xhr) {\n      headers(\n        createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders())\n      );\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort;\n\n    // should return request\n    return request;\n  };\n\n  var getDomainFromURL = function getDomainFromURL(url) {\n    if (url.indexOf('//') === 0) {\n      url = location.protocol + url;\n    }\n    return url\n      .toLowerCase()\n      .replace('blob:', '')\n      .replace(/([a-z])?:\\/\\//, '$1')\n      .split('/')[0];\n  };\n\n  var isExternalURL = function isExternalURL(url) {\n    return (\n      (url.indexOf(':') > -1 || url.indexOf('//') > -1) &&\n      getDomainFromURL(location.href) !== getDomainFromURL(url)\n    );\n  };\n\n  var dynamicLabel = function dynamicLabel(label) {\n    return function() {\n      return isFunction(label) ? label.apply(void 0, arguments) : label;\n    };\n  };\n\n  var isMockItem = function isMockItem(item) {\n    return !isFile(item.file);\n  };\n\n  var listUpdated = function listUpdated(dispatch, state) {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(function() {\n      dispatch('DID_UPDATE_ITEMS', { items: getActiveItems(state.items) });\n    }, 0);\n  };\n\n  var optionalPromise = function optionalPromise(fn) {\n    for (\n      var _len = arguments.length,\n        params = new Array(_len > 1 ? _len - 1 : 0),\n        _key = 1;\n      _key < _len;\n      _key++\n    ) {\n      params[_key - 1] = arguments[_key];\n    }\n    return new Promise(function(resolve) {\n      if (!fn) {\n        return resolve(true);\n      }\n\n      var result = fn.apply(void 0, params);\n\n      if (result == null) {\n        return resolve(true);\n      }\n\n      if (typeof result === 'boolean') {\n        return resolve(result);\n      }\n\n      if (typeof result.then === 'function') {\n        result.then(resolve);\n      }\n    });\n  };\n\n  var sortItems = function sortItems(state, compare) {\n    state.items.sort(function(a, b) {\n      return compare(createItemAPI(a), createItemAPI(b));\n    });\n  };\n\n  // returns item based on state\n  var getItemByQueryFromState = function getItemByQueryFromState(\n    state,\n    itemHandler\n  ) {\n    return function() {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        query = _ref.query,\n        _ref$success = _ref.success,\n        success = _ref$success === void 0 ? function() {} : _ref$success,\n        _ref$failure = _ref.failure,\n        failure = _ref$failure === void 0 ? function() {} : _ref$failure;\n      var item = getItemByQuery(state.items, query);\n      if (!item) {\n        failure({\n          error: createResponse('error', 0, 'Item not found'),\n\n          file: null\n        });\n\n        return;\n      }\n      itemHandler(item, success, failure);\n    };\n  };\n\n  var actions = function actions(dispatch, query, state) {\n    return {\n      /**\n       * Aborts all ongoing processes\n       */\n      ABORT_ALL: function ABORT_ALL() {\n        getActiveItems(state.items).forEach(function(item) {\n          item.freeze();\n          item.abortLoad();\n          item.abortProcessing();\n        });\n      },\n\n      /**\n       * Sets initial files\n       */\n      DID_SET_FILES: function DID_SET_FILES(_ref2) {\n        var _ref2$value = _ref2.value,\n          value = _ref2$value === void 0 ? [] : _ref2$value;\n\n        // map values to file objects\n        var files = value.map(function(file) {\n          return {\n            source: file.source ? file.source : file,\n            options: file.options\n          };\n        });\n\n        // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n        var activeItems = getActiveItems(state.items);\n\n        activeItems.forEach(function(item) {\n          // if item not is in new value, remove\n          if (\n            !files.find(function(file) {\n              return file.source === item.source || file.source === item.file;\n            })\n          ) {\n            dispatch('REMOVE_ITEM', { query: item });\n          }\n        });\n\n        // add new files\n        activeItems = getActiveItems(state.items);\n        files.forEach(function(file, index) {\n          // if file is already in list\n          if (\n            activeItems.find(function(item) {\n              return item.source === file.source || item.file === file.source;\n            })\n          )\n            return;\n\n          // not in list, add\n          dispatch(\n            'ADD_ITEM',\n            Object.assign({}, file, {\n              interactionMethod: InteractionMethod.NONE,\n              index: index\n            })\n          );\n        });\n      },\n\n      DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {\n        var id = _ref3.id;\n\n        // if is called multiple times in close succession we combined all calls together to save resources\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(function() {\n          var item = getItemById(state.items, id);\n\n          // only revert and attempt to upload when we're uploading to a server\n          if (!query('IS_ASYNC')) {\n            // should we update the output data\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function(shouldPrepareOutput) {\n              if (!shouldPrepareOutput) {\n                return;\n              }\n              dispatch(\n                'REQUEST_PREPARE_OUTPUT',\n                {\n                  query: id,\n                  item: item,\n                  success: function success(file) {\n                    dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });\n                  }\n                },\n                true\n              );\n            });\n\n            return;\n          }\n\n          // for async scenarios\n          var upload = function upload() {\n            // we push this forward a bit so the interface is updated correctly\n            setTimeout(function() {\n              dispatch('REQUEST_ITEM_PROCESSING', { query: id });\n            }, 32);\n          };\n\n          var revert = function revert(doUpload) {\n            item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                query('GET_FORCE_REVERT')\n              )\n              .then(doUpload ? upload : function() {})\n              .catch(function() {});\n          };\n\n          var abort = function abort(doUpload) {\n            item.abortProcessing().then(doUpload ? upload : function() {});\n          };\n\n          // if we should re-upload the file immidiately\n          if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n            return revert(state.options.instantUpload);\n          }\n\n          // if currently uploading, cancel upload\n          if (item.status === ItemStatus.PROCESSING) {\n            return abort(state.options.instantUpload);\n          }\n\n          if (state.options.instantUpload) {\n            upload();\n          }\n        }, 0);\n      },\n\n      MOVE_ITEM: function MOVE_ITEM(_ref4) {\n        var query = _ref4.query,\n          index = _ref4.index;\n        var item = getItemByQuery(state.items, query);\n        if (!item) return;\n        var currentIndex = state.items.indexOf(item);\n        index = limit(index, 0, state.items.length - 1);\n        if (currentIndex === index) return;\n        state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\n      },\n\n      SORT: function SORT(_ref5) {\n        var compare = _ref5.compare;\n        sortItems(state, compare);\n        dispatch('DID_SORT_ITEMS', {\n          items: query('GET_ACTIVE_ITEMS')\n        });\n      },\n\n      ADD_ITEMS: function ADD_ITEMS(_ref6) {\n        var items = _ref6.items,\n          index = _ref6.index,\n          interactionMethod = _ref6.interactionMethod,\n          _ref6$success = _ref6.success,\n          success = _ref6$success === void 0 ? function() {} : _ref6$success,\n          _ref6$failure = _ref6.failure,\n          failure = _ref6$failure === void 0 ? function() {} : _ref6$failure;\n\n        var currentIndex = index;\n\n        if (index === -1 || typeof index === 'undefined') {\n          var insertLocation = query('GET_ITEM_INSERT_LOCATION');\n          var totalItems = query('GET_TOTAL_ITEMS');\n          currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n\n        var ignoredFiles = query('GET_IGNORED_FILES');\n        var isValidFile = function isValidFile(source) {\n          return isFile(source)\n            ? !ignoredFiles.includes(source.name.toLowerCase())\n            : !isEmpty(source);\n        };\n        var validItems = items.filter(isValidFile);\n\n        var promises = validItems.map(function(source) {\n          return new Promise(function(resolve, reject) {\n            dispatch('ADD_ITEM', {\n              interactionMethod: interactionMethod,\n              source: source.source || source,\n              success: resolve,\n              failure: reject,\n              index: currentIndex++,\n              options: source.options || {}\n            });\n          });\n        });\n\n        Promise.all(promises)\n          .then(success)\n          .catch(failure);\n      },\n\n      /**\n       * @param source\n       * @param index\n       * @param interactionMethod\n       */\n      ADD_ITEM: function ADD_ITEM(_ref7) {\n        var source = _ref7.source,\n          _ref7$index = _ref7.index,\n          index = _ref7$index === void 0 ? -1 : _ref7$index,\n          interactionMethod = _ref7.interactionMethod,\n          _ref7$success = _ref7.success,\n          success = _ref7$success === void 0 ? function() {} : _ref7$success,\n          _ref7$failure = _ref7.failure,\n          failure = _ref7$failure === void 0 ? function() {} : _ref7$failure,\n          _ref7$options = _ref7.options,\n          options = _ref7$options === void 0 ? {} : _ref7$options;\n\n        // if no source supplied\n        if (isEmpty(source)) {\n          failure({\n            error: createResponse('error', 0, 'No source'),\n\n            file: null\n          });\n\n          return;\n        }\n\n        // filter out invalid file items, used to filter dropped directory contents\n        if (\n          isFile(source) &&\n          state.options.ignoredFiles.includes(source.name.toLowerCase())\n        ) {\n          // fail silently\n          return;\n        }\n\n        // test if there's still room in the list of files\n        if (!hasRoomForItem(state)) {\n          // if multiple allowed, we can't replace\n          // or if only a single item is allowed but we're not allowed to replace it we exit\n          if (\n            state.options.allowMultiple ||\n            (!state.options.allowMultiple && !state.options.allowReplace)\n          ) {\n            var error = createResponse('warning', 0, 'Max files');\n\n            dispatch('DID_THROW_MAX_FILES', {\n              source: source,\n              error: error\n            });\n\n            failure({ error: error, file: null });\n\n            return;\n          }\n\n          // let's replace the item\n          // id of first item we're about to remove\n          var _item = getActiveItems(state.items)[0];\n\n          // if has been processed remove it from the server as well\n          if (\n            _item.status === ItemStatus.PROCESSING_COMPLETE ||\n            _item.status === ItemStatus.PROCESSING_REVERT_ERROR\n          ) {\n            var forceRevert = query('GET_FORCE_REVERT');\n            _item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                forceRevert\n              )\n              .then(function() {\n                if (!forceRevert) return;\n\n                // try to add now\n                dispatch('ADD_ITEM', {\n                  source: source,\n                  index: index,\n                  interactionMethod: interactionMethod,\n                  success: success,\n                  failure: failure,\n                  options: options\n                });\n              })\n              .catch(function() {}); // no need to handle this catch state for now\n\n            if (forceRevert) return;\n          }\n\n          // remove first item as it will be replaced by this item\n          dispatch('REMOVE_ITEM', { query: _item.id });\n        }\n\n        // where did the file originate\n        var origin =\n          options.type === 'local'\n            ? FileOrigin.LOCAL\n            : options.type === 'limbo'\n            ? FileOrigin.LIMBO\n            : FileOrigin.INPUT;\n\n        // create a new blank item\n        var item = createItem(\n          // where did this file come from\n          origin,\n\n          // an input file never has a server file reference\n          origin === FileOrigin.INPUT ? null : source,\n\n          // file mock data, if defined\n          options.file\n        );\n\n        // set initial meta data\n        Object.keys(options.metadata || {}).forEach(function(key) {\n          item.setMetadata(key, options.metadata[key]);\n        });\n\n        // created the item, let plugins add methods\n        applyFilters('DID_CREATE_ITEM', item, {\n          query: query,\n          dispatch: dispatch\n        });\n\n        // where to insert new items\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        // adjust index if is not allowed to pick location\n        if (!state.options.itemInsertLocationFreedom) {\n          index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        }\n\n        // add item to list\n        insertItem(state.items, item, index);\n\n        // sort items in list\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        }\n\n        // get a quick reference to the item id\n        var id = item.id;\n\n        // observe item events\n        item.on('load-init', function() {\n          dispatch('DID_START_ITEM_LOAD', { id: id });\n        });\n\n        item.on('load-meta', function() {\n          dispatch('DID_UPDATE_ITEM_META', { id: id });\n        });\n\n        item.on('load-progress', function(progress) {\n          dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n\n        item.on('load-request-error', function(error) {\n          var mainStatus = dynamicLabel(state.options.labelFileLoadError)(\n            error\n          );\n\n          // is client error, no way to recover\n          if (error.code >= 400 && error.code < 500) {\n            dispatch('DID_THROW_ITEM_INVALID', {\n              id: id,\n              error: error,\n              status: {\n                main: mainStatus,\n                sub: error.code + ' (' + error.body + ')'\n              }\n            });\n\n            // reject the file so can be dealt with through API\n            failure({ error: error, file: createItemAPI(item) });\n            return;\n          }\n\n          // is possible server error, so might be possible to retry\n          dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: mainStatus,\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('load-file-error', function(error) {\n          dispatch('DID_THROW_ITEM_INVALID', {\n            id: id,\n            error: error.status,\n            status: error.status\n          });\n\n          failure({ error: error.status, file: createItemAPI(item) });\n        });\n\n        item.on('load-abort', function() {\n          dispatch('REMOVE_ITEM', { query: id });\n        });\n\n        item.on('load-skip', function() {\n          dispatch('COMPLETE_LOAD_ITEM', {\n            query: id,\n            item: item,\n            data: {\n              source: source,\n              success: success\n            }\n          });\n        });\n\n        item.on('load', function() {\n          var handleAdd = function handleAdd(shouldAdd) {\n            // no should not add this file\n            if (!shouldAdd) {\n              dispatch('REMOVE_ITEM', {\n                query: id\n              });\n\n              return;\n            }\n\n            // now interested in metadata updates\n            item.on('metadata-update', function(change) {\n              dispatch('DID_UPDATE_ITEM_METADATA', { id: id, change: change });\n            });\n\n            // let plugins decide if the output data should be prepared at this point\n            // means we'll do this and wait for idle state\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function(shouldPrepareOutput) {\n              var loadComplete = function loadComplete() {\n                dispatch('COMPLETE_LOAD_ITEM', {\n                  query: id,\n                  item: item,\n                  data: {\n                    source: source,\n                    success: success\n                  }\n                });\n\n                listUpdated(dispatch, state);\n              };\n\n              // exit\n              if (shouldPrepareOutput) {\n                // wait for idle state and then run PREPARE_OUTPUT\n                dispatch(\n                  'REQUEST_PREPARE_OUTPUT',\n                  {\n                    query: id,\n                    item: item,\n                    success: function success(file) {\n                      dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });\n                      loadComplete();\n                    }\n                  },\n                  true\n                );\n\n                return;\n              }\n\n              loadComplete();\n            });\n          };\n\n          // item loaded, allow plugins to\n          // - read data (quickly)\n          // - add metadata\n          applyFilterChain('DID_LOAD_ITEM', item, {\n            query: query,\n            dispatch: dispatch\n          })\n            .then(function() {\n              optionalPromise(\n                query('GET_BEFORE_ADD_FILE'),\n                createItemAPI(item)\n              ).then(handleAdd);\n            })\n            .catch(function() {\n              handleAdd(false);\n            });\n        });\n\n        item.on('process-start', function() {\n          dispatch('DID_START_ITEM_PROCESSING', { id: id });\n        });\n\n        item.on('process-progress', function(progress) {\n          dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n\n        item.on('process-error', function(error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('process-revert-error', function(error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingRevertError)(\n                error\n              ),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('process-complete', function(serverFileReference) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: id,\n            error: null,\n            serverFileReference: serverFileReference\n          });\n\n          dispatch('DID_DEFINE_VALUE', { id: id, value: serverFileReference });\n        });\n\n        item.on('process-abort', function() {\n          dispatch('DID_ABORT_ITEM_PROCESSING', { id: id });\n        });\n\n        item.on('process-revert', function() {\n          dispatch('DID_REVERT_ITEM_PROCESSING', { id: id });\n          dispatch('DID_DEFINE_VALUE', { id: id, value: null });\n        });\n\n        // let view know the item has been inserted\n        dispatch('DID_ADD_ITEM', {\n          id: id,\n          index: index,\n          interactionMethod: interactionMethod\n        });\n\n        listUpdated(dispatch, state);\n\n        // start loading the source\n        var _ref8 = state.options.server || {},\n          url = _ref8.url,\n          load = _ref8.load,\n          restore = _ref8.restore,\n          fetch = _ref8.fetch;\n\n        item.load(\n          source,\n\n          // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n          createFileLoader(\n            origin === FileOrigin.INPUT\n              ? // input\n                isString(source) && isExternalURL(source)\n                ? createFetchFunction(url, fetch) // remote url\n                : fetchLocal // local url\n              : // limbo or local\n              origin === FileOrigin.LIMBO\n              ? createFetchFunction(url, restore) // limbo\n              : createFetchFunction(url, load) // local\n          ),\n\n          // called when the file is loaded so it can be piped through the filters\n          function(file, success, error) {\n            // let's process the file\n            applyFilterChain('LOAD_FILE', file, { query: query })\n              .then(success)\n              .catch(error);\n          }\n        );\n      },\n\n      REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref9) {\n        var item = _ref9.item,\n          success = _ref9.success,\n          _ref9$failure = _ref9.failure,\n          failure = _ref9$failure === void 0 ? function() {} : _ref9$failure;\n\n        // error response if item archived\n        var err = {\n          error: createResponse('error', 0, 'Item not found'),\n\n          file: null\n        };\n\n        // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n        if (item.archived) return failure(err);\n\n        // allow plugins to alter the file data\n        applyFilterChain('PREPARE_OUTPUT', item.file, {\n          query: query,\n          item: item\n        }).then(function(result) {\n          applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {\n            query: query,\n            item: item\n          }).then(function(result) {\n            // don't handle archived items, an item could have been archived (load aborted) while being prepared\n            if (item.archived) return failure(err);\n\n            // we done!\n            success(result);\n          });\n        });\n      },\n\n      COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref10) {\n        var item = _ref10.item,\n          data = _ref10.data;\n        var success = data.success,\n          source = data.source;\n\n        // sort items in list\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        }\n\n        // let interface know the item has loaded\n        dispatch('DID_LOAD_ITEM', {\n          id: item.id,\n          error: null,\n          serverFileReference: item.origin === FileOrigin.INPUT ? null : source\n        });\n\n        // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n        success(createItemAPI(item));\n\n        // if this is a local server file we need to show a different state\n        if (item.origin === FileOrigin.LOCAL) {\n          dispatch('DID_LOAD_LOCAL_ITEM', { id: item.id });\n          return;\n        }\n\n        // if is a temp server file we prevent async upload call here (as the file is already on the server)\n        if (item.origin === FileOrigin.LIMBO) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: item.id,\n            error: null,\n            serverFileReference: source\n          });\n\n          dispatch('DID_DEFINE_VALUE', {\n            id: item.id,\n            value: source\n          });\n\n          return;\n        }\n\n        // id we are allowed to upload the file immidiately, lets do it\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n          dispatch('REQUEST_ITEM_PROCESSING', { query: item.id });\n        }\n      },\n\n      RETRY_ITEM_LOAD: getItemByQueryFromState(state, function(item) {\n        // try loading the source one more time\n        item.retryLoad();\n      }),\n\n      REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, function(\n        item,\n        _success,\n        failure\n      ) {\n        dispatch(\n          'REQUEST_PREPARE_OUTPUT',\n          {\n            query: item.id,\n            item: item,\n            success: function success(file) {\n              dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });\n              _success({\n                file: item,\n                output: file\n              });\n            },\n            failure: failure\n          },\n          true\n        );\n      }),\n\n      REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function(\n        item,\n        success,\n        failure\n      ) {\n        // cannot be queued (or is already queued)\n        var itemCanBeQueuedForProcessing =\n          // waiting for something\n          item.status === ItemStatus.IDLE ||\n          // processing went wrong earlier\n          item.status === ItemStatus.PROCESSING_ERROR;\n\n        // not ready to be processed\n        if (!itemCanBeQueuedForProcessing) {\n          var processNow = function processNow() {\n            return dispatch('REQUEST_ITEM_PROCESSING', {\n              query: item,\n              success: success,\n              failure: failure\n            });\n          };\n\n          var process = function process() {\n            return document.hidden ? processNow() : setTimeout(processNow, 32);\n          };\n\n          // if already done processing or tried to revert but didn't work, try again\n          if (\n            item.status === ItemStatus.PROCESSING_COMPLETE ||\n            item.status === ItemStatus.PROCESSING_REVERT_ERROR\n          ) {\n            item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                query('GET_FORCE_REVERT')\n              )\n              .then(process)\n              .catch(function() {}); // don't continue with processing if something went wrong\n          } else if (item.status === ItemStatus.PROCESSING) {\n            item.abortProcessing().then(process);\n          }\n\n          return;\n        }\n\n        // already queued for processing\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n\n        item.requestProcessing();\n\n        dispatch('DID_REQUEST_ITEM_PROCESSING', { id: item.id });\n\n        dispatch(\n          'PROCESS_ITEM',\n          { query: item, success: success, failure: failure },\n          true\n        );\n      }),\n\n      PROCESS_ITEM: getItemByQueryFromState(state, function(\n        item,\n        success,\n        failure\n      ) {\n        var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        var totalCurrentUploads = query(\n          'GET_ITEMS_BY_STATUS',\n          ItemStatus.PROCESSING\n        ).length;\n\n        // queue and wait till queue is freed up\n        if (totalCurrentUploads === maxParallelUploads) {\n          // queue for later processing\n          state.processingQueue.push({\n            id: item.id,\n            success: success,\n            failure: failure\n          });\n\n          // stop it!\n          return;\n        }\n\n        // if was not queued or is already processing exit here\n        if (item.status === ItemStatus.PROCESSING) return;\n\n        var processNext = function processNext() {\n          // process queueud items\n          var queueEntry = state.processingQueue.shift();\n\n          // no items left\n          if (!queueEntry) return;\n\n          // get item reference\n          var id = queueEntry.id,\n            success = queueEntry.success,\n            failure = queueEntry.failure;\n          var itemReference = getItemByQuery(state.items, id);\n\n          // if item was archived while in queue, jump to next\n          if (!itemReference || itemReference.archived) {\n            processNext();\n            return;\n          }\n\n          // process queued item\n          dispatch(\n            'PROCESS_ITEM',\n            { query: id, success: success, failure: failure },\n            true\n          );\n        };\n\n        // we done function\n        item.onOnce('process-complete', function() {\n          success(createItemAPI(item));\n          processNext();\n\n          // All items processed? No errors?\n          var allItemsProcessed =\n            query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE)\n              .length === state.items.length;\n          if (allItemsProcessed) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n          }\n        });\n\n        // we error function\n        item.onOnce('process-error', function(error) {\n          failure({ error: error, file: createItemAPI(item) });\n          processNext();\n        });\n\n        // start file processing\n        var options = state.options;\n        item.process(\n          createFileProcessor(\n            createProcessorFunction(\n              options.server.url,\n              options.server.process,\n              options.name,\n              {\n                chunkTransferId: item.transferId,\n                chunkServer: options.server.patch,\n                chunkUploads: options.chunkUploads,\n                chunkForce: options.chunkForce,\n                chunkSize: options.chunkSize,\n                chunkRetryDelays: options.chunkRetryDelays\n              }\n            )\n          ),\n\n          // called when the file is about to be processed so it can be piped through the transform filters\n          function(file, success, error) {\n            // allow plugins to alter the file data\n            applyFilterChain('PREPARE_OUTPUT', file, {\n              query: query,\n              item: item\n            })\n              .then(function(file) {\n                dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });\n\n                success(file);\n              })\n              .catch(error);\n          }\n        );\n      }),\n\n      RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        dispatch('REQUEST_ITEM_PROCESSING', { query: item });\n      }),\n\n      REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function(item) {\n        optionalPromise(\n          query('GET_BEFORE_REMOVE_FILE'),\n          createItemAPI(item)\n        ).then(function(shouldRemove) {\n          if (!shouldRemove) {\n            return;\n          }\n          dispatch('REMOVE_ITEM', { query: item });\n        });\n      }),\n\n      RELEASE_ITEM: getItemByQueryFromState(state, function(item) {\n        item.release();\n      }),\n\n      REMOVE_ITEM: getItemByQueryFromState(state, function(item, success) {\n        var removeFromView = function removeFromView() {\n          // get id reference\n          var id = item.id;\n\n          // archive the item, this does not remove it from the list\n          getItemById(state.items, id).archive();\n\n          // tell the view the item has been removed\n          dispatch('DID_REMOVE_ITEM', { error: null, id: id, item: item });\n\n          // now the list has been modified\n          listUpdated(dispatch, state);\n\n          // correctly removed\n          success(createItemAPI(item));\n        };\n\n        // if this is a local file and the server.remove function has been configured, send source there so dev can remove file from server\n        var server = state.options.server;\n        if (\n          item.origin === FileOrigin.LOCAL &&\n          server &&\n          isFunction(server.remove)\n        ) {\n          dispatch('DID_START_ITEM_REMOVE', { id: item.id });\n\n          server.remove(\n            item.source,\n            function() {\n              return removeFromView();\n            },\n            function(status) {\n              dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n                id: item.id,\n                error: createResponse('error', 0, status, null),\n                status: {\n                  main: dynamicLabel(state.options.labelFileRemoveError)(\n                    status\n                  ),\n                  sub: state.options.labelTapToRetry\n                }\n              });\n            }\n          );\n        } else {\n          // if is limbo item, need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\n          if (item.origin !== FileOrigin.LOCAL && item.serverId !== null) {\n            item.revert(\n              createRevertFunction(\n                state.options.server.url,\n                state.options.server.revert\n              ),\n              query('GET_FORCE_REVERT')\n            );\n          }\n\n          // can now safely remove from view\n          removeFromView();\n        }\n      }),\n\n      ABORT_ITEM_LOAD: getItemByQueryFromState(state, function(item) {\n        item.abortLoad();\n      }),\n\n      ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        // test if is already processed\n        if (item.serverId) {\n          dispatch('REVERT_ITEM_PROCESSING', { id: item.id });\n          return;\n        }\n\n        // abort\n        item.abortProcessing().then(function() {\n          var shouldRemove = state.options.instantUpload;\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', { query: item.id });\n          }\n        });\n      }),\n\n      REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(\n        item\n      ) {\n        // not instant uploading, revert immidiately\n        if (!state.options.instantUpload) {\n          dispatch('REVERT_ITEM_PROCESSING', { query: item });\n          return;\n        }\n\n        // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n        var handleRevert = function handleRevert(shouldRevert) {\n          if (!shouldRevert) return;\n          dispatch('REVERT_ITEM_PROCESSING', { query: item });\n        };\n\n        var fn = query('GET_BEFORE_REMOVE_FILE');\n        if (!fn) {\n          return handleRevert(true);\n        }\n\n        var requestRemoveResult = fn(createItemAPI(item));\n        if (requestRemoveResult == null) {\n          // undefined or null\n          return handleRevert(true);\n        }\n\n        if (typeof requestRemoveResult === 'boolean') {\n          return handleRevert(requestRemoveResult);\n        }\n\n        if (typeof requestRemoveResult.then === 'function') {\n          requestRemoveResult.then(handleRevert);\n        }\n      }),\n\n      REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        item\n          .revert(\n            createRevertFunction(\n              state.options.server.url,\n              state.options.server.revert\n            ),\n            query('GET_FORCE_REVERT')\n          )\n          .then(function() {\n            var shouldRemove = state.options.instantUpload || isMockItem(item);\n            if (shouldRemove) {\n              dispatch('REMOVE_ITEM', { query: item.id });\n            }\n          })\n          .catch(function() {});\n      }),\n\n      SET_OPTIONS: function SET_OPTIONS(_ref11) {\n        var options = _ref11.options;\n        forin(options, function(key, value) {\n          dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        });\n      }\n    };\n  };\n\n  var formatFilename = function formatFilename(name) {\n    return name;\n  };\n\n  var createElement$1 = function createElement(tagName) {\n    return document.createElement(tagName);\n  };\n\n  var text = function text(node, value) {\n    var textNode = node.childNodes[0];\n    if (!textNode) {\n      textNode = document.createTextNode(value);\n      node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n      textNode.nodeValue = value;\n    }\n  };\n\n  var polarToCartesian = function polarToCartesian(\n    centerX,\n    centerY,\n    radius,\n    angleInDegrees\n  ) {\n    var angleInRadians = (((angleInDegrees % 360) - 90) * Math.PI) / 180.0;\n    return {\n      x: centerX + radius * Math.cos(angleInRadians),\n      y: centerY + radius * Math.sin(angleInRadians)\n    };\n  };\n\n  var describeArc = function describeArc(\n    x,\n    y,\n    radius,\n    startAngle,\n    endAngle,\n    arcSweep\n  ) {\n    var start = polarToCartesian(x, y, radius, endAngle);\n    var end = polarToCartesian(x, y, radius, startAngle);\n    return [\n      'M',\n      start.x,\n      start.y,\n      'A',\n      radius,\n      radius,\n      0,\n      arcSweep,\n      0,\n      end.x,\n      end.y\n    ].join(' ');\n  };\n\n  var percentageArc = function percentageArc(x, y, radius, from, to) {\n    var arcSweep = 1;\n    if (to > from && to - from <= 0.5) {\n      arcSweep = 0;\n    }\n    if (from > to && from - to >= 0.5) {\n      arcSweep = 0;\n    }\n    return describeArc(\n      x,\n      y,\n      radius,\n      Math.min(0.9999, from) * 360,\n      Math.min(0.9999, to) * 360,\n      arcSweep\n    );\n  };\n\n  var create = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // start at 0\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0;\n\n    // svg\n    var svg = createElement('svg');\n    root.ref.path = createElement('path', {\n      'stroke-width': 2,\n      'stroke-linecap': 'round'\n    });\n\n    svg.appendChild(root.ref.path);\n\n    root.ref.svg = svg;\n\n    root.appendChild(svg);\n  };\n\n  var write = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n\n    if (props.opacity === 0) {\n      return;\n    }\n\n    if (props.align) {\n      root.element.dataset.align = props.align;\n    }\n\n    // get width of stroke\n    var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);\n\n    // calculate size of ring\n    var size = root.rect.element.width * 0.5;\n\n    // ring state\n    var ringFrom = 0;\n    var ringTo = 0;\n\n    // now in busy mode\n    if (props.spin) {\n      ringFrom = 0;\n      ringTo = 0.5;\n    } else {\n      ringFrom = 0;\n      ringTo = props.progress;\n    }\n\n    // get arc path\n    var coordinates = percentageArc(\n      size,\n      size,\n      size - ringStrokeWidth,\n      ringFrom,\n      ringTo\n    );\n\n    // update progress bar\n    attr(root.ref.path, 'd', coordinates);\n\n    // hide while contains 0 value\n    attr(\n      root.ref.path,\n      'stroke-opacity',\n      props.spin || props.progress > 0 ? 1 : 0\n    );\n  };\n\n  var progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create: create,\n    write: write,\n    mixins: {\n      apis: ['progress', 'spin', 'align'],\n      styles: ['opacity'],\n      animations: {\n        opacity: { type: 'tween', duration: 500 },\n        progress: {\n          type: 'spring',\n          stiffness: 0.95,\n          damping: 0.65,\n          mass: 10\n        }\n      }\n    }\n  });\n\n  var create$1 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.element.innerHTML =\n      (props.icon || '') + ('<span>' + props.label + '</span>');\n\n    props.isDisabled = false;\n  };\n\n  var write$1 = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    var isDisabled = props.isDisabled;\n    var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n    if (shouldDisable && !isDisabled) {\n      props.isDisabled = true;\n      attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n      props.isDisabled = false;\n      root.element.removeAttribute('disabled');\n    }\n  };\n\n  var fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n      type: 'button'\n    },\n\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n      apis: ['label'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      },\n\n      listeners: true\n    },\n\n    create: create$1,\n    write: write$1\n  });\n\n  var toNaturalFileSize = function toNaturalFileSize(bytes) {\n    var decimalSeparator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.';\n    // nope, no negative byte sizes\n    bytes = Math.round(Math.abs(bytes));\n\n    // just bytes\n    if (bytes < 1000) {\n      return bytes + ' bytes';\n    }\n\n    // kilobytes\n    if (bytes < MB) {\n      return Math.floor(bytes / KB) + ' KB';\n    }\n\n    // megabytes\n    if (bytes < GB) {\n      return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' MB';\n    }\n\n    // gigabytes\n    return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' GB';\n  };\n\n  var KB = 1000;\n  var MB = 1000000;\n  var GB = 1000000000;\n\n  var removeDecimalsWhenZero = function removeDecimalsWhenZero(\n    value,\n    decimalCount,\n    separator\n  ) {\n    return value\n      .toFixed(decimalCount)\n      .split('.')\n      .filter(function(part) {\n        return part !== '0';\n      })\n      .join(separator);\n  };\n\n  var create$2 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // filename\n    var fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main';\n    // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName;\n\n    // filesize\n    var fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize;\n\n    // set initial values\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFile = function updateFile(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    text(\n      root.ref.fileSize,\n      toNaturalFileSize(root.query('GET_ITEM_SIZE', props.id))\n    );\n\n    text(\n      root.ref.fileName,\n      formatFilename(root.query('GET_ITEM_NAME', props.id))\n    );\n  };\n\n  var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {\n    var root = _ref3.root,\n      props = _ref3.props;\n    // if size is available don't fallback to unknown size message\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n      return;\n    }\n\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n  };\n\n  var fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: updateFile,\n      DID_UPDATE_ITEM_META: updateFile,\n      DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n      DID_THROW_ITEM_INVALID: updateFileSizeOnError\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    create: create$2,\n    mixins: {\n      styles: ['translateX', 'translateY'],\n      animations: {\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var toPercentage = function toPercentage(value) {\n    return Math.round(value * 100);\n  };\n\n  var create$3 = function create(_ref) {\n    var root = _ref.root;\n\n    // main status\n    var main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main;\n\n    // sub status\n    var sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n\n    didSetItemLoadProgress({ root: root, action: { progress: null } });\n  };\n\n  var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    var title =\n      action.progress === null\n        ? root.query('GET_LABEL_FILE_LOADING')\n        : root.query('GET_LABEL_FILE_LOADING') +\n          ' ' +\n          toPercentage(action.progress) +\n          '%';\n\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var title =\n      action.progress === null\n        ? root.query('GET_LABEL_FILE_PROCESSING')\n        : root.query('GET_LABEL_FILE_PROCESSING') +\n          ' ' +\n          toPercentage(action.progress) +\n          '%';\n\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {\n    var root = _ref4.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {\n    var root = _ref5.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n  };\n\n  var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {\n    var root = _ref6.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n  };\n\n  var clear = function clear(_ref7) {\n    var root = _ref7.root;\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n  };\n\n  var error = function error(_ref8) {\n    var root = _ref8.root,\n      action = _ref8.action;\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n  };\n\n  var fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: clear,\n      DID_REVERT_ITEM_PROCESSING: clear,\n      DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n      DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n      DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n      DID_THROW_ITEM_LOAD_ERROR: error,\n      DID_THROW_ITEM_INVALID: error,\n      DID_THROW_ITEM_PROCESSING_ERROR: error,\n      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n      DID_THROW_ITEM_REMOVE_ERROR: error\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    create: create$3,\n    mixins: {\n      styles: ['translateX', 'translateY', 'opacity'],\n      animations: {\n        opacity: { type: 'tween', duration: 250 },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  /**\n   * Button definitions for the file view\n   */\n\n  var Buttons = {\n    AbortItemLoad: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n      action: 'ABORT_ITEM_LOAD',\n      className: 'filepond--action-abort-item-load',\n      align: 'LOAD_INDICATOR_POSITION' // right\n    },\n    RetryItemLoad: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n      action: 'RETRY_ITEM_LOAD',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-load',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RemoveItem: {\n      label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n      action: 'REQUEST_REMOVE_ITEM',\n      icon: 'GET_ICON_REMOVE',\n      className: 'filepond--action-remove-item',\n      align: 'BUTTON_REMOVE_ITEM_POSITION' // left\n    },\n    ProcessItem: {\n      label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n      action: 'REQUEST_ITEM_PROCESSING',\n      icon: 'GET_ICON_PROCESS',\n      className: 'filepond--action-process-item',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    AbortItemProcessing: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n      action: 'ABORT_ITEM_PROCESSING',\n      className: 'filepond--action-abort-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RetryItemProcessing: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n      action: 'RETRY_ITEM_PROCESSING',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RevertItemProcessing: {\n      label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n      action: 'REQUEST_REVERT_ITEM_PROCESSING',\n      icon: 'GET_ICON_UNDO',\n      className: 'filepond--action-revert-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    }\n  };\n\n  // make a list of buttons, we can then remove buttons from this list if they're disabled\n  var ButtonKeys = [];\n  forin(Buttons, function(key) {\n    ButtonKeys.push(key);\n  });\n\n  var calculateFileInfoOffset = function calculateFileInfoOffset(root) {\n    var buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n  };\n\n  // Force on full pixels so text stays crips\n  var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(\n    root\n  ) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\n  };\n  var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(\n    root\n  ) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n  };\n\n  var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {\n    return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\n  };\n  var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(\n    root\n  ) {\n    return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\n  };\n  var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {\n    return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n  };\n\n  var DefaultStyle = {\n    buttonAbortItemLoad: { opacity: 0 },\n    buttonRetryItemLoad: { opacity: 0 },\n    buttonRemoveItem: { opacity: 0 },\n    buttonProcessItem: { opacity: 0 },\n    buttonAbortItemProcessing: { opacity: 0 },\n    buttonRetryItemProcessing: { opacity: 0 },\n    buttonRevertItemProcessing: { opacity: 0 },\n    loadProgressIndicator: { opacity: 0, align: getLoadIndicatorAlignment },\n    processProgressIndicator: {\n      opacity: 0,\n      align: getProcessIndicatorAlignment\n    },\n    processingCompleteIndicator: { opacity: 0, scaleX: 0.75, scaleY: 0.75 },\n    info: { translateX: 0, translateY: 0, opacity: 0 },\n    status: { translateX: 0, translateY: 0, opacity: 0 }\n  };\n\n  var IdleStyle = {\n    buttonRemoveItem: { opacity: 1 },\n    buttonProcessItem: { opacity: 1 },\n    info: { translateX: calculateFileInfoOffset },\n    status: { translateX: calculateFileInfoOffset }\n  };\n\n  var ProcessingStyle = {\n    buttonAbortItemProcessing: { opacity: 1 },\n    processProgressIndicator: { opacity: 1 },\n    status: { opacity: 1 }\n  };\n\n  var StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { translateX: calculateFileInfoOffset, opacity: 1 }\n    },\n\n    DID_START_ITEM_LOAD: {\n      buttonAbortItemLoad: { opacity: 1 },\n      loadProgressIndicator: { opacity: 1 },\n      status: { opacity: 1 }\n    },\n\n    DID_THROW_ITEM_LOAD_ERROR: {\n      buttonRetryItemLoad: { opacity: 1 },\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1 }\n    },\n\n    DID_START_ITEM_REMOVE: {\n      processProgressIndicator: {\n        opacity: 1,\n        align: getRemoveIndicatorAligment\n      },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 0 }\n    },\n\n    DID_THROW_ITEM_REMOVE_ERROR: {\n      processProgressIndicator: {\n        opacity: 0,\n        align: getRemoveIndicatorAligment\n      },\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1, translateX: calculateFileInfoOffset }\n    },\n\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { translateX: calculateFileInfoOffset }\n    },\n\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n      buttonRevertItemProcessing: { opacity: 1 },\n      info: { opacity: 1 },\n      status: { opacity: 1 }\n    },\n\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n      buttonRemoveItem: { opacity: 1 },\n      buttonRetryItemProcessing: { opacity: 1 },\n      status: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset }\n    },\n\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n      buttonRevertItemProcessing: { opacity: 1 },\n      status: { opacity: 1 },\n      info: { opacity: 1 }\n    },\n\n    DID_ABORT_ITEM_PROCESSING: {\n      buttonRemoveItem: { opacity: 1 },\n      buttonProcessItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1 }\n    },\n\n    DID_REVERT_ITEM_PROCESSING: IdleStyle\n  };\n\n  // complete indicator view\n  var processingCompleteIndicatorView = createView({\n    create: function create(_ref) {\n      var root = _ref.root;\n      root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n      styles: ['scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      }\n    }\n  });\n\n  /**\n   * Creates the file view\n   */\n  var create$4 = function create(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    var id = props.id;\n\n    // allow reverting upload\n    var allowRevert = root.query('GET_ALLOW_REVERT');\n\n    // is instant uploading, need this to determine the icon of the undo button\n    var instantUpload = root.query('GET_INSTANT_UPLOAD');\n\n    // is async set up\n    var isAsync = root.query('IS_ASYNC');\n\n    // should align remove item buttons\n    var alignRemoveItemButton = root.query(\n      'GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN'\n    );\n\n    // enabled buttons array\n    var enabledButtons = isAsync\n      ? ButtonKeys.concat()\n      : ButtonKeys.filter(function(key) {\n          return !/Process/.test(key);\n        });\n\n    // update icon and label for revert button when instant uploading\n    if (instantUpload && allowRevert) {\n      Buttons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n      Buttons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    }\n\n    // remove last button (revert) if not allowed\n    if (isAsync && !allowRevert) {\n      enabledButtons.splice(-1, 1);\n      var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      map.info.translateX = calculateFileHorizontalCenterOffset;\n      map.info.translateY = calculateFileVerticalCenterOffset;\n      map.status.translateY = calculateFileVerticalCenterOffset;\n      map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    // move remove button to right\n    if (alignRemoveItemButton && allowRevert) {\n      Buttons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\n      var _map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      _map.info.translateX = calculateFileInfoOffset;\n      _map.status.translateY = calculateFileVerticalCenterOffset;\n      _map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    // create the button views\n    forin(Buttons, function(key, definition) {\n      // create button\n      var buttonView = root.createChildView(fileActionButton, {\n        label: root.query(definition.label),\n        icon: root.query(definition.icon),\n        opacity: 0\n      });\n\n      // should be appended?\n      if (enabledButtons.includes(key)) {\n        root.appendChildView(buttonView);\n      }\n\n      // add position attribute\n      buttonView.element.dataset.align = root.query(\n        'GET_STYLE_' + definition.align\n      );\n\n      // add class\n      buttonView.element.classList.add(definition.className);\n\n      // handle interactions\n      buttonView.on('click', function(e) {\n        e.stopPropagation();\n        root.dispatch(definition.action, { query: id });\n      });\n\n      // set reference\n      root.ref['button' + key] = buttonView;\n    });\n\n    // checkmark\n    root.ref.processingCompleteIndicator = root.appendChildView(\n      root.createChildView(processingCompleteIndicatorView)\n    );\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query(\n      'GET_STYLE_BUTTON_PROCESS_ITEM_POSITION'\n    );\n\n    // create file info view\n    root.ref.info = root.appendChildView(\n      root.createChildView(fileInfo, { id: id })\n    );\n\n    // create file status view\n    root.ref.status = root.appendChildView(\n      root.createChildView(fileStatus, { id: id })\n    );\n\n    // add progress indicators\n    var loadIndicatorView = root.appendChildView(\n      root.createChildView(progressIndicator, {\n        opacity: 0,\n        align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION')\n      })\n    );\n\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n\n    var progressIndicatorView = root.appendChildView(\n      root.createChildView(progressIndicator, {\n        opacity: 0,\n        align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION')\n      })\n    );\n\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView;\n\n    // current active styles\n    root.ref.activeStyles = [];\n  };\n\n  var write$2 = function write(_ref3) {\n    var root = _ref3.root,\n      actions = _ref3.actions,\n      props = _ref3.props;\n\n    // route actions\n    route({ root: root, actions: actions, props: props });\n\n    // select last state change action\n    var action = actions\n      .concat()\n      .filter(function(action) {\n        return /^DID_/.test(action.type);\n      })\n      .reverse()\n      .find(function(action) {\n        return StyleMap[action.type];\n      });\n\n    // a new action happened, let's get the matching styles\n    if (action) {\n      // define new active styles\n      root.ref.activeStyles = [];\n\n      var stylesToApply = StyleMap[action.type];\n      forin(DefaultStyle, function(name, defaultStyles) {\n        // get reference to control\n        var control = root.ref[name];\n\n        // loop over all styles for this control\n        forin(defaultStyles, function(key, defaultValue) {\n          var value =\n            stylesToApply[name] &&\n            typeof stylesToApply[name][key] !== 'undefined'\n              ? stylesToApply[name][key]\n              : defaultValue;\n          root.ref.activeStyles.push({\n            control: control,\n            key: key,\n            value: value\n          });\n        });\n      });\n    }\n\n    // apply active styles to element\n    root.ref.activeStyles.forEach(function(_ref4) {\n      var control = _ref4.control,\n        key = _ref4.key,\n        value = _ref4.value;\n      control[key] = typeof value === 'function' ? value(root) : value;\n    });\n  };\n\n  var route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(\n      _ref5\n    ) {\n      var root = _ref5.root,\n        action = _ref5.action;\n      root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(\n      _ref6\n    ) {\n      var root = _ref6.root,\n        action = _ref6.action;\n      root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(\n      _ref7\n    ) {\n      var root = _ref7.root,\n        action = _ref7.action;\n      root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {\n      var root = _ref8.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {\n      var root = _ref9.root;\n      root.ref.loadProgressIndicator.spin = true;\n      root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {\n      var root = _ref10.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(\n      _ref11\n    ) {\n      var root = _ref11.root,\n        action = _ref11.action;\n      root.ref.loadProgressIndicator.spin = false;\n      root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(\n      _ref12\n    ) {\n      var root = _ref12.root,\n        action = _ref12.action;\n      root.ref.processProgressIndicator.spin = false;\n      root.ref.processProgressIndicator.progress = action.progress;\n    }\n  });\n\n  var file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    name: 'file'\n  });\n\n  /**\n   * Creates the file view\n   */\n  var create$5 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // filename\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName);\n\n    // file appended\n    root.ref.file = root.appendChildView(\n      root.createChildView(file, { id: props.id })\n    );\n\n    // data has moved to data.js\n    root.ref.data = false;\n  };\n\n  /**\n   * Data storage\n   */\n  var didLoadItem = function didLoadItem(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    // updates the legend of the fieldset so screenreaders can better group buttons\n    text(\n      root.ref.fileName,\n      formatFilename(root.query('GET_ITEM_NAME', props.id))\n    );\n  };\n\n  var fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n      DID_LOAD_ITEM: didLoadItem\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper'\n  });\n\n  var PANEL_SPRING_PROPS = { type: 'spring', damping: 0.6, mass: 7 };\n\n  var create$6 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    [\n      {\n        name: 'top'\n      },\n\n      {\n        name: 'center',\n        props: {\n          translateY: null,\n          scaleY: null\n        },\n\n        mixins: {\n          animations: {\n            scaleY: PANEL_SPRING_PROPS\n          },\n\n          styles: ['translateY', 'scaleY']\n        }\n      },\n\n      {\n        name: 'bottom',\n        props: {\n          translateY: null\n        },\n\n        mixins: {\n          animations: {\n            translateY: PANEL_SPRING_PROPS\n          },\n\n          styles: ['translateY']\n        }\n      }\n    ].forEach(function(section) {\n      createSection(root, section, props.name);\n    });\n\n    root.element.classList.add('filepond--' + props.name);\n\n    root.ref.scalable = null;\n  };\n\n  var createSection = function createSection(root, section, className) {\n    var viewConstructor = createView({\n      name: 'panel-' + section.name + ' filepond--' + className,\n      mixins: section.mixins,\n      ignoreRectUpdate: true\n    });\n\n    var view = root.createChildView(viewConstructor, section.props);\n\n    root.ref[section.name] = root.appendChildView(view);\n  };\n\n  var write$3 = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n\n    // update scalable state\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n      root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n      root.element.dataset.scalable = root.ref.scalable;\n    }\n\n    // no height, can't set\n    if (!props.height) return;\n\n    // get child rects\n    var topRect = root.ref.top.rect.element;\n    var bottomRect = root.ref.bottom.rect.element;\n\n    // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n    var height = Math.max(topRect.height + bottomRect.height, props.height);\n\n    // offset center part\n    root.ref.center.translateY = topRect.height;\n\n    // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n    root.ref.center.scaleY =\n      (height - topRect.height - bottomRect.height) / 100;\n\n    // offset bottom part\n    root.ref.bottom.translateY = height - bottomRect.height;\n  };\n\n  var panel = createView({\n    name: 'panel',\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n      apis: ['height', 'scalable']\n    }\n  });\n\n  var ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10\n  };\n\n  var ITEM_SCALE_SPRING = 'spring';\n\n  var StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy',\n    DID_REQUEST_ITEM_PROCESSING: 'busy',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle'\n  };\n\n  /**\n   * Creates the file view\n   */\n  var create$7 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // select\n    root.ref.handleClick = function(e) {\n      return root.dispatch('DID_ACTIVATE_ITEM', { id: props.id });\n    };\n\n    // set id\n    root.element.id = 'filepond--item-' + props.id;\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // file view\n    root.ref.container = root.appendChildView(\n      root.createChildView(fileWrapper, { id: props.id })\n    );\n\n    // file panel\n    root.ref.panel = root.appendChildView(\n      root.createChildView(panel, { name: 'item-panel' })\n    );\n\n    // default start height\n    root.ref.panel.height = null;\n\n    // by default not marked for removal\n    props.markedForRemoval = false;\n\n    // if not allowed to reorder file items, exit here\n    if (!root.query('GET_ALLOW_REORDER')) return;\n\n    // set to idle so shows grab cursor\n    root.element.dataset.dragState = 'idle';\n\n    var grab = function grab(e) {\n      if (!e.isPrimary) return;\n\n      var removedActivateListener = false;\n\n      var origin = {\n        x: e.pageX,\n        y: e.pageY\n      };\n\n      props.dragOrigin = {\n        x: root.translateX,\n        y: root.translateY\n      };\n\n      props.dragCenter = {\n        x: e.offsetX,\n        y: e.offsetY\n      };\n\n      root.dispatch('DID_GRAB_ITEM', { id: props.id });\n\n      var drag = function drag(e) {\n        if (!e.isPrimary) return;\n\n        e.stopPropagation();\n        e.preventDefault();\n\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        };\n\n        // if dragged stop listening to clicks, will re-add when done dragging\n        var dist =\n          props.dragOffset.x * props.dragOffset.x +\n          props.dragOffset.y * props.dragOffset.y;\n        if (dist > 16 && !removedActivateListener) {\n          removedActivateListener = true;\n          root.element.removeEventListener('click', root.ref.handleClick);\n        }\n\n        root.dispatch('DID_DRAG_ITEM', { id: props.id });\n      };\n\n      var drop = function drop(e) {\n        if (!e.isPrimary) return;\n\n        document.removeEventListener('pointermove', drag);\n        document.removeEventListener('pointerup', drop);\n\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        };\n\n        root.dispatch('DID_DROP_ITEM', { id: props.id });\n\n        // start listening to clicks again\n        if (removedActivateListener) {\n          setTimeout(function() {\n            return root.element.addEventListener('click', root.ref.handleClick);\n          }, 0);\n        }\n      };\n\n      document.addEventListener('pointermove', drag);\n      document.addEventListener('pointerup', drop);\n    };\n\n    root.element.addEventListener('pointerdown', grab);\n  };\n\n  var route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {\n      var root = _ref2.root,\n        action = _ref2.action;\n      root.height = action.height;\n    }\n  });\n\n  var write$4 = createRoute(\n    {\n      DID_GRAB_ITEM: function DID_GRAB_ITEM(_ref3) {\n        var root = _ref3.root,\n          props = _ref3.props;\n        props.dragOrigin = {\n          x: root.translateX,\n          y: root.translateY\n        };\n      },\n      DID_DRAG_ITEM: function DID_DRAG_ITEM(_ref4) {\n        var root = _ref4.root;\n        root.element.dataset.dragState = 'drag';\n      },\n      DID_DROP_ITEM: function DID_DROP_ITEM(_ref5) {\n        var root = _ref5.root,\n          props = _ref5.props;\n        props.dragOffset = null;\n        props.dragOrigin = null;\n        root.element.dataset.dragState = 'drop';\n      }\n    },\n    function(_ref6) {\n      var root = _ref6.root,\n        actions = _ref6.actions,\n        props = _ref6.props,\n        shouldOptimize = _ref6.shouldOptimize;\n\n      if (root.element.dataset.dragState === 'drop') {\n        if (root.scaleX <= 1) {\n          root.element.dataset.dragState = 'idle';\n        }\n      }\n\n      // select last state change action\n      var action = actions\n        .concat()\n        .filter(function(action) {\n          return /^DID_/.test(action.type);\n        })\n        .reverse()\n        .find(function(action) {\n          return StateMap[action.type];\n        });\n\n      // no need to set same state twice\n      if (action && action.type !== props.currentState) {\n        // set current state\n        props.currentState = action.type;\n\n        // set state\n        root.element.dataset.filepondItemState =\n          StateMap[props.currentState] || '';\n      }\n\n      // route actions\n      var aspectRatio =\n        root.query('GET_ITEM_PANEL_ASPECT_RATIO') ||\n        root.query('GET_PANEL_ASPECT_RATIO');\n      if (!aspectRatio) {\n        route$1({ root: root, actions: actions, props: props });\n        if (!root.height && root.ref.container.rect.element.height > 0) {\n          root.height = root.ref.container.rect.element.height;\n        }\n      } else if (!shouldOptimize) {\n        root.height = root.rect.element.width * aspectRatio;\n      }\n\n      // sync panel height with item height\n      if (shouldOptimize) {\n        root.ref.panel.height = null;\n      }\n\n      root.ref.panel.height = root.height;\n    }\n  );\n\n  var item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: function destroy(_ref7) {\n      var root = _ref7.root,\n        props = _ref7.props;\n      root.element.removeEventListener('click', root.ref.handleClick);\n      root.dispatch('RELEASE_ITEM', { query: props.id });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n      apis: [\n        'id',\n        'interactionMethod',\n        'markedForRemoval',\n        'spawnDate',\n        'dragCenter',\n        'dragOrigin',\n        'dragOffset'\n      ],\n      styles: [\n        'translateX',\n        'translateY',\n        'scaleX',\n        'scaleY',\n        'opacity',\n        'height'\n      ],\n\n      animations: {\n        scaleX: ITEM_SCALE_SPRING,\n        scaleY: ITEM_SCALE_SPRING,\n        translateX: ITEM_TRANSLATE_SPRING,\n        translateY: ITEM_TRANSLATE_SPRING,\n        opacity: { type: 'tween', duration: 150 }\n      }\n    }\n  });\n\n  var getItemIndexByPosition = function getItemIndexByPosition(\n    view,\n    children,\n    positionInView\n  ) {\n    if (!positionInView) return;\n\n    var horizontalSpace = view.rect.element.width;\n    // const children = view.childViews;\n    var l = children.length;\n    var last = null;\n\n    // -1, don't move items to accomodate (either add to top or bottom)\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;\n\n    // let's get the item width\n    var item = children[0];\n    var itemRect = item.rect.element;\n    var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    var itemWidth = itemRect.width + itemHorizontalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      for (var index = 0; index < l; index++) {\n        var child = children[index];\n        var childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n        if (positionInView.top < childMid) {\n          return index;\n        }\n      }\n      return l;\n    }\n\n    // grid\n    var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    var itemHeight = itemRect.height + itemVerticalMargin;\n    for (var _index = 0; _index < l; _index++) {\n      var indexX = _index % itemsPerRow;\n      var indexY = Math.floor(_index / itemsPerRow);\n\n      var offsetX = indexX * itemWidth;\n      var offsetY = indexY * itemHeight;\n\n      var itemTop = offsetY - itemRect.marginTop;\n      var itemRight = offsetX + itemWidth;\n      var itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n      if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n        if (positionInView.left < itemRight) {\n          return _index;\n        } else if (_index !== l - 1) {\n          last = _index;\n        } else {\n          last = null;\n        }\n      }\n    }\n\n    if (last !== null) {\n      return last;\n    }\n\n    return l;\n  };\n\n  var create$8 = function create(_ref) {\n    var root = _ref.root;\n    // need to set role to list as otherwise it won't be read as a list by VoiceOver\n    attr(root.element, 'role', 'list');\n\n    root.ref.lastItemSpanwDate = Date.now();\n  };\n\n  /**\n   * Inserts a new item\n   * @param root\n   * @param action\n   */\n  var addItemView = function addItemView(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    var id = action.id,\n      index = action.index,\n      interactionMethod = action.interactionMethod;\n\n    root.ref.addIndex = index;\n\n    var now = Date.now();\n    var spawnDate = now;\n    var opacity = 1;\n\n    if (interactionMethod !== InteractionMethod.NONE) {\n      opacity = 0;\n      var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n      var dist = now - root.ref.lastItemSpanwDate;\n      spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n\n    root.ref.lastItemSpanwDate = spawnDate;\n\n    root.appendChildView(\n      root.createChildView(\n        // view type\n        item,\n\n        // props\n        {\n          spawnDate: spawnDate,\n          id: id,\n          opacity: opacity,\n          interactionMethod: interactionMethod\n        }\n      ),\n\n      index\n    );\n  };\n\n  var moveItem = function moveItem(item, x, y) {\n    var vx =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var vy =\n      arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n\n    // set to null to remove animation while dragging\n    if (item.dragOffset) {\n      item.translateX = null;\n      item.translateY = null;\n      item.translateX = item.dragOrigin.x + item.dragOffset.x;\n      item.translateY = item.dragOrigin.y + item.dragOffset.y;\n      item.scaleX = 1.025;\n      item.scaleY = 1.025;\n    } else {\n      item.translateX = x;\n      item.translateY = y;\n\n      if (Date.now() > item.spawnDate) {\n        // reveal element\n        if (item.opacity === 0) {\n          introItemView(item, x, y, vx, vy);\n        }\n\n        // make sure is default scale every frame\n        item.scaleX = 1;\n        item.scaleY = 1;\n        item.opacity = 1;\n      }\n    }\n  };\n\n  var introItemView = function introItemView(item, x, y, vx, vy) {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n      item.translateX = null;\n      item.translateX = x;\n      item.translateY = null;\n      item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n      item.translateX = null;\n      item.translateX = x - vx * 20;\n\n      item.translateY = null;\n      item.translateY = y - vy * 10;\n\n      item.scaleX = 0.8;\n      item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n      item.translateY = null;\n      item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n      item.translateX = null;\n      item.translateX = x - 30;\n      item.translateY = null;\n    }\n  };\n\n  /**\n   * Removes an existing item\n   * @param root\n   * @param action\n   */\n  var removeItemView = function removeItemView(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var id = action.id;\n\n    // get the view matching the given id\n    var view = root.childViews.find(function(child) {\n      return child.id === id;\n    });\n\n    // if no view found, exit\n    if (!view) {\n      return;\n    }\n\n    // animate view out of view\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0;\n\n    // mark for removal\n    view.markedForRemoval = true;\n  };\n\n  var getItemHeight = function getItemHeight(child) {\n    return (\n      child.rect.element.height +\n      child.rect.element.marginBottom * 0.5 +\n      child.rect.element.marginTop * 0.5\n    );\n  };\n\n  var dragItem = function dragItem(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action,\n      props = _ref4.props;\n    var id = action.id;\n\n    // get the view matching the given id\n    var view = root.childViews.find(function(child) {\n      return child.id === id;\n    });\n\n    // if no view found, exit\n    if (!view) return;\n\n    var dragPosition = {\n      x: 0,\n      y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y\n\n      // find new index\n    };\n    var items = root.query('GET_ACTIVE_ITEMS');\n    var visibleChildren = root.childViews.filter(function(child) {\n      return child.rect.element.height;\n    });\n    var children = items.map(function(item) {\n      return visibleChildren.find(function(childView) {\n        return childView.id === item.id;\n      });\n    });\n\n    var l = children.length;\n    var targetIndex = l - 1;\n\n    var childHeight = 0;\n    var childBottom = 0;\n    var childTop = 0;\n\n    var currentIndex = children.findIndex(function(child) {\n      return child === view;\n    });\n    var dragHeight = getItemHeight(view);\n\n    for (var i = 0; i < l; i++) {\n      childHeight = getItemHeight(children[i]);\n      childTop = childBottom;\n      childBottom = childTop + childHeight;\n\n      if (dragPosition.y < childBottom) {\n        if (currentIndex > i) {\n          if (dragPosition.y < childTop + dragHeight) {\n            targetIndex = i;\n            break;\n          }\n          continue;\n        }\n        targetIndex = i;\n        break;\n      }\n    }\n\n    root.dispatch('MOVE_ITEM', { query: view, index: targetIndex });\n\n    // if the index of the item changed, dispatch reorder action\n    if (currentIndex !== targetIndex) {\n      root.dispatch('DID_REORDER_ITEMS', {\n        items: root.query('GET_ACTIVE_ITEMS')\n      });\n    }\n  };\n\n  /**\n   * Setup action routes\n   */\n  var route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView,\n    DID_DRAG_ITEM: dragItem\n  });\n\n  /**\n   * Write to view\n   * @param root\n   * @param actions\n   * @param props\n   */\n  var write$5 = function write(_ref5) {\n    var root = _ref5.root,\n      props = _ref5.props,\n      actions = _ref5.actions,\n      shouldOptimize = _ref5.shouldOptimize;\n\n    // route actions\n    route$2({ root: root, props: props, actions: actions });\n    var dragCoordinates = props.dragCoordinates;\n\n    // available space on horizontal axis\n    var horizontalSpace = root.rect.element.width;\n\n    // only draw children that have dimensions\n    var visibleChildren = root.childViews.filter(function(child) {\n      return child.rect.element.height;\n    });\n\n    // sort based on current active items\n    var children = root\n      .query('GET_ACTIVE_ITEMS')\n      .map(function(item) {\n        return visibleChildren.find(function(child) {\n          return child.id === item.id;\n        });\n      })\n      .filter(function(item) {\n        return item;\n      });\n\n    // get index\n    var dragIndex = dragCoordinates\n      ? getItemIndexByPosition(root, children, dragCoordinates)\n      : null;\n\n    // add index is used to reserve the dropped/added item index till the actual item is rendered\n    var addIndex = root.ref.addIndex || null;\n\n    // add index no longer needed till possibly next draw\n    root.ref.addIndex = null;\n\n    var dragIndexOffset = 0;\n    var removeIndexOffset = 0;\n    var addIndexOffset = 0;\n\n    if (children.length === 0) return;\n\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      var offsetY = 0;\n      var dragOffset = 0;\n\n      children.forEach(function(child, index) {\n        if (dragIndex) {\n          var dist = index - dragIndex;\n          if (dist === -2) {\n            dragOffset = -itemVerticalMargin * 0.25;\n          } else if (dist === -1) {\n            dragOffset = -itemVerticalMargin * 0.75;\n          } else if (dist === 0) {\n            dragOffset = itemVerticalMargin * 0.75;\n          } else if (dist === 1) {\n            dragOffset = itemVerticalMargin * 0.25;\n          } else {\n            dragOffset = 0;\n          }\n        }\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        if (!child.markedForRemoval) {\n          moveItem(child, 0, offsetY + dragOffset);\n        }\n\n        var itemHeight = child.rect.element.height + itemVerticalMargin;\n\n        var visualHeight =\n          itemHeight * (child.markedForRemoval ? child.opacity : 1);\n\n        offsetY += visualHeight;\n      });\n    }\n    // grid\n    else {\n      var prevX = 0;\n      var prevY = 0;\n\n      children.forEach(function(child, index) {\n        if (index === dragIndex) {\n          dragIndexOffset = 1;\n        }\n\n        if (index === addIndex) {\n          addIndexOffset += 1;\n        }\n\n        if (child.markedForRemoval && child.opacity < 0.5) {\n          removeIndexOffset -= 1;\n        }\n\n        var visualIndex =\n          index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n\n        var indexX = visualIndex % itemsPerRow;\n        var indexY = Math.floor(visualIndex / itemsPerRow);\n\n        var offsetX = indexX * itemWidth;\n        var offsetY = indexY * itemHeight;\n\n        var vectorX = Math.sign(offsetX - prevX);\n        var vectorY = Math.sign(offsetY - prevY);\n\n        prevX = offsetX;\n        prevY = offsetY;\n\n        if (child.markedForRemoval) return;\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        moveItem(child, offsetX, offsetY, vectorX, vectorY);\n      });\n    }\n  };\n\n  /**\n   * Filters actions that are meant specifically for a certain child of the list\n   * @param child\n   * @param actions\n   */\n  var filterSetItemActions = function filterSetItemActions(child, actions) {\n    return actions.filter(function(action) {\n      // if action has an id, filter out actions that don't have this child id\n      if (action.data && action.data.id) {\n        return child.id === action.data.id;\n      }\n\n      // allow all other actions\n      return true;\n    });\n  };\n\n  var list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: function didWriteView(_ref6) {\n      var root = _ref6.root;\n      root.childViews\n        .filter(function(view) {\n          return view.markedForRemoval && view.opacity === 0 && view.resting;\n        })\n        .forEach(function(view) {\n          view._destroy();\n          root.removeChildView(view);\n        });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n      apis: ['dragCoordinates']\n    }\n  });\n\n  var create$9 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n  };\n\n  var storeDragCoordinates = function storeDragCoordinates(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props,\n      action = _ref2.action;\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n      left: action.position.scopeLeft - root.ref.list.rect.element.left,\n      top:\n        action.position.scopeTop -\n        (root.rect.outer.top +\n          root.rect.element.marginTop +\n          root.rect.element.scrollTop)\n    };\n  };\n\n  var clearDragCoordinates = function clearDragCoordinates(_ref3) {\n    var props = _ref3.props;\n    props.dragCoordinates = null;\n  };\n\n  var route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates\n  });\n\n  var write$6 = function write(_ref4) {\n    var root = _ref4.root,\n      props = _ref4.props,\n      actions = _ref4.actions;\n\n    // route actions\n    route$3({ root: root, props: props, actions: actions });\n\n    // current drag position\n    root.ref.list.dragCoordinates = props.dragCoordinates;\n\n    // if currently overflowing but no longer received overflow\n    if (props.overflowing && !props.overflow) {\n      props.overflowing = false;\n\n      // reset overflow state\n      root.element.dataset.state = '';\n      root.height = null;\n    }\n\n    // if is not overflowing currently but does receive overflow value\n    if (props.overflow) {\n      var newHeight = Math.round(props.overflow);\n      if (newHeight !== root.height) {\n        props.overflowing = true;\n        root.element.dataset.state = 'overflow';\n        root.height = newHeight;\n      }\n    }\n  };\n\n  var listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n      apis: ['overflow', 'dragCoordinates'],\n      styles: ['height', 'translateY'],\n      animations: {\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var attrToggle = function attrToggle(element, name, state) {\n    var enabledValue =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n    if (state) {\n      attr(element, name, enabledValue);\n    } else {\n      element.removeAttribute(name);\n    }\n  };\n\n  var resetFileInput = function resetFileInput(input) {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n      return;\n    }\n\n    try {\n      // for modern browsers\n      input.value = '';\n    } catch (err) {}\n\n    // for IE10\n    if (input.value) {\n      // quickly append input to temp form and reset form\n      var form = createElement$1('form');\n      var parentNode = input.parentNode;\n      var ref = input.nextSibling;\n      form.appendChild(input);\n      form.reset();\n\n      // re-inject input where it originally was\n      if (ref) {\n        parentNode.insertBefore(input, ref);\n      } else {\n        parentNode.appendChild(input);\n      }\n    }\n  };\n\n  var create$a = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // set id so can be referenced from outside labels\n    root.element.id = 'filepond--browser-' + props.id;\n\n    // set name of element (is removed when a value is set)\n    attr(root.element, 'name', root.query('GET_NAME'));\n\n    // we have to link this element to the status element\n    attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id);\n\n    // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n    attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id);\n\n    // set configurable props\n    setAcceptedFileTypes({\n      root: root,\n      action: { value: root.query('GET_ACCEPTED_FILE_TYPES') }\n    });\n    toggleAllowMultiple({\n      root: root,\n      action: { value: root.query('GET_ALLOW_MULTIPLE') }\n    });\n    toggleDirectoryFilter({\n      root: root,\n      action: { value: root.query('GET_ALLOW_DIRECTORIES_ONLY') }\n    });\n    toggleDisabled({ root: root });\n    toggleRequired({\n      root: root,\n      action: { value: root.query('GET_REQUIRED') }\n    });\n    setCaptureMethod({\n      root: root,\n      action: { value: root.query('GET_CAPTURE_METHOD') }\n    });\n\n    // handle changes to the input field\n    root.ref.handleChange = function(e) {\n      if (!root.element.value) {\n        return;\n      }\n\n      // extract files and move value of webkitRelativePath path to _relativePath\n      var files = Array.from(root.element.files).map(function(file) {\n        file._relativePath = file.webkitRelativePath;\n        return file;\n      });\n\n      // we add a little delay so the OS file select window can move out of the way before we add our file\n      setTimeout(function() {\n        // load files\n        props.onload(files);\n\n        // reset input, it's just for exposing a method to drop files, should not retain any state\n        resetFileInput(root.element);\n      }, 250);\n    };\n\n    root.element.addEventListener('change', root.ref.handleChange);\n  };\n\n  var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    attrToggle(\n      root.element,\n      'accept',\n      !!action.value,\n      action.value ? action.value.join(',') : ''\n    );\n  };\n\n  var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    attrToggle(root.element, 'multiple', action.value);\n  };\n\n  var toggleDirectoryFilter = function toggleDirectoryFilter(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    attrToggle(root.element, 'webkitdirectory', action.value);\n  };\n\n  var toggleDisabled = function toggleDisabled(_ref5) {\n    var root = _ref5.root;\n    var isDisabled = root.query('GET_DISABLED');\n    var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    var disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n  };\n\n  var toggleRequired = function toggleRequired(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    // want to remove required, always possible\n    if (!action.value) {\n      attrToggle(root.element, 'required', false);\n    }\n    // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n      attrToggle(root.element, 'required', true);\n    }\n  };\n\n  var setCaptureMethod = function setCaptureMethod(_ref7) {\n    var root = _ref7.root,\n      action = _ref7.action;\n    attrToggle(\n      root.element,\n      'capture',\n      !!action.value,\n      action.value === true ? '' : action.value\n    );\n  };\n\n  var updateRequiredStatus = function updateRequiredStatus(_ref8) {\n    var root = _ref8.root;\n    var element = root.element;\n    // always remove the required attribute when more than zero items\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n      attrToggle(element, 'required', false);\n      attrToggle(element, 'name', false);\n    } else {\n      // add name attribute\n      attrToggle(element, 'name', true, root.query('GET_NAME'));\n\n      // remove any validation messages\n      var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n      if (shouldCheckValidity) {\n        element.setCustomValidity('');\n      }\n\n      // we only add required if the field has been deemed required\n      if (root.query('GET_REQUIRED')) {\n        attrToggle(element, 'required', true);\n      }\n    }\n  };\n\n  var updateFieldValidityStatus = function updateFieldValidityStatus(_ref9) {\n    var root = _ref9.root;\n    var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n  };\n\n  var browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n      type: 'file'\n    },\n\n    create: create$a,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n      DID_LOAD_ITEM: updateRequiredStatus,\n      DID_REMOVE_ITEM: updateRequiredStatus,\n      DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n\n      DID_SET_DISABLED: toggleDisabled,\n      DID_SET_ALLOW_BROWSE: toggleDisabled,\n      DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\n      DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n      DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n      DID_SET_CAPTURE_METHOD: setCaptureMethod,\n      DID_SET_REQUIRED: toggleRequired\n    })\n  });\n\n  var Key = {\n    ENTER: 13,\n    SPACE: 32\n  };\n\n  var create$b = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // create the label and link it to the file browser\n    var label = createElement$1('label');\n    attr(label, 'for', 'filepond--browser-' + props.id);\n\n    // use for labeling file input (aria-labelledby on file input)\n    attr(label, 'id', 'filepond--drop-label-' + props.id);\n\n    // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.\n    attr(label, 'aria-hidden', 'true');\n\n    // handle keys\n    root.ref.handleKeyDown = function(e) {\n      var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n      if (!isActivationKey) return;\n      // stops from triggering the element a second time\n      e.preventDefault();\n\n      // click link (will then in turn activate file input)\n      root.ref.label.click();\n    };\n\n    root.ref.handleClick = function(e) {\n      var isLabelClick = e.target === label || label.contains(e.target);\n\n      // don't want to click twice\n      if (isLabelClick) return;\n\n      // click link (will then in turn activate file input)\n      root.ref.label.click();\n    };\n\n    // attach events\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // update\n    updateLabelValue(label, props.caption);\n\n    // add!\n    root.appendChild(label);\n    root.ref.label = label;\n  };\n\n  var updateLabelValue = function updateLabelValue(label, value) {\n    label.innerHTML = value;\n    var clickable = label.querySelector('.filepond--label-action');\n    if (clickable) {\n      attr(clickable, 'tabindex', '0');\n    }\n    return value;\n  };\n\n  var dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: function destroy(_ref2) {\n      var root = _ref2.root;\n      root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n      root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n      DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {\n        var root = _ref3.root,\n          action = _ref3.action;\n        updateLabelValue(root.ref.label, action.value);\n      }\n    }),\n\n    mixins: {\n      styles: ['opacity', 'translateX', 'translateY'],\n      animations: {\n        opacity: { type: 'tween', duration: 150 },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      }\n    }\n  });\n\n  var addBlob = function addBlob(_ref) {\n    var root = _ref.root;\n    var centerX = root.rect.element.width * 0.5;\n    var centerY = root.rect.element.height * 0.5;\n\n    root.ref.blob = root.appendChildView(\n      root.createChildView(blob, {\n        opacity: 0,\n        scaleX: 2.5,\n        scaleY: 2.5,\n        translateX: centerX,\n        translateY: centerY\n      })\n    );\n  };\n\n  var moveBlob = function moveBlob(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!root.ref.blob) {\n      addBlob({ root: root });\n      return;\n    }\n\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n  };\n\n  var hideBlob = function hideBlob(_ref3) {\n    var root = _ref3.root;\n    if (!root.ref.blob) {\n      return;\n    }\n    root.ref.blob.opacity = 0;\n  };\n\n  var explodeBlob = function explodeBlob(_ref4) {\n    var root = _ref4.root;\n    if (!root.ref.blob) {\n      return;\n    }\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n  };\n\n  var write$7 = function write(_ref5) {\n    var root = _ref5.root,\n      props = _ref5.props,\n      actions = _ref5.actions;\n    route$4({ root: root, props: props, actions: actions });\n    var blob = root.ref.blob;\n\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n      root.removeChildView(blob);\n      root.ref.blob = null;\n    }\n  };\n\n  var route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob\n  });\n\n  var drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7\n  });\n\n  var create$c = function create(_ref) {\n    var root = _ref.root;\n    return (root.ref.fields = {});\n  };\n\n  var getField = function getField(root, id) {\n    return root.ref.fields[id];\n  };\n\n  var syncFieldPositionssWithItems = function syncFieldPositionssWithItems(\n    root\n  ) {\n    root.query('GET_ACTIVE_ITEMS').forEach(function(item) {\n      root.element.appendChild(root.ref.fields[item.id]);\n    });\n  };\n\n  var didReorderItems = function didReorderItems(_ref2) {\n    var root = _ref2.root;\n    return syncFieldPositionssWithItems(root);\n  };\n\n  var didAddItem = function didAddItem(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var dataContainer = createElement$1('input');\n    dataContainer.type = 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    dataContainer.disabled = root.query('GET_DISABLED');\n    root.appendChild(dataContainer, 0);\n    root.ref.fields[action.id] = dataContainer;\n  };\n\n  var didLoadItem$1 = function didLoadItem(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    var field = getField(root, action.id);\n    if (!field || action.serverFileReference === null) return;\n    field.value = action.serverFileReference;\n  };\n\n  var didSetDisabled = function didSetDisabled(_ref5) {\n    var root = _ref5.root;\n    root.element.disabled = root.query('GET_DISABLED');\n  };\n\n  var didRemoveItem = function didRemoveItem(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n    field.parentNode.removeChild(field);\n    delete root.ref.fields[action.id];\n  };\n\n  var didDefineValue = function didDefineValue(_ref7) {\n    var root = _ref7.root,\n      action = _ref7.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n    if (action.value === null) {\n      field.removeAttribute('value');\n    } else {\n      field.value = action.value;\n    }\n  };\n\n  var write$8 = createRoute({\n    DID_SET_DISABLED: didSetDisabled,\n    DID_ADD_ITEM: didAddItem,\n    DID_LOAD_ITEM: didLoadItem$1,\n    DID_REMOVE_ITEM: didRemoveItem,\n    DID_DEFINE_VALUE: didDefineValue,\n    DID_REORDER_ITEMS: didReorderItems,\n    DID_SORT_ITEMS: didReorderItems\n  });\n\n  var data = createView({\n    tag: 'fieldset',\n    name: 'data',\n    create: create$c,\n    write: write$8,\n    ignoreRect: true\n  });\n\n  var getRootNode = function getRootNode(element) {\n    return 'getRootNode' in element ? element.getRootNode() : document;\n  };\n\n  var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n  var text$1 = ['css', 'csv', 'html', 'txt'];\n  var map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip'\n  };\n\n  var guesstimateMimeType = function guesstimateMimeType() {\n    var extension =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    extension = extension.toLowerCase();\n    if (images.includes(extension)) {\n      return (\n        'image/' +\n        (extension === 'jpg'\n          ? 'jpeg'\n          : extension === 'svg'\n          ? 'svg+xml'\n          : extension)\n      );\n    }\n    if (text$1.includes(extension)) {\n      return 'text/' + extension;\n    }\n\n    return map[extension] || '';\n  };\n\n  var requestDataTransferItems = function requestDataTransferItems(\n    dataTransfer\n  ) {\n    return new Promise(function(resolve, reject) {\n      // try to get links from transfer, if found we'll exit immidiately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n      var links = getLinks(dataTransfer);\n      if (links.length && !hasFiles(dataTransfer)) {\n        return resolve(links);\n      }\n      // try to get files from the transfer\n      getFiles(dataTransfer).then(resolve);\n    });\n  };\n\n  /**\n   * Test if datatransfer has files\n   */\n  var hasFiles = function hasFiles(dataTransfer) {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n  };\n\n  /**\n   * Extracts files from a DataTransfer object\n   */\n  var getFiles = function getFiles(dataTransfer) {\n    return new Promise(function(resolve, reject) {\n      // get the transfer items as promises\n      var promisedFiles = (dataTransfer.items\n        ? Array.from(dataTransfer.items)\n        : []\n      )\n        // only keep file system items (files and directories)\n        .filter(function(item) {\n          return isFileSystemItem(item);\n        })\n\n        // map each item to promise\n        .map(function(item) {\n          return getFilesFromItem(item);\n        });\n\n      // if is empty, see if we can extract some info from the files property as a fallback\n      if (!promisedFiles.length) {\n        // TODO: test for directories (should not be allowed)\n        // Use FileReader, problem is that the files property gets lost in the process\n        resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n        return;\n      }\n\n      // done!\n      Promise.all(promisedFiles)\n        .then(function(returnedFileGroups) {\n          // flatten groups\n          var files = [];\n          returnedFileGroups.forEach(function(group) {\n            files.push.apply(files, group);\n          });\n\n          // done (filter out empty files)!\n          resolve(\n            files\n              .filter(function(file) {\n                return file;\n              })\n              .map(function(file) {\n                if (!file._relativePath)\n                  file._relativePath = file.webkitRelativePath;\n                return file;\n              })\n          );\n        })\n        .catch(console.error);\n    });\n  };\n\n  var isFileSystemItem = function isFileSystemItem(item) {\n    if (isEntry(item)) {\n      var entry = getAsEntry(item);\n      if (entry) {\n        return entry.isFile || entry.isDirectory;\n      }\n    }\n    return item.kind === 'file';\n  };\n\n  var getFilesFromItem = function getFilesFromItem(item) {\n    return new Promise(function(resolve, reject) {\n      if (isDirectoryEntry(item)) {\n        getFilesInDirectory(getAsEntry(item))\n          .then(resolve)\n          .catch(reject);\n        return;\n      }\n\n      resolve([item.getAsFile()]);\n    });\n  };\n\n  var getFilesInDirectory = function getFilesInDirectory(entry) {\n    return new Promise(function(resolve, reject) {\n      var files = [];\n\n      // the total entries to read\n      var dirCounter = 0;\n      var fileCounter = 0;\n\n      var resolveIfDone = function resolveIfDone() {\n        if (fileCounter === 0 && dirCounter === 0) {\n          resolve(files);\n        }\n      };\n\n      // the recursive function\n      var readEntries = function readEntries(dirEntry) {\n        dirCounter++;\n\n        var directoryReader = dirEntry.createReader();\n\n        // directories are returned in batches, we need to process all batches before we're done\n        var readBatch = function readBatch() {\n          directoryReader.readEntries(function(entries) {\n            if (entries.length === 0) {\n              dirCounter--;\n              resolveIfDone();\n              return;\n            }\n\n            entries.forEach(function(entry) {\n              // recursively read more directories\n              if (entry.isDirectory) {\n                readEntries(entry);\n              } else {\n                // read as file\n                fileCounter++;\n\n                entry.file(function(file) {\n                  var correctedFile = correctMissingFileType(file);\n                  if (entry.fullPath)\n                    correctedFile._relativePath = entry.fullPath;\n                  files.push(correctedFile);\n                  fileCounter--;\n                  resolveIfDone();\n                });\n              }\n            });\n\n            // try to get next batch of files\n            readBatch();\n          }, reject);\n        };\n\n        // read first batch of files\n        readBatch();\n      };\n\n      // go!\n      readEntries(entry);\n    });\n  };\n\n  var correctMissingFileType = function correctMissingFileType(file) {\n    if (file.type.length) return file;\n    var date = file.lastModifiedDate;\n    var name = file.name;\n    file = file.slice(\n      0,\n      file.size,\n      guesstimateMimeType(getExtensionFromFilename(file.name))\n    );\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n  };\n\n  var isDirectoryEntry = function isDirectoryEntry(item) {\n    return isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n  };\n\n  var isEntry = function isEntry(item) {\n    return 'webkitGetAsEntry' in item;\n  };\n\n  var getAsEntry = function getAsEntry(item) {\n    return item.webkitGetAsEntry();\n  };\n\n  /**\n   * Extracts links from a DataTransfer object\n   */\n  var getLinks = function getLinks(dataTransfer) {\n    var links = [];\n    try {\n      // look in meta data property\n      links = getLinksFromTransferMetaData(dataTransfer);\n      if (links.length) {\n        return links;\n      }\n      links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {\n      // nope nope nope (probably IE trouble)\n    }\n    return links;\n  };\n\n  var getLinksFromTransferURLData = function getLinksFromTransferURLData(\n    dataTransfer\n  ) {\n    var data = dataTransfer.getData('url');\n    if (typeof data === 'string' && data.length) {\n      return [data];\n    }\n    return [];\n  };\n\n  var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(\n    dataTransfer\n  ) {\n    var data = dataTransfer.getData('text/html');\n    if (typeof data === 'string' && data.length) {\n      var matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n      if (matches) {\n        return [matches[1]];\n      }\n    }\n    return [];\n  };\n\n  var dragNDropObservers = [];\n\n  var eventPosition = function eventPosition(e) {\n    return {\n      pageLeft: e.pageX,\n      pageTop: e.pageY,\n      scopeLeft: e.offsetX || e.layerX,\n      scopeTop: e.offsetY || e.layerY\n    };\n  };\n\n  var createDragNDropClient = function createDragNDropClient(\n    element,\n    scopeToObserve,\n    filterElement\n  ) {\n    var observer = getDragNDropObserver(scopeToObserve);\n\n    var client = {\n      element: element,\n      filterElement: filterElement,\n      state: null,\n      ondrop: function ondrop() {},\n      onenter: function onenter() {},\n      ondrag: function ondrag() {},\n      onexit: function onexit() {},\n      onload: function onload() {},\n      allowdrop: function allowdrop() {}\n    };\n\n    client.destroy = observer.addListener(client);\n\n    return client;\n  };\n\n  var getDragNDropObserver = function getDragNDropObserver(element) {\n    // see if already exists, if so, return\n    var observer = dragNDropObservers.find(function(item) {\n      return item.element === element;\n    });\n    if (observer) {\n      return observer;\n    }\n\n    // create new observer, does not yet exist for this element\n    var newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n  };\n\n  var createDragNDropObserver = function createDragNDropObserver(element) {\n    var clients = [];\n\n    var routes = {\n      dragenter: dragenter,\n      dragover: dragover,\n      dragleave: dragleave,\n      drop: drop\n    };\n\n    var handlers = {};\n\n    forin(routes, function(event, createHandler) {\n      handlers[event] = createHandler(element, clients);\n      element.addEventListener(event, handlers[event], false);\n    });\n\n    var observer = {\n      element: element,\n      addListener: function addListener(client) {\n        // add as client\n        clients.push(client);\n\n        // return removeListener function\n        return function() {\n          // remove client\n          clients.splice(clients.indexOf(client), 1);\n\n          // if no more clients, clean up observer\n          if (clients.length === 0) {\n            dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n\n            forin(routes, function(event) {\n              element.removeEventListener(event, handlers[event], false);\n            });\n          }\n        };\n      }\n    };\n\n    return observer;\n  };\n\n  var elementFromPoint = function elementFromPoint(root, point) {\n    if (!('elementFromPoint' in root)) {\n      root = document;\n    }\n    return root.elementFromPoint(point.x, point.y);\n  };\n\n  var isEventTarget = function isEventTarget(e, target) {\n    // get root\n    var root = getRootNode(target);\n\n    // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n    var elementAtPosition = elementFromPoint(root, {\n      x: e.pageX - window.pageXOffset,\n      y: e.pageY - window.pageYOffset\n    });\n\n    // test if target is the element or if one of its children is\n    return elementAtPosition === target || target.contains(elementAtPosition);\n  };\n\n  var initialTarget = null;\n\n  var setDropEffect = function setDropEffect(dataTransfer, effect) {\n    // is in try catch as IE11 will throw error if not\n    try {\n      dataTransfer.dropEffect = effect;\n    } catch (e) {}\n  };\n\n  var dragenter = function dragenter(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      initialTarget = e.target;\n\n      clients.forEach(function(client) {\n        var element = client.element,\n          onenter = client.onenter;\n\n        if (isEventTarget(e, element)) {\n          client.state = 'enter';\n\n          // fire enter event\n          onenter(eventPosition(e));\n        }\n      });\n    };\n  };\n\n  var dragover = function dragover(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      var dataTransfer = e.dataTransfer;\n\n      requestDataTransferItems(dataTransfer).then(function(items) {\n        var overDropTarget = false;\n\n        clients.some(function(client) {\n          var filterElement = client.filterElement,\n            element = client.element,\n            onenter = client.onenter,\n            onexit = client.onexit,\n            ondrag = client.ondrag,\n            allowdrop = client.allowdrop;\n\n          // by default we can drop\n          setDropEffect(dataTransfer, 'copy');\n\n          // allow transfer of these items\n          var allowsTransfer = allowdrop(items);\n\n          // only used when can be dropped on page\n          if (!allowsTransfer) {\n            setDropEffect(dataTransfer, 'none');\n            return;\n          }\n\n          // targetting this client\n          if (isEventTarget(e, element)) {\n            overDropTarget = true;\n\n            // had no previous state, means we are entering this client\n            if (client.state === null) {\n              client.state = 'enter';\n              onenter(eventPosition(e));\n              return;\n            }\n\n            // now over element (no matter if it allows the drop or not)\n            client.state = 'over';\n\n            // needs to allow transfer\n            if (filterElement && !allowsTransfer) {\n              setDropEffect(dataTransfer, 'none');\n              return;\n            }\n\n            // dragging\n            ondrag(eventPosition(e));\n          } else {\n            // should be over an element to drop\n            if (filterElement && !overDropTarget) {\n              setDropEffect(dataTransfer, 'none');\n            }\n\n            // might have just left this client?\n            if (client.state) {\n              client.state = null;\n              onexit(eventPosition(e));\n            }\n          }\n        });\n      });\n    };\n  };\n\n  var drop = function drop(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      var dataTransfer = e.dataTransfer;\n\n      requestDataTransferItems(dataTransfer).then(function(items) {\n        clients.forEach(function(client) {\n          var filterElement = client.filterElement,\n            element = client.element,\n            ondrop = client.ondrop,\n            onexit = client.onexit,\n            allowdrop = client.allowdrop;\n\n          client.state = null;\n\n          // if we're filtering on element we need to be over the element to drop\n          if (filterElement && !isEventTarget(e, element)) return;\n\n          // no transfer for this client\n          if (!allowdrop(items)) return onexit(eventPosition(e));\n\n          // we can drop these items on this client\n          ondrop(eventPosition(e), items);\n        });\n      });\n    };\n  };\n\n  var dragleave = function dragleave(root, clients) {\n    return function(e) {\n      if (initialTarget !== e.target) {\n        return;\n      }\n\n      clients.forEach(function(client) {\n        var onexit = client.onexit;\n\n        client.state = null;\n\n        onexit(eventPosition(e));\n      });\n    };\n  };\n\n  var createHopper = function createHopper(scope, validateItems, options) {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper');\n\n    // shortcuts\n    var catchesDropsOnPage = options.catchesDropsOnPage,\n      requiresDropOnElement = options.requiresDropOnElement,\n      _options$filterItems = options.filterItems,\n      filterItems =\n        _options$filterItems === void 0\n          ? function(items) {\n              return items;\n            }\n          : _options$filterItems;\n\n    // create a dnd client\n    var client = createDragNDropClient(\n      scope,\n      catchesDropsOnPage ? document.documentElement : scope,\n      requiresDropOnElement\n    );\n\n    // current client state\n    var lastState = '';\n    var currentState = '';\n\n    // determines if a file may be dropped\n    client.allowdrop = function(items) {\n      // TODO: if we can, throw error to indicate the items cannot by dropped\n\n      return validateItems(filterItems(items));\n    };\n\n    client.ondrop = function(position, items) {\n      var filteredItems = filterItems(items);\n\n      if (!validateItems(filteredItems)) {\n        api.ondragend(position);\n        return;\n      }\n\n      currentState = 'drag-drop';\n\n      api.onload(filteredItems, position);\n    };\n\n    client.ondrag = function(position) {\n      api.ondrag(position);\n    };\n\n    client.onenter = function(position) {\n      currentState = 'drag-over';\n\n      api.ondragstart(position);\n    };\n\n    client.onexit = function(position) {\n      currentState = 'drag-exit';\n\n      api.ondragend(position);\n    };\n\n    var api = {\n      updateHopperState: function updateHopperState() {\n        if (lastState !== currentState) {\n          scope.dataset.hopperState = currentState;\n          lastState = currentState;\n        }\n      },\n      onload: function onload() {},\n      ondragstart: function ondragstart() {},\n      ondrag: function ondrag() {},\n      ondragend: function ondragend() {},\n      destroy: function destroy() {\n        // destroy client\n        client.destroy();\n      }\n    };\n\n    return api;\n  };\n\n  var listening = false;\n  var listeners$1 = [];\n\n  var handlePaste = function handlePaste(e) {\n    requestDataTransferItems(e.clipboardData).then(function(files) {\n      // no files received\n      if (!files.length) {\n        return;\n      }\n\n      // notify listeners of received files\n      listeners$1.forEach(function(listener) {\n        return listener(files);\n      });\n    });\n  };\n\n  var listen = function listen(cb) {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n      return;\n    }\n\n    // add initial listener\n    listeners$1.push(cb);\n\n    // setup paste listener for entire page\n    if (listening) {\n      return;\n    }\n\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n  };\n\n  var unlisten = function unlisten(listener) {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener));\n\n    // clean up\n    if (listeners$1.length === 0) {\n      document.removeEventListener('paste', handlePaste);\n      listening = false;\n    }\n  };\n\n  var createPaster = function createPaster() {\n    var cb = function cb(files) {\n      api.onload(files);\n    };\n\n    var api = {\n      destroy: function destroy() {\n        unlisten(cb);\n      },\n      onload: function onload() {}\n    };\n\n    listen(cb);\n\n    return api;\n  };\n\n  /**\n   * Creates the file view\n   */\n  var create$d = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.element.id = 'filepond--assistant-' + props.id;\n    attr(root.element, 'role', 'status');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n  };\n\n  var addFilesNotificationTimeout = null;\n  var notificationClearTimeout = null;\n\n  var filenames = [];\n\n  var assist = function assist(root, message) {\n    root.element.textContent = message;\n  };\n\n  var clear$1 = function clear(root) {\n    root.element.textContent = '';\n  };\n\n  var listModified = function listModified(root, filename, label) {\n    var total = root.query('GET_TOTAL_ITEMS');\n    assist(\n      root,\n      label +\n        ' ' +\n        filename +\n        ', ' +\n        total +\n        ' ' +\n        (total === 1\n          ? root.query('GET_LABEL_FILE_COUNT_SINGULAR')\n          : root.query('GET_LABEL_FILE_COUNT_PLURAL'))\n    );\n\n    // clear group after set amount of time so the status is not read twice\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(function() {\n      clear$1(root);\n    }, 1500);\n  };\n\n  var isUsingFilePond = function isUsingFilePond(root) {\n    return root.element.parentNode.contains(document.activeElement);\n  };\n\n  var itemAdded = function itemAdded(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    root.element.textContent = '';\n    var item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(function() {\n      listModified(\n        root,\n        filenames.join(', '),\n        root.query('GET_LABEL_FILE_ADDED')\n      );\n\n      filenames.length = 0;\n    }, 750);\n  };\n\n  var itemRemoved = function itemRemoved(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    var item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n  };\n\n  var itemProcessed = function itemProcessed(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemProcessedUndo = function itemProcessedUndo(_ref5) {\n    var root = _ref5.root,\n      action = _ref5.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemError = function itemError(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);\n  };\n\n  var assistant = createView({\n    create: create$d,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: itemAdded,\n      DID_REMOVE_ITEM: itemRemoved,\n      DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n\n      DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n\n      DID_THROW_ITEM_REMOVE_ERROR: itemError,\n      DID_THROW_ITEM_LOAD_ERROR: itemError,\n      DID_THROW_ITEM_INVALID: itemError,\n      DID_THROW_ITEM_PROCESSING_ERROR: itemError\n    }),\n\n    tag: 'span',\n    name: 'assistant'\n  });\n\n  var toCamels = function toCamels(string) {\n    var separator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.replace(new RegExp(separator + '.', 'g'), function(sub) {\n      return sub.charAt(1).toUpperCase();\n    });\n  };\n\n  var debounce = function debounce(func) {\n    var interval =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n    var immidiateOnly =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var last = Date.now();\n    var timeout = null;\n\n    return function() {\n      for (\n        var _len = arguments.length, args = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        args[_key] = arguments[_key];\n      }\n      clearTimeout(timeout);\n\n      var dist = Date.now() - last;\n\n      var fn = function fn() {\n        last = Date.now();\n        func.apply(void 0, args);\n      };\n\n      if (dist < interval) {\n        // we need to delay by the difference between interval and dist\n        // for example: if distance is 10 ms and interval is 16 ms,\n        // we need to wait an additional 6ms before calling the function)\n        if (!immidiateOnly) {\n          timeout = setTimeout(fn, interval - dist);\n        }\n      } else {\n        // go!\n        fn();\n      }\n    };\n  };\n\n  var MAX_FILES_LIMIT = 1000000;\n\n  var prevent = function prevent(e) {\n    return e.preventDefault();\n  };\n\n  var create$e = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // Add id\n    var id = root.query('GET_ID');\n    if (id) {\n      root.element.id = id;\n    }\n\n    // Add className\n    var className = root.query('GET_CLASS_NAME');\n    if (className) {\n      className\n        .split(' ')\n        .filter(function(name) {\n          return name.length;\n        })\n        .forEach(function(name) {\n          root.element.classList.add(name);\n        });\n    }\n\n    // Field label\n    root.ref.label = root.appendChildView(\n      root.createChildView(\n        dropLabel,\n        Object.assign({}, props, {\n          translateY: null,\n          caption: root.query('GET_LABEL_IDLE')\n        })\n      )\n    );\n\n    // List of items\n    root.ref.list = root.appendChildView(\n      root.createChildView(listScroller, { translateY: null })\n    );\n\n    // Background panel\n    root.ref.panel = root.appendChildView(\n      root.createChildView(panel, { name: 'panel-root' })\n    );\n\n    // Assistant notifies assistive tech when content changes\n    root.ref.assistant = root.appendChildView(\n      root.createChildView(assistant, Object.assign({}, props))\n    );\n\n    // Data\n    root.ref.data = root.appendChildView(\n      root.createChildView(data, Object.assign({}, props))\n    );\n\n    // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure);\n\n    // information on the root height or fixed height status\n    root.ref.bounds = null;\n\n    // apply initial style properties\n    root\n      .query('GET_STYLES')\n      .filter(function(style) {\n        return !isEmpty(style.value);\n      })\n      .map(function(_ref2) {\n        var name = _ref2.name,\n          value = _ref2.value;\n        root.element.dataset[name] = value;\n      });\n\n    // determine if width changed\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(function() {\n      root.ref.updateHistory = [];\n      root.dispatch('DID_RESIZE_ROOT');\n    }, 250);\n\n    // history of updates\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = [];\n\n    // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\n    var canHover = window.matchMedia('(pointer: fine) and (hover: hover)')\n      .matches;\n    var hasPointerEvents = 'PointerEvent' in window;\n    if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\n      root.element.addEventListener('touchmove', prevent, { passive: false });\n      root.element.addEventListener('gesturestart', prevent);\n    }\n  };\n\n  var write$9 = function write(_ref3) {\n    var root = _ref3.root,\n      props = _ref3.props,\n      actions = _ref3.actions;\n\n    // route actions\n    route$5({ root: root, props: props, actions: actions });\n\n    // apply style properties\n    actions\n      .filter(function(action) {\n        return /^DID_SET_STYLE_/.test(action.type);\n      })\n      .filter(function(action) {\n        return !isEmpty(action.data.value);\n      })\n      .map(function(_ref4) {\n        var type = _ref4.type,\n          data = _ref4.data;\n        var name = toCamels(type.substr(8).toLowerCase(), '_');\n        root.element.dataset[name] = data.value;\n        root.invalidateLayout();\n      });\n\n    if (root.rect.element.hidden) return;\n\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n      root.ref.widthPrevious = root.rect.element.width;\n      root.ref.widthUpdated();\n    }\n\n    // get box bounds, we do this only once\n    var bounds = root.ref.bounds;\n    if (!bounds) {\n      bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);\n\n      // destroy measure element\n      root.element.removeChild(root.ref.measure);\n      root.ref.measure = null;\n    }\n\n    // get quick references to various high level parts of the upload tool\n    var _root$ref = root.ref,\n      hopper = _root$ref.hopper,\n      label = _root$ref.label,\n      list = _root$ref.list,\n      panel = _root$ref.panel;\n\n    // sets correct state to hopper scope\n    if (hopper) {\n      hopper.updateHopperState();\n    }\n\n    // bool to indicate if we're full or not\n    var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    var isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = isMultiItem\n      ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT\n      : 1;\n    var atMaxCapacity = totalItems === maxItems;\n\n    // action used to add item\n    var addAction = actions.find(function(action) {\n      return action.type === 'DID_ADD_ITEM';\n    });\n\n    // if reached max capacity and we've just reached it\n    if (atMaxCapacity && addAction) {\n      // get interaction type\n      var interactionMethod = addAction.data.interactionMethod;\n\n      // hide label\n      label.opacity = 0;\n\n      if (isMultiItem) {\n        label.translateY = -40;\n      } else {\n        if (interactionMethod === InteractionMethod.API) {\n          label.translateX = 40;\n        } else if (interactionMethod === InteractionMethod.BROWSE) {\n          label.translateY = 40;\n        } else {\n          label.translateY = 30;\n        }\n      }\n    } else if (!atMaxCapacity) {\n      label.opacity = 1;\n      label.translateX = 0;\n      label.translateY = 0;\n    }\n\n    var listItemMargin = calculateListItemMargin(root);\n\n    var listHeight = calculateListHeight(root);\n\n    var labelHeight = label.rect.element.height;\n    var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n\n    var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    var listMarginBottom =\n      totalItems === 0 ? 0 : list.rect.element.marginBottom;\n\n    var visualHeight =\n      currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    var boundsHeight =\n      currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;\n\n    // link list to label bottom position\n    list.translateY =\n      Math.max(0, currentLabelHeight - list.rect.element.marginTop) -\n      listItemMargin.top;\n\n    if (aspectRatio) {\n      // fixed aspect ratio\n\n      // calculate height based on width\n      var width = root.rect.element.width;\n      var height = width * aspectRatio;\n\n      // clear history if aspect ratio has changed\n      if (aspectRatio !== root.ref.previousAspectRatio) {\n        root.ref.previousAspectRatio = aspectRatio;\n        root.ref.updateHistory = [];\n      }\n\n      // remember this width\n      var history = root.ref.updateHistory;\n      history.push(width);\n\n      var MAX_BOUNCES = 2;\n      if (history.length > MAX_BOUNCES * 2) {\n        var l = history.length;\n        var bottom = l - 10;\n        var bounces = 0;\n        for (var i = l; i >= bottom; i--) {\n          if (history[i] === history[i - 2]) {\n            bounces++;\n          }\n\n          if (bounces >= MAX_BOUNCES) {\n            // dont adjust height\n            return;\n          }\n        }\n      }\n\n      // fix height of panel so it adheres to aspect ratio\n      panel.scalable = false;\n      panel.height = height;\n\n      // available height for list\n      var listAvailableHeight =\n        // the height of the panel minus the label height\n        height -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      if (listHeight.visual > listAvailableHeight) {\n        list.overflow = listAvailableHeight;\n      } else {\n        list.overflow = null;\n      }\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = height;\n    } else if (bounds.fixedHeight) {\n      // fixed height\n\n      // fix height of panel\n      panel.scalable = false;\n\n      // available height for list\n      var _listAvailableHeight =\n        // the height of the panel minus the label height\n        bounds.fixedHeight -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      // set list height\n      if (listHeight.visual > _listAvailableHeight) {\n        list.overflow = _listAvailableHeight;\n      } else {\n        list.overflow = null;\n      }\n\n      // no need to set container bounds as these are handles by CSS fixed height\n    } else if (bounds.cappedHeight) {\n      // max-height\n\n      // not a fixed height panel\n      var isCappedHeight = visualHeight >= bounds.cappedHeight;\n      var panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n      panel.scalable = true;\n      panel.height = isCappedHeight\n        ? panelHeight\n        : panelHeight - listItemMargin.top - listItemMargin.bottom;\n\n      // available height for list\n      var _listAvailableHeight2 =\n        // the height of the panel minus the label height\n        panelHeight -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      // set list height (if is overflowing)\n      if (\n        visualHeight > bounds.cappedHeight &&\n        listHeight.visual > _listAvailableHeight2\n      ) {\n        list.overflow = _listAvailableHeight2;\n      } else {\n        list.overflow = null;\n      }\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = Math.min(\n        bounds.cappedHeight,\n        boundsHeight - listItemMargin.top - listItemMargin.bottom\n      );\n    } else {\n      // flexible height\n\n      // not a fixed height panel\n      var itemMargin =\n        totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n      panel.scalable = true;\n      panel.height = Math.max(labelHeight, visualHeight - itemMargin);\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    }\n  };\n\n  var calculateListItemMargin = function calculateListItemMargin(root) {\n    var item = root.ref.list.childViews[0].childViews[0];\n    return item\n      ? {\n          top: item.rect.element.marginTop,\n          bottom: item.rect.element.marginBottom\n        }\n      : {\n          top: 0,\n          bottom: 0\n        };\n  };\n\n  var calculateListHeight = function calculateListHeight(root) {\n    var visual = 0;\n    var bounds = 0;\n\n    // get file list reference\n    var scrollList = root.ref.list;\n    var itemList = scrollList.childViews[0];\n    var visibleChildren = itemList.childViews.filter(function(child) {\n      return child.rect.element.height;\n    });\n    var children = root\n      .query('GET_ACTIVE_ITEMS')\n      .map(function(item) {\n        return visibleChildren.find(function(child) {\n          return child.id === item.id;\n        });\n      })\n      .filter(function(item) {\n        return item;\n      });\n\n    // no children, done!\n    if (children.length === 0) return { visual: visual, bounds: bounds };\n\n    var horizontalSpace = itemList.rect.element.width;\n    var dragIndex = getItemIndexByPosition(\n      itemList,\n      children,\n      scrollList.dragCoordinates\n    );\n\n    var childRect = children[0].rect.element;\n\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n\n    var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    var removedItem = children.find(function(child) {\n      return child.markedForRemoval && child.opacity < 0.45;\n    })\n      ? -1\n      : 0;\n    var verticalItemCount = children.length + newItem + removedItem;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      children.forEach(function(item) {\n        var height = item.rect.element.height + itemVerticalMargin;\n        bounds += height;\n        visual += height * item.opacity;\n      });\n    }\n    // grid\n    else {\n      bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n      visual = bounds;\n    }\n\n    return { visual: visual, bounds: bounds };\n  };\n\n  var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(\n    root\n  ) {\n    var height = root.ref.measureHeight || null;\n    var cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    var fixedHeight = height === 0 ? null : height;\n\n    return {\n      cappedHeight: cappedHeight,\n      fixedHeight: fixedHeight\n    };\n  };\n\n  var exceedsMaxFiles = function exceedsMaxFiles(root, items) {\n    var allowReplace = root.query('GET_ALLOW_REPLACE');\n    var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = root.query('GET_MAX_FILES');\n\n    // total amount of items being dragged\n    var totalBrowseItems = items.length;\n\n    // if does not allow multiple items and dragging more than one item\n    if (!allowMultiple && totalBrowseItems > 1) {\n      return true;\n    }\n\n    // limit max items to one if not allowed to drop multiple items\n    maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1;\n\n    // no more room?\n    var hasMaxItems = isInt(maxItems);\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n      root.dispatch('DID_THROW_MAX_FILES', {\n        source: items,\n        error: createResponse('warning', 0, 'Max files')\n      });\n\n      return true;\n    }\n\n    return false;\n  };\n\n  var getDragIndex = function getDragIndex(list, children, position) {\n    var itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, children, {\n      left: position.scopeLeft - itemList.rect.element.left,\n      top:\n        position.scopeTop -\n        (list.rect.outer.top +\n          list.rect.element.marginTop +\n          list.rect.element.scrollTop)\n    });\n  };\n\n  /**\n   * Enable or disable file drop functionality\n   */\n  var toggleDrop = function toggleDrop(root) {\n    var isAllowed = root.query('GET_ALLOW_DROP');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.hopper) {\n      var hopper = createHopper(\n        root.element,\n        function(items) {\n          // these files don't fit so stop here\n          if (exceedsMaxFiles(root, items)) return false;\n\n          // allow quick validation of dropped items\n          var beforeDropFile =\n            root.query('GET_BEFORE_DROP_FILE') ||\n            function() {\n              return true;\n            };\n\n          // all items should be validated by all filters as valid\n          var dropValidation = root.query('GET_DROP_VALIDATION');\n          return dropValidation\n            ? items.every(function(item) {\n                return (\n                  applyFilters('ALLOW_HOPPER_ITEM', item, {\n                    query: root.query\n                  }).every(function(result) {\n                    return result === true;\n                  }) && beforeDropFile(item)\n                );\n              })\n            : true;\n        },\n        {\n          filterItems: function filterItems(items) {\n            var ignoredFiles = root.query('GET_IGNORED_FILES');\n            return items.filter(function(item) {\n              if (isFile(item)) {\n                return !ignoredFiles.includes(item.name.toLowerCase());\n              }\n              return true;\n            });\n          },\n          catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n          requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT')\n        }\n      );\n\n      hopper.onload = function(items, position) {\n        // get item children elements and sort based on list sort\n        var list = root.ref.list.childViews[0];\n        var visibleChildren = list.childViews.filter(function(child) {\n          return child.rect.element.height;\n        });\n        var children = root\n          .query('GET_ACTIVE_ITEMS')\n          .map(function(item) {\n            return visibleChildren.find(function(child) {\n              return child.id === item.id;\n            });\n          })\n          .filter(function(item) {\n            return item;\n          });\n\n        // go\n        root.dispatch('ADD_ITEMS', {\n          items: items,\n          index: getDragIndex(root.ref.list, children, position),\n          interactionMethod: InteractionMethod.DROP\n        });\n\n        root.dispatch('DID_DROP', { position: position });\n\n        root.dispatch('DID_END_DRAG', { position: position });\n      };\n\n      hopper.ondragstart = function(position) {\n        root.dispatch('DID_START_DRAG', { position: position });\n      };\n\n      hopper.ondrag = debounce(function(position) {\n        root.dispatch('DID_DRAG', { position: position });\n      });\n\n      hopper.ondragend = function(position) {\n        root.dispatch('DID_END_DRAG', { position: position });\n      };\n\n      root.ref.hopper = hopper;\n\n      root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n      root.ref.hopper.destroy();\n      root.ref.hopper = null;\n      root.removeChildView(root.ref.drip);\n    }\n  };\n\n  /**\n   * Enable or disable browse functionality\n   */\n  var toggleBrowse = function toggleBrowse(root, props) {\n    var isAllowed = root.query('GET_ALLOW_BROWSE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.browser) {\n      root.ref.browser = root.appendChildView(\n        root.createChildView(\n          browser,\n          Object.assign({}, props, {\n            onload: function onload(items) {\n              // these files don't fit so stop here\n              if (exceedsMaxFiles(root, items)) return false;\n\n              // add items!\n              root.dispatch('ADD_ITEMS', {\n                items: items,\n                index: -1,\n                interactionMethod: InteractionMethod.BROWSE\n              });\n            }\n          })\n        ),\n\n        0\n      );\n    } else if (!enabled && root.ref.browser) {\n      root.removeChildView(root.ref.browser);\n      root.ref.browser = null;\n    }\n  };\n\n  /**\n   * Enable or disable paste functionality\n   */\n  var togglePaste = function togglePaste(root) {\n    var isAllowed = root.query('GET_ALLOW_PASTE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.paster) {\n      root.ref.paster = createPaster();\n      root.ref.paster.onload = function(items) {\n        root.dispatch('ADD_ITEMS', {\n          items: items,\n          index: -1,\n          interactionMethod: InteractionMethod.PASTE\n        });\n      };\n    } else if (!enabled && root.ref.paster) {\n      root.ref.paster.destroy();\n      root.ref.paster = null;\n    }\n  };\n\n  /**\n   * Route actions\n   */\n  var route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {\n      var root = _ref6.root;\n      toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {\n      var root = _ref7.root;\n      togglePaste(root);\n    },\n    DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {\n      var root = _ref8.root,\n        props = _ref8.props;\n      toggleDrop(root);\n      togglePaste(root);\n      toggleBrowse(root, props);\n      var isDisabled = root.query('GET_DISABLED');\n      if (isDisabled) {\n        root.element.dataset.disabled = 'disabled';\n      } else {\n        // delete root.element.dataset.disabled; <= this does not work on iOS 10\n        root.element.removeAttribute('data-disabled');\n      }\n    }\n  });\n\n  var root = createView({\n    name: 'root',\n    read: function read(_ref9) {\n      var root = _ref9.root;\n      if (root.ref.measure) {\n        root.ref.measureHeight = root.ref.measure.offsetHeight;\n      }\n    },\n    create: create$e,\n    write: write$9,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      if (root.ref.paster) {\n        root.ref.paster.destroy();\n      }\n      if (root.ref.hopper) {\n        root.ref.hopper.destroy();\n      }\n      root.element.removeEventListener('touchmove', prevent);\n      root.element.removeEventListener('gesturestart', prevent);\n    },\n    mixins: {\n      styles: ['height']\n    }\n  });\n\n  // creates the app\n  var createApp = function createApp() {\n    var initialOptions =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // let element\n    var originalElement = null;\n\n    // get default options\n    var defaultOptions = getOptions();\n\n    // create the data store, this will contain all our app info\n    var store = createStore(\n      // initial state (should be serializable)\n      createInitialState(defaultOptions),\n\n      // queries\n      [queries, createOptionQueries(defaultOptions)],\n\n      // action handlers\n      [actions, createOptionActions(defaultOptions)]\n    );\n\n    // set initial options\n    store.dispatch('SET_OPTIONS', { options: initialOptions });\n\n    // kick thread if visibility changes\n    var visibilityHandler = function visibilityHandler() {\n      if (document.hidden) return;\n      store.dispatch('KICK');\n    };\n    document.addEventListener('visibilitychange', visibilityHandler);\n\n    // re-render on window resize start and finish\n    var resizeDoneTimer = null;\n    var isResizing = false;\n    var isResizingHorizontally = false;\n    var initialWindowWidth = null;\n    var currentWindowWidth = null;\n    var resizeHandler = function resizeHandler() {\n      if (!isResizing) {\n        isResizing = true;\n      }\n      clearTimeout(resizeDoneTimer);\n      resizeDoneTimer = setTimeout(function() {\n        isResizing = false;\n        initialWindowWidth = null;\n        currentWindowWidth = null;\n        if (isResizingHorizontally) {\n          isResizingHorizontally = false;\n          store.dispatch('DID_STOP_RESIZE');\n        }\n      }, 500);\n    };\n    window.addEventListener('resize', resizeHandler);\n\n    // render initial view\n    var view = root(store, { id: getUniqueId() });\n\n    //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n    var isResting = false;\n    var isHidden = false;\n\n    var readWriteApi = {\n      // necessary for update loop\n\n      /**\n       * Reads from dom (never call manually)\n       * @private\n       */\n      _read: function _read() {\n        // test if we're resizing horizontally\n        // TODO: see if we can optimize this by measuring root rect\n        if (isResizing) {\n          currentWindowWidth = window.innerWidth;\n          if (!initialWindowWidth) {\n            initialWindowWidth = currentWindowWidth;\n          }\n\n          if (\n            !isResizingHorizontally &&\n            currentWindowWidth !== initialWindowWidth\n          ) {\n            store.dispatch('DID_START_RESIZE');\n            isResizingHorizontally = true;\n          }\n        }\n\n        if (isHidden && isResting) {\n          // test if is no longer hidden\n          isResting = view.element.offsetParent === null;\n        }\n\n        // if resting, no need to read as numbers will still all be correct\n        if (isResting) return;\n\n        // read view data\n        view._read();\n\n        // if is hidden we need to know so we exit rest mode when revealed\n        isHidden = view.rect.element.hidden;\n      },\n\n      /**\n       * Writes to dom (never call manually)\n       * @private\n       */\n      _write: function _write(ts) {\n        // get all actions from store\n        var actions = store\n          .processActionQueue()\n\n          // filter out set actions (these will automatically trigger DID_SET)\n          .filter(function(action) {\n            return !/^SET_/.test(action.type);\n          });\n\n        // if was idling and no actions stop here\n        if (isResting && !actions.length) return;\n\n        // some actions might trigger events\n        routeActionsToEvents(actions);\n\n        // update the view\n        isResting = view._write(ts, actions, isResizingHorizontally);\n\n        // will clean up all archived items\n        removeReleasedItems(store.query('GET_ITEMS'));\n\n        // now idling\n        if (isResting) {\n          store.processDispatchQueue();\n        }\n      }\n    };\n\n    //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n    var createEvent = function createEvent(name) {\n      return function(data) {\n        // create default event\n        var event = {\n          type: name\n        };\n\n        // no data to add\n        if (!data) {\n          return event;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('error')) {\n          event.error = data.error ? Object.assign({}, data.error) : null;\n        }\n\n        if (data.status) {\n          event.status = Object.assign({}, data.status);\n        }\n\n        if (data.file) {\n          event.output = data.file;\n        }\n\n        // only source is available, else add item if possible\n        if (data.source) {\n          event.file = data.source;\n        } else if (data.item || data.id) {\n          var item = data.item ? data.item : store.query('GET_ITEM', data.id);\n          event.file = item ? createItemAPI(item) : null;\n        }\n\n        // map all items in a possible items array\n        if (data.items) {\n          event.items = data.items.map(createItemAPI);\n        }\n\n        // if this is a progress event add the progress amount\n        if (/progress/.test(name)) {\n          event.progress = data.progress;\n        }\n\n        return event;\n      };\n    };\n\n    var eventRoutes = {\n      DID_DESTROY: createEvent('destroy'),\n\n      DID_INIT: createEvent('init'),\n\n      DID_THROW_MAX_FILES: createEvent('warning'),\n\n      DID_START_ITEM_LOAD: createEvent('addfilestart'),\n      DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n      DID_LOAD_ITEM: createEvent('addfile'),\n\n      DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n\n      DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n\n      DID_THROW_ITEM_REMOVE_ERROR: [\n        createEvent('error'),\n        createEvent('removefile')\n      ],\n\n      DID_PREPARE_OUTPUT: createEvent('preparefile'),\n\n      DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n      DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n      DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n      DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n      DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n\n      DID_THROW_ITEM_PROCESSING_ERROR: [\n        createEvent('error'),\n        createEvent('processfile')\n      ],\n\n      DID_REMOVE_ITEM: createEvent('removefile'),\n\n      DID_UPDATE_ITEMS: createEvent('updatefiles'),\n\n      DID_ACTIVATE_ITEM: createEvent('activatefile'),\n\n      DID_REORDER_ITEMS: createEvent('reorderfiles')\n    };\n\n    var exposeEvent = function exposeEvent(event) {\n      // create event object to be dispatched\n      var detail = Object.assign({ pond: exports }, event);\n      delete detail.type;\n      view.element.dispatchEvent(\n        new CustomEvent('FilePond:' + event.type, {\n          // event info\n          detail: detail,\n\n          // event behaviour\n          bubbles: true,\n          cancelable: true,\n          composed: true // triggers listeners outside of shadow root\n        })\n      );\n\n      // event object to params used for `on()` event handlers and callbacks `oninit()`\n      var params = [];\n\n      // if is possible error event, make it the first param\n      if (event.hasOwnProperty('error')) {\n        params.push(event.error);\n      }\n\n      // file is always section\n      if (event.hasOwnProperty('file')) {\n        params.push(event.file);\n      }\n\n      // append other props\n      var filtered = ['type', 'error', 'file'];\n      Object.keys(event)\n        .filter(function(key) {\n          return !filtered.includes(key);\n        })\n        .forEach(function(key) {\n          return params.push(event[key]);\n        });\n\n      // on(type, () => { })\n      exports.fire.apply(exports, [event.type].concat(params));\n\n      // oninit = () => {}\n      var handler = store.query('GET_ON' + event.type.toUpperCase());\n      if (handler) {\n        handler.apply(void 0, params);\n      }\n    };\n\n    var routeActionsToEvents = function routeActionsToEvents(actions) {\n      if (!actions.length) {\n        return;\n      }\n\n      actions.forEach(function(action) {\n        if (!eventRoutes[action.type]) {\n          return;\n        }\n        var routes = eventRoutes[action.type];\n        (Array.isArray(routes) ? routes : [routes]).forEach(function(route) {\n          setTimeout(function() {\n            exposeEvent(route(action.data));\n          }, 0);\n        });\n      });\n    };\n\n    //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n    var setOptions = function setOptions(options) {\n      return store.dispatch('SET_OPTIONS', { options: options });\n    };\n\n    var getFile = function getFile(query) {\n      return store.query('GET_ACTIVE_ITEM', query);\n    };\n\n    var prepareFile = function prepareFile(query) {\n      return new Promise(function(resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PREPARE', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var addFile = function addFile(source) {\n      var options =\n        arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new Promise(function(resolve, reject) {\n        addFiles([{ source: source, options: options }], {\n          index: options.index\n        })\n          .then(function(items) {\n            return resolve(items && items[0]);\n          })\n          .catch(reject);\n      });\n    };\n\n    var removeFile = function removeFile(query) {\n      // request item removal\n      store.dispatch('REMOVE_ITEM', { query: query });\n\n      // see if item has been removed\n      return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n\n    var addFiles = function addFiles() {\n      for (\n        var _len = arguments.length, args = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        args[_key] = arguments[_key];\n      }\n      return new Promise(function(resolve, reject) {\n        var sources = [];\n        var options = {};\n\n        // user passed a sources array\n        if (isArray(args[0])) {\n          sources.push.apply(sources, args[0]);\n          Object.assign(options, args[1] || {});\n        } else {\n          // user passed sources as arguments, last one might be options object\n          var lastArgument = args[args.length - 1];\n          if (\n            typeof lastArgument === 'object' &&\n            !(lastArgument instanceof Blob)\n          ) {\n            Object.assign(options, args.pop());\n          }\n\n          // add rest to sources\n          sources.push.apply(sources, args);\n        }\n\n        store.dispatch('ADD_ITEMS', {\n          items: sources,\n          index: options.index,\n          interactionMethod: InteractionMethod.API,\n          success: resolve,\n          failure: reject\n        });\n      });\n    };\n\n    var getFiles = function getFiles() {\n      return store.query('GET_ACTIVE_ITEMS');\n    };\n\n    var processFile = function processFile(query) {\n      return new Promise(function(resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PROCESSING', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var prepareFiles = function prepareFiles() {\n      for (\n        var _len2 = arguments.length, args = new Array(_len2), _key2 = 0;\n        _key2 < _len2;\n        _key2++\n      ) {\n        args[_key2] = arguments[_key2];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var items = queries.length ? queries : getFiles();\n      return Promise.all(items.map(prepareFile));\n    };\n\n    var processFiles = function processFiles() {\n      for (\n        var _len3 = arguments.length, args = new Array(_len3), _key3 = 0;\n        _key3 < _len3;\n        _key3++\n      ) {\n        args[_key3] = arguments[_key3];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      if (!queries.length) {\n        var files = getFiles().filter(function(item) {\n          return (\n            !(\n              item.status === ItemStatus.IDLE &&\n              item.origin === FileOrigin.LOCAL\n            ) &&\n            item.status !== ItemStatus.PROCESSING &&\n            item.status !== ItemStatus.PROCESSING_COMPLETE &&\n            item.status !== ItemStatus.PROCESSING_REVERT_ERROR\n          );\n        });\n\n        return Promise.all(files.map(processFile));\n      }\n      return Promise.all(queries.map(processFile));\n    };\n\n    var removeFiles = function removeFiles() {\n      for (\n        var _len4 = arguments.length, args = new Array(_len4), _key4 = 0;\n        _key4 < _len4;\n        _key4++\n      ) {\n        args[_key4] = arguments[_key4];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var files = getFiles();\n\n      if (!queries.length) {\n        return Promise.all(files.map(removeFile));\n      }\n\n      // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n      var mappedQueries = queries\n        .map(function(query) {\n          return isNumber(query)\n            ? files[query]\n              ? files[query].id\n              : null\n            : query;\n        })\n        .filter(function(query) {\n          return query;\n        });\n\n      return mappedQueries.map(removeFile);\n    };\n\n    var exports = Object.assign(\n      {},\n\n      on(),\n      {},\n\n      readWriteApi,\n      {},\n\n      createOptionAPI(store, defaultOptions),\n      {\n        /**\n         * Override options defined in options object\n         * @param options\n         */\n        setOptions: setOptions,\n\n        /**\n         * Load the given file\n         * @param source - the source of the file (either a File, base64 data uri or url)\n         * @param options - object, { index: 0 }\n         */\n        addFile: addFile,\n\n        /**\n         * Load the given files\n         * @param sources - the sources of the files to load\n         * @param options - object, { index: 0 }\n         */\n        addFiles: addFiles,\n\n        /**\n         * Returns the file objects matching the given query\n         * @param query { string, number, null }\n         */\n        getFile: getFile,\n\n        /**\n         * Upload file with given name\n         * @param query { string, number, null  }\n         */\n        processFile: processFile,\n\n        /**\n         * Request prepare output for file with given name\n         * @param query { string, number, null  }\n         */\n        prepareFile: prepareFile,\n\n        /**\n         * Removes a file by its name\n         * @param query { string, number, null  }\n         */\n        removeFile: removeFile,\n\n        /**\n         * Moves a file to a new location in the files list\n         */\n        moveFile: function moveFile(query, index) {\n          return store.dispatch('MOVE_ITEM', { query: query, index: index });\n        },\n\n        /**\n         * Returns all files (wrapped in public api)\n         */\n        getFiles: getFiles,\n\n        /**\n         * Starts uploading all files\n         */\n        processFiles: processFiles,\n\n        /**\n         * Clears all files from the files list\n         */\n        removeFiles: removeFiles,\n\n        /**\n         * Starts preparing output of all files\n         */\n        prepareFiles: prepareFiles,\n\n        /**\n         * Sort list of files\n         */\n        sort: function sort(compare) {\n          return store.dispatch('SORT', { compare: compare });\n        },\n\n        /**\n         * Browse the file system for a file\n         */\n        browse: function browse() {\n          // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n          var input = view.element.querySelector('input[type=file]');\n          if (input) {\n            input.click();\n          }\n        },\n\n        /**\n         * Destroys the app\n         */\n        destroy: function destroy() {\n          // request destruction\n          exports.fire('destroy', view.element);\n\n          // stop active processes (file uploads, fetches, stuff like that)\n          // loop over items and depending on states call abort for ongoing processes\n          store.dispatch('ABORT_ALL');\n\n          // destroy view\n          view._destroy();\n\n          // stop listening to resize\n          window.removeEventListener('resize', resizeHandler);\n\n          // stop listening to the visiblitychange event\n          document.removeEventListener('visibilitychange', visibilityHandler);\n\n          // dispatch destroy\n          store.dispatch('DID_DESTROY');\n        },\n\n        /**\n         * Inserts the plugin before the target element\n         */\n        insertBefore: function insertBefore$1(element) {\n          return insertBefore(view.element, element);\n        },\n\n        /**\n         * Inserts the plugin after the target element\n         */\n        insertAfter: function insertAfter$1(element) {\n          return insertAfter(view.element, element);\n        },\n\n        /**\n         * Appends the plugin to the target element\n         */\n        appendTo: function appendTo(element) {\n          return element.appendChild(view.element);\n        },\n\n        /**\n         * Replaces an element with the app\n         */\n        replaceElement: function replaceElement(element) {\n          // insert the app before the element\n          insertBefore(view.element, element);\n\n          // remove the original element\n          element.parentNode.removeChild(element);\n\n          // remember original element\n          originalElement = element;\n        },\n\n        /**\n         * Restores the original element\n         */\n        restoreElement: function restoreElement() {\n          if (!originalElement) {\n            return; // no element to restore\n          }\n\n          // restore original element\n          insertAfter(originalElement, view.element);\n\n          // remove our element\n          view.element.parentNode.removeChild(view.element);\n\n          // remove reference\n          originalElement = null;\n        },\n\n        /**\n         * Returns true if the app root is attached to given element\n         * @param element\n         */\n        isAttachedTo: function isAttachedTo(element) {\n          return view.element === element || originalElement === element;\n        },\n\n        /**\n         * Returns the root element\n         */\n        element: {\n          get: function get() {\n            return view.element;\n          }\n        },\n\n        /**\n         * Returns the current pond status\n         */\n        status: {\n          get: function get() {\n            return store.query('GET_STATUS');\n          }\n        }\n      }\n    );\n\n    // Done!\n    store.dispatch('DID_INIT');\n\n    // create actual api object\n    return createObject(exports);\n  };\n\n  var createAppObject = function createAppObject() {\n    var customOptions =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // default options\n    var defaultOptions = {};\n    forin(getOptions(), function(key, value) {\n      defaultOptions[key] = value[0];\n    });\n\n    // set app options\n    var app = createApp(\n      Object.assign(\n        {},\n\n        defaultOptions,\n        {},\n\n        customOptions\n      )\n    );\n\n    // return the plugin instance\n    return app;\n  };\n\n  var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {\n    return string.charAt(0).toLowerCase() + string.slice(1);\n  };\n\n  var attributeNameToPropertyName = function attributeNameToPropertyName(\n    attributeName\n  ) {\n    return toCamels(attributeName.replace(/^data-/, ''));\n  };\n\n  var mapObject = function mapObject(object, propertyMap) {\n    // remove unwanted\n    forin(propertyMap, function(selector, mapping) {\n      forin(object, function(property, value) {\n        // create regexp shortcut\n        var selectorRegExp = new RegExp(selector);\n\n        // tests if\n        var matches = selectorRegExp.test(property);\n\n        // no match, skip\n        if (!matches) {\n          return;\n        }\n\n        // if there's a mapping, the original property is always removed\n        delete object[property];\n\n        // should only remove, we done!\n        if (mapping === false) {\n          return;\n        }\n\n        // move value to new property\n        if (isString(mapping)) {\n          object[mapping] = value;\n          return;\n        }\n\n        // move to group\n        var group = mapping.group;\n        if (isObject(mapping) && !object[group]) {\n          object[group] = {};\n        }\n\n        object[group][\n          lowerCaseFirstLetter(property.replace(selectorRegExp, ''))\n        ] = value;\n      });\n\n      // do submapping\n      if (mapping.mapping) {\n        mapObject(object[mapping.group], mapping.mapping);\n      }\n    });\n  };\n\n  var getAttributesAsObject = function getAttributesAsObject(node) {\n    var attributeMapping =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    // turn attributes into object\n    var attributes = [];\n    forin(node.attributes, function(index) {\n      attributes.push(node.attributes[index]);\n    });\n\n    var output = attributes\n      .filter(function(attribute) {\n        return attribute.name;\n      })\n      .reduce(function(obj, attribute) {\n        var value = attr(node, attribute.name);\n\n        obj[attributeNameToPropertyName(attribute.name)] =\n          value === attribute.name ? true : value;\n        return obj;\n      }, {});\n\n    // do mapping of object properties\n    mapObject(output, attributeMapping);\n\n    return output;\n  };\n\n  var createAppAtElement = function createAppAtElement(element) {\n    var options =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    // how attributes of the input element are mapped to the options for the plugin\n    var attributeMapping = {\n      // translate to other name\n      '^class$': 'className',\n      '^multiple$': 'allowMultiple',\n      '^capture$': 'captureMethod',\n      '^webkitdirectory$': 'allowDirectoriesOnly',\n\n      // group under single property\n      '^server': {\n        group: 'server',\n        mapping: {\n          '^process': {\n            group: 'process'\n          },\n\n          '^revert': {\n            group: 'revert'\n          },\n\n          '^fetch': {\n            group: 'fetch'\n          },\n\n          '^restore': {\n            group: 'restore'\n          },\n\n          '^load': {\n            group: 'load'\n          }\n        }\n      },\n\n      // don't include in object\n      '^type$': false,\n      '^files$': false\n    };\n\n    // add additional option translators\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);\n\n    // create final options object by setting options object and then overriding options supplied on element\n    var mergedOptions = Object.assign({}, options);\n\n    var attributeOptions = getAttributesAsObject(\n      element.nodeName === 'FIELDSET'\n        ? element.querySelector('input[type=file]')\n        : element,\n      attributeMapping\n    );\n\n    // merge with options object\n    Object.keys(attributeOptions).forEach(function(key) {\n      if (isObject(attributeOptions[key])) {\n        if (!isObject(mergedOptions[key])) {\n          mergedOptions[key] = {};\n        }\n        Object.assign(mergedOptions[key], attributeOptions[key]);\n      } else {\n        mergedOptions[key] = attributeOptions[key];\n      }\n    });\n\n    // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n    mergedOptions.files = (options.files || []).concat(\n      Array.from(element.querySelectorAll('input:not([type=file])')).map(\n        function(input) {\n          return {\n            source: input.value,\n            options: {\n              type: input.dataset.type\n            }\n          };\n        }\n      )\n    );\n\n    // build plugin\n    var app = createAppObject(mergedOptions);\n\n    // add already selected files\n    if (element.files) {\n      Array.from(element.files).forEach(function(file) {\n        app.addFile(file);\n      });\n    }\n\n    // replace the target element\n    app.replaceElement(element);\n\n    // expose\n    return app;\n  };\n\n  // if an element is passed, we create the instance at that element, if not, we just create an up object\n  var createApp$1 = function createApp() {\n    return isNode(arguments.length <= 0 ? undefined : arguments[0])\n      ? createAppAtElement.apply(void 0, arguments)\n      : createAppObject.apply(void 0, arguments);\n  };\n\n  var PRIVATE_METHODS = ['fire', '_read', '_write'];\n\n  var createAppAPI = function createAppAPI(app) {\n    var api = {};\n\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n\n    return api;\n  };\n\n  /**\n   * Replaces placeholders in given string with replacements\n   * @param string - \"Foo {bar}\"\"\n   * @param replacements - { \"bar\": 10 }\n   */\n  var replaceInString = function replaceInString(string, replacements) {\n    return string.replace(/(?:{([a-zA-Z]+)})/g, function(match, group) {\n      return replacements[group];\n    });\n  };\n\n  var createWorker = function createWorker(fn) {\n    var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n      type: 'application/javascript'\n    });\n\n    var workerURL = URL.createObjectURL(workerBlob);\n    var worker = new Worker(workerURL);\n\n    return {\n      transfer: function transfer(message, cb) {},\n      post: function post(message, cb, transferList) {\n        var id = getUniqueId();\n\n        worker.onmessage = function(e) {\n          if (e.data.id === id) {\n            cb(e.data.message);\n          }\n        };\n\n        worker.postMessage(\n          {\n            id: id,\n            message: message\n          },\n\n          transferList\n        );\n      },\n      terminate: function terminate() {\n        worker.terminate();\n        URL.revokeObjectURL(workerURL);\n      }\n    };\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function(resolve, reject) {\n      var img = new Image();\n      img.onload = function() {\n        resolve(img);\n      };\n      img.onerror = function(e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  var renameFile = function renameFile(file, name) {\n    var renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n  };\n\n  var copyFile = function copyFile(file) {\n    return renameFile(file, file.name);\n  };\n\n  // already registered plugins (can't register twice)\n  var registeredPlugins = [];\n\n  // pass utils to plugin\n  var createAppPlugin = function createAppPlugin(plugin) {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n      return;\n    }\n\n    // remember this plugin\n    registeredPlugins.push(plugin);\n\n    // setup!\n    var pluginOutline = plugin({\n      addFilter: addFilter,\n      utils: {\n        Type: Type,\n        forin: forin,\n        isString: isString,\n        isFile: isFile,\n        toNaturalFileSize: toNaturalFileSize,\n        replaceInString: replaceInString,\n        getExtensionFromFilename: getExtensionFromFilename,\n        getFilenameWithoutExtension: getFilenameWithoutExtension,\n        guesstimateMimeType: guesstimateMimeType,\n        getFileFromBlob: getFileFromBlob,\n        getFilenameFromURL: getFilenameFromURL,\n        createRoute: createRoute,\n        createWorker: createWorker,\n        createView: createView,\n        createItemAPI: createItemAPI,\n        loadImage: loadImage,\n        copyFile: copyFile,\n        renameFile: renameFile,\n        createBlob: createBlob,\n        applyFilterChain: applyFilterChain,\n        text: text,\n        getNumericAspectRatioFromString: getNumericAspectRatioFromString\n      },\n\n      views: {\n        fileActionButton: fileActionButton\n      }\n    });\n\n    // add plugin options to default options\n    extendDefaultOptions(pluginOutline.options);\n  };\n\n  // feature detection used by supported() method\n  var isOperaMini = function isOperaMini() {\n    return (\n      Object.prototype.toString.call(window.operamini) === '[object OperaMini]'\n    );\n  };\n  var hasPromises = function hasPromises() {\n    return 'Promise' in window;\n  };\n  var hasBlobSlice = function hasBlobSlice() {\n    return 'slice' in Blob.prototype;\n  };\n  var hasCreateObjectURL = function hasCreateObjectURL() {\n    return 'URL' in window && 'createObjectURL' in window.URL;\n  };\n  var hasVisibility = function hasVisibility() {\n    return 'visibilityState' in document;\n  };\n  var hasTiming = function hasTiming() {\n    return 'performance' in window;\n  }; // iOS 8.x\n\n  var supported = (function() {\n    // Runs immidiately and then remembers result for subsequent calls\n    var isSupported =\n      // Has to be a browser\n      isBrowser() &&\n      // Can't run on Opera Mini due to lack of everything\n      !isOperaMini() &&\n      // Require these APIs to feature detect a modern browser\n      hasVisibility() &&\n      hasPromises() &&\n      hasBlobSlice() &&\n      hasCreateObjectURL() &&\n      hasTiming();\n\n    return function() {\n      return isSupported;\n    };\n  })();\n\n  /**\n   * Plugin internal state (over all instances)\n   */\n  var state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: []\n  };\n\n  // plugin name\n  var name = 'filepond';\n\n  /**\n   * Public Plugin methods\n   */\n  var fn = function fn() {};\n  exports.Status = {};\n  exports.FileStatus = {};\n  exports.FileOrigin = {};\n  exports.OptionTypes = {};\n  exports.create = fn;\n  exports.destroy = fn;\n  exports.parse = fn;\n  exports.find = fn;\n  exports.registerPlugin = fn;\n  exports.getOptions = fn;\n  exports.setOptions = fn;\n\n  // if not supported, no API\n  if (supported()) {\n    // start painter and fire load event\n    createPainter(\n      function() {\n        state.apps.forEach(function(app) {\n          return app._read();\n        });\n      },\n      function(ts) {\n        state.apps.forEach(function(app) {\n          return app._write(ts);\n        });\n      }\n    );\n\n    // fire loaded event so we know when FilePond is available\n    var dispatch = function dispatch() {\n      // let others know we have area ready\n      document.dispatchEvent(\n        new CustomEvent('FilePond:loaded', {\n          detail: {\n            supported: supported,\n            create: exports.create,\n            destroy: exports.destroy,\n            parse: exports.parse,\n            find: exports.find,\n            registerPlugin: exports.registerPlugin,\n            setOptions: exports.setOptions\n          }\n        })\n      );\n\n      // clean up event\n      document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n\n    if (document.readyState !== 'loading') {\n      // move to back of execution queue, FilePond should have been exported by then\n      setTimeout(function() {\n        return dispatch();\n      }, 0);\n    } else {\n      document.addEventListener('DOMContentLoaded', dispatch);\n    }\n\n    // updates the OptionTypes object based on the current options\n    var updateOptionTypes = function updateOptionTypes() {\n      return forin(getOptions(), function(key, value) {\n        exports.OptionTypes[key] = value[1];\n      });\n    };\n\n    exports.Status = Object.assign({}, Status);\n    exports.FileOrigin = Object.assign({}, FileOrigin);\n    exports.FileStatus = Object.assign({}, ItemStatus);\n\n    exports.OptionTypes = {};\n    updateOptionTypes();\n\n    // create method, creates apps and adds them to the app array\n    exports.create = function create() {\n      var app = createApp$1.apply(void 0, arguments);\n      app.on('destroy', exports.destroy);\n      state.apps.push(app);\n      return createAppAPI(app);\n    };\n\n    // destroys apps and removes them from the app array\n    exports.destroy = function destroy(hook) {\n      // returns true if the app was destroyed successfully\n      var indexToRemove = state.apps.findIndex(function(app) {\n        return app.isAttachedTo(hook);\n      });\n      if (indexToRemove >= 0) {\n        // remove from apps\n        var app = state.apps.splice(indexToRemove, 1)[0];\n\n        // restore original dom element\n        app.restoreElement();\n\n        return true;\n      }\n\n      return false;\n    };\n\n    // parses the given context for plugins (does not include the context element itself)\n    exports.parse = function parse(context) {\n      // get all possible hooks\n      var matchedHooks = Array.from(context.querySelectorAll('.' + name));\n\n      // filter out already active hooks\n      var newHooks = matchedHooks.filter(function(newHook) {\n        return !state.apps.find(function(app) {\n          return app.isAttachedTo(newHook);\n        });\n      });\n\n      // create new instance for each hook\n      return newHooks.map(function(hook) {\n        return exports.create(hook);\n      });\n    };\n\n    // returns an app based on the given element hook\n    exports.find = function find(hook) {\n      var app = state.apps.find(function(app) {\n        return app.isAttachedTo(hook);\n      });\n      if (!app) {\n        return null;\n      }\n      return createAppAPI(app);\n    };\n\n    // adds a plugin extension\n    exports.registerPlugin = function registerPlugin() {\n      for (\n        var _len = arguments.length, plugins = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        plugins[_key] = arguments[_key];\n      }\n\n      // register plugins\n      plugins.forEach(createAppPlugin);\n\n      // update OptionTypes, each plugin might have extended the default options\n      updateOptionTypes();\n    };\n\n    exports.getOptions = function getOptions$1() {\n      var opts = {};\n      forin(getOptions(), function(key, value) {\n        opts[key] = value[0];\n      });\n      return opts;\n    };\n\n    exports.setOptions = function setOptions$1(opts) {\n      if (isObject(opts)) {\n        // update existing plugins\n        state.apps.forEach(function(app) {\n          app.setOptions(opts);\n        });\n\n        // override defaults\n        setOptions(opts);\n      }\n\n      // return new options\n      return exports.getOptions();\n    };\n  }\n\n  exports.supported = supported;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n});\n"]},"metadata":{},"sourceType":"script"}